{"version":3,"file":"BundleCalls.339acfa41c12075a85de.js","mappings":"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,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAC9F,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,MAAM,CAC/E,CAAC;AAEK,MAAMna,aAAa,GAAG,CAC3B,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EACzC,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAC9C,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAC9C,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,EAC9C,EAAE,EAAE,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EACvD,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAC1D,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CACjD;;;;;;;;;;;;;;ACvFM,MAAMrM,YAAY,GAAGA,CAAA,KAAM;EAChCmZ,SAAS,CAACsN,OAAO,GAAG,EAAE,CAAC;AACzB,CAAC;;;;;;;;;;;ACFD;;;;;;;;;;;;;;;ACAA;AACA,iEAAe,CAAC,6yBAA6yB;;;;;;;;;;;;;;ACD7zB;AACA,iEAAe,CAAC,sLAAsL;;;;;;;;;;;;;;ACDtM;AACA,iEAAe,CAAC,wCAAwC;;;;;;;;;;;ACDxD;;;;;;;;;;;;;;;ACAA;AACA,iEAAe,CAAC,2YAA2Y;;;;;;;;;;;;;;ACD3Z;AACA,iEAAe,CAAC,sIAAsI;;;;;;;;;;;;;;ACDtJ;AACA,iEAAe,CAAC,gmBAAgmB;;;;;;;;;;;;;;ACDhnB;AACA,iEAAe,CAAC,2GAA2G;;;;;;;;;;;;;;ACD3H;AACA,iEAAe,CAAC,qGAAqG","sources":["webpack://telegram-t/./src/bundles/calls.ts","webpack://telegram-t/./src/components/calls/ActiveCallHeader.tsx","webpack://telegram-t/./src/components/calls/group/GroupCall.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipant.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantList.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantMenu.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantVideo.tsx","webpack://telegram-t/./src/components/calls/group/MicrophoneButton.tsx","webpack://telegram-t/./src/components/calls/group/OutlinedMicrophoneIcon.tsx","webpack://telegram-t/./src/components/calls/group/helpers/formatGroupCallVolume.ts","webpack://telegram-t/./src/components/calls/group/hooks/useGroupCallVideoLayout.ts","webpack://telegram-t/./src/components/calls/phone/PhoneCall.tsx","webpack://telegram-t/./src/components/calls/phone/PhoneCallButton.tsx","webpack://telegram-t/./src/components/calls/phone/RatePhoneCallModal.tsx","webpack://telegram-t/./src/components/right/DeleteMemberModal.tsx","webpack://telegram-t/./src/global/actions/apiUpdaters/calls.async.ts","webpack://telegram-t/./src/global/actions/api/calls.async.ts","webpack://telegram-t/./src/global/actions/calls.ts","webpack://telegram-t/./src/global/selectors/calls.ts","webpack://telegram-t/./src/hooks/useRunThrottled.ts","webpack://telegram-t/./src/hooks/window/useFullscreen.ts","webpack://telegram-t/./src/lib/secret-sauce/blacksilence.ts","webpack://telegram-t/./src/lib/secret-sauce/buildSdp.ts","webpack://telegram-t/./src/lib/secret-sauce/index.ts","webpack://telegram-t/./src/lib/secret-sauce/p2p.ts","webpack://telegram-t/./src/lib/secret-sauce/p2pMessage.ts","webpack://telegram-t/./src/lib/secret-sauce/parseSdp.ts","webpack://telegram-t/./src/lib/secret-sauce/secretsauce.ts","webpack://telegram-t/./src/lib/secret-sauce/types.ts","webpack://telegram-t/./src/lib/secret-sauce/utils.ts","webpack://telegram-t/./src/types/electron.ts","webpack://telegram-t/./src/util/phoneCallEmojiConstants.ts","webpack://telegram-t/./src/util/vibrate.ts","webpack://telegram-t/./src/components/calls/ActiveCallHeader.scss?0899","webpack://telegram-t/./src/components/calls/group/GroupCall.module.scss?4417","webpack://telegram-t/./src/components/calls/group/GroupCallParticipant.module.scss?2375","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantList.module.scss?6462","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantMenu.scss?6b8c","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantVideo.module.scss?799e","webpack://telegram-t/./src/components/calls/group/MicrophoneButton.module.scss?3a9a","webpack://telegram-t/./src/components/calls/phone/PhoneCall.module.scss?a250","webpack://telegram-t/./src/components/calls/phone/PhoneCallButton.module.scss?9dea","webpack://telegram-t/./src/components/calls/phone/RatePhoneCallModal.module.scss?64f6"],"sourcesContent":["import { initializeSoundsForSafari } from '../global/actions/ui/calls';\nimport { IS_IOS, IS_SAFARI } from '../util/windowEnvironment';\n\nexport { default as GroupCall } from '../components/calls/group/GroupCall';\nexport { default as ActiveCallHeader } from '../components/calls/ActiveCallHeader';\nexport { default as PhoneCall } from '../components/calls/phone/PhoneCall';\nexport { default as RatePhoneCallModal } from '../components/calls/phone/RatePhoneCallModal';\n\nif (IS_SAFARI || IS_IOS) {\n  document.addEventListener('click', initializeSoundsForSafari, { once: true });\n}\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useEffect } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiGroupCall, ApiUser } from '../../api/types';\n\nimport { selectTabState } from '../../global/selectors';\nimport { selectActiveGroupCall, selectPhoneCallUser } from '../../global/selectors/calls';\nimport buildClassName from '../../util/buildClassName';\n\nimport useOldLang from '../../hooks/useOldLang';\n\nimport './ActiveCallHeader.scss';\n\ntype StateProps = {\n  isCallPanelVisible?: boolean;\n  groupCall?: ApiGroupCall;\n  phoneCallUser?: ApiUser;\n};\n\nconst ActiveCallHeader: FC<StateProps> = ({\n  groupCall,\n  phoneCallUser,\n  isCallPanelVisible,\n}) => {\n  const { toggleGroupCallPanel } = getActions();\n\n  const lang = useOldLang();\n\n  useEffect(() => {\n    document.body.classList.toggle('has-call-header', Boolean(isCallPanelVisible));\n    window.electron?.setTrafficLightPosition(isCallPanelVisible ? 'lowered' : 'standard');\n\n    return () => {\n      document.body.classList.toggle('has-call-header', false);\n      window.electron?.setTrafficLightPosition('standard');\n    };\n  }, [isCallPanelVisible]);\n\n  function handleToggleGroupCallPanel() {\n    toggleGroupCallPanel();\n  }\n\n  if (!groupCall && !phoneCallUser) return undefined;\n\n  return (\n    <div\n      className={buildClassName(\n        'ActiveCallHeader',\n        isCallPanelVisible && 'open',\n      )}\n      onClick={handleToggleGroupCallPanel}\n    >\n      <span className=\"title\">{phoneCallUser?.firstName || groupCall?.title || lang('VoipGroupVoiceChat')}</span>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    const tabState = selectTabState(global);\n    return {\n      groupCall: tabState.isMasterTab ? selectActiveGroupCall(global) : undefined,\n      isCallPanelVisible: tabState.isCallPanelVisible,\n      phoneCallUser: tabState.isMasterTab ? selectPhoneCallUser(global) : undefined,\n    };\n  },\n)(ActiveCallHeader));\n","import '../../../global/actions/calls';\n\nimport type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  GroupCallConnectionState, GroupCallParticipant as TypeGroupCallParticipant,\n} from '../../../lib/secret-sauce';\nimport type { VideoParticipant } from './hooks/useGroupCallVideoLayout';\n\nimport { IS_SCREENSHARE_SUPPORTED } from '../../../lib/secret-sauce';\nimport { selectChat, selectTabState } from '../../../global/selectors';\nimport {\n  selectCanInviteToActiveGroupCall,\n  selectGroupCall,\n  selectGroupCallParticipant,\n  selectIsAdminInActiveGroupCall,\n} from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { compact } from '../../../util/iteratees';\n\nimport useAppLayout from '../../../hooks/useAppLayout';\nimport useFlag from '../../../hooks/useFlag';\nimport { useIntersectionObserver, useIsIntersecting } from '../../../hooks/useIntersectionObserver';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\nimport { useFullscreenStatus } from '../../../hooks/window/useFullscreen';\nimport useGroupCallVideoLayout from './hooks/useGroupCallVideoLayout';\n\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\nimport Checkbox from '../../ui/Checkbox';\nimport FloatingActionButton from '../../ui/FloatingActionButton';\nimport Modal from '../../ui/Modal';\nimport GroupCallParticipantList from './GroupCallParticipantList';\nimport GroupCallParticipantVideo from './GroupCallParticipantVideo';\nimport MicrophoneButton from './MicrophoneButton';\n\nimport styles from './GroupCall.module.scss';\n\nconst INTERSECTION_THROTTLE = 200;\n\nexport type OwnProps = {\n  groupCallId: string;\n};\n\ntype StateProps = {\n  isCallPanelVisible: boolean;\n  connectionState: GroupCallConnectionState;\n  title?: string;\n  meParticipant?: TypeGroupCallParticipant;\n  participantsCount?: number;\n  isAdmin: boolean;\n  participants: Record<string, TypeGroupCallParticipant>;\n  canInvite: boolean;\n};\n\nconst GroupCall: FC<OwnProps & StateProps> = ({\n  groupCallId,\n  isCallPanelVisible,\n  connectionState,\n  participantsCount,\n  title,\n  meParticipant,\n  isAdmin,\n  participants,\n  canInvite,\n}) => {\n  const {\n    toggleGroupCallVideo,\n    toggleGroupCallPresentation,\n    leaveGroupCall,\n    toggleGroupCallPanel,\n    connectToActiveGroupCall,\n    playGroupCallSound,\n    createGroupCallInviteLink,\n  } = getActions();\n\n  const lang = useOldLang();\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  // eslint-disable-next-line no-null/no-null\n  const primaryVideoContainerRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const secondaryVideoContainerRef = useRef<HTMLDivElement>(null);\n\n  // eslint-disable-next-line no-null/no-null\n  const panelScrollTriggerRef = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const panelRef = useRef<HTMLDivElement>(null);\n\n  const [isLeaving, setIsLeaving] = useState(false);\n  const isOpen = !isCallPanelVisible && !isLeaving;\n\n  const { observe } = useIntersectionObserver({\n    rootRef: panelRef,\n    throttleMs: INTERSECTION_THROTTLE,\n    isDisabled: !isOpen,\n  });\n\n  const hasScrolled = !useIsIntersecting(panelScrollTriggerRef, isOpen ? observe : undefined);\n\n  const { isMobile, isLandscape } = useAppLayout();\n\n  const [isFullscreen, openFullscreen, closeFullscreen] = useFlag();\n  const [isSidebarOpen, openSidebar, closeSidebar] = useFlag(true);\n  const isLandscapeLayout = Boolean(isFullscreen && isLandscape);\n  const isAppFullscreen = useFullscreenStatus();\n\n  const firstPresentation = useMemo(() => {\n    return Object.values(participants).find(({ presentation }) => presentation);\n  }, [participants]);\n  const videoParticipants = useMemo(() => Object.values(participants)\n    .filter(({ video, presentation }) => video || presentation)\n    .flatMap(({ id, video, presentation }) => compact([\n      video ? {\n        id,\n        type: 'video' as const,\n      } : undefined,\n      presentation ? {\n        id,\n        type: 'screen' as const,\n      } : undefined,\n    ])),\n  [participants]);\n  const hasVideoParticipants = videoParticipants.length > 0;\n\n  const groupCallTitle = title || lang('VoipGroupVoiceChat');\n  const membersString = lang('Participants', participantsCount, 'i');\n\n  const [isConfirmLeaveModalOpen, openConfirmLeaveModal, closeConfirmLeaveModal] = useFlag();\n  const [isEndGroupCallModal, setIsEndGroupCallModal] = useState(false);\n  const [shouldEndGroupCall, setShouldEndGroupCall] = useState(false);\n\n  const hasVideo = meParticipant?.hasVideoStream;\n  const hasPresentation = meParticipant?.hasPresentationStream;\n  const hasAudioStream = meParticipant?.hasAudioStream;\n  const isConnecting = connectionState !== 'connected';\n  const canSelfUnmute = meParticipant?.canSelfUnmute;\n  const canRequestToSpeak = !canSelfUnmute && !hasAudioStream;\n\n  useEffect(() => {\n    if (connectionState === 'connected') {\n      playGroupCallSound({ sound: 'join' });\n    } else if (connectionState === 'reconnecting') {\n      playGroupCallSound({ sound: 'connecting' });\n    }\n  }, [connectionState]);\n\n  const handleCloseConfirmLeaveModal = useLastCallback(() => {\n    closeConfirmLeaveModal();\n    setIsEndGroupCallModal(false);\n  });\n\n  const handleToggleFullscreen = useLastCallback(() => {\n    if (!containerRef.current || isMobile) return;\n\n    if (isFullscreen) {\n      closeFullscreen();\n    } else {\n      openFullscreen();\n    }\n  });\n\n  const handleToggleSidebar = useLastCallback(() => {\n    if (isSidebarOpen) {\n      closeSidebar();\n    } else {\n      openSidebar();\n    }\n  });\n\n  const handleToggleGroupCallPanel = useLastCallback(() => {\n    toggleGroupCallPanel();\n  });\n\n  const handleInviteMember = useLastCallback(() => {\n    createGroupCallInviteLink();\n  });\n\n  const handleClickVideo = useLastCallback(() => {\n    toggleGroupCallVideo();\n  });\n\n  useEffect(() => {\n    connectToActiveGroupCall();\n  }, [connectToActiveGroupCall, groupCallId]);\n\n  const handleLeaveGroupCall = useLastCallback(() => {\n    if (isAdmin && !isConfirmLeaveModalOpen) {\n      openConfirmLeaveModal();\n      return;\n    }\n    playGroupCallSound({ sound: 'leave' });\n    setIsLeaving(true);\n    closeConfirmLeaveModal();\n  });\n\n  const handleCloseAnimationEnd = useLastCallback(() => {\n    if (!isLeaving) return;\n\n    leaveGroupCall({\n      shouldDiscard: shouldEndGroupCall,\n    });\n  });\n\n  const handleToggleGroupCallPresentation = useLastCallback(() => {\n    toggleGroupCallPresentation();\n  });\n\n  const canPinVideo = videoParticipants.length > 1 && !isMobile;\n  const isLandscapeWithVideos = isLandscapeLayout && hasVideoParticipants;\n  const [pinnedVideo, setPinnedVideo] = useState<VideoParticipant | undefined>(undefined);\n  const {\n    videoLayout,\n    panelOffset,\n  } = useGroupCallVideoLayout({\n    primaryContainerRef: primaryVideoContainerRef,\n    secondaryContainerRef: secondaryVideoContainerRef,\n    videoParticipants,\n    isLandscapeLayout,\n    pinnedVideo,\n  });\n\n  const handleSetPinnedVideo = useLastCallback((video: VideoParticipant | undefined) => {\n    setPinnedVideo(video);\n    if (video && !isFullscreen) {\n      openFullscreen();\n    }\n  });\n\n  const handleOpenFirstPresentation = useLastCallback(() => {\n    if (!firstPresentation) return;\n\n    setPinnedVideo({\n      id: firstPresentation.id,\n      type: 'screen',\n    });\n  });\n\n  useEffect(handleOpenFirstPresentation, [handleOpenFirstPresentation, Boolean(firstPresentation)]);\n\n  useEffect(() => {\n    if (!pinnedVideo) return;\n    if (!videoParticipants.some((l) => l.type === pinnedVideo.type && l.id === pinnedVideo.id)) {\n      setPinnedVideo(undefined);\n    }\n  }, [pinnedVideo, videoLayout, videoParticipants]);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={toggleGroupCallPanel}\n      className={buildClassName(\n        styles.root,\n        (isFullscreen || isMobile) && styles.fullscreen,\n        isAppFullscreen && styles.appFullscreen,\n        isLandscapeLayout && styles.landscape,\n        !hasVideoParticipants && styles.noVideoParticipants,\n        !isLandscapeLayout && styles.portrait,\n        !isSidebarOpen && isLandscapeWithVideos && styles.noSidebar,\n      )}\n      dialogRef={containerRef}\n      onCloseAnimationEnd={handleCloseAnimationEnd}\n    >\n      {isLandscapeWithVideos && (\n        <div className={styles.videos}>\n          <div className={styles.videosHeader}>\n            {!isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                onClick={handleToggleFullscreen}\n                className={buildClassName(styles.headerButton, styles.firstButton)}\n                ariaLabel={lang(isFullscreen ? 'AccExitFullscreen' : 'AccSwitchToFullscreen')}\n              >\n                <Icon name={isFullscreen ? 'smallscreen' : 'fullscreen'} />\n              </Button>\n            )}\n\n            <h3 className={buildClassName(styles.title, styles.bigger)}>\n              {title || lang('VoipGroupVoiceChat')}\n            </h3>\n\n            {isLandscapeWithVideos && !isSidebarOpen && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                className={buildClassName(styles.headerButton, styles.videosHeaderLastButton)}\n                onClick={handleToggleSidebar}\n                ariaLabel={lang('AccDescrExpandPanel')}\n              >\n                <Icon name=\"sidebar\" />\n              </Button>\n            )}\n          </div>\n\n          <div\n            className={styles.videosContent}\n            ref={primaryVideoContainerRef}\n          />\n        </div>\n      )}\n\n      <div className={styles.panelWrapper} ref={panelRef}>\n        <div className={buildClassName(styles.panel, 'custom-scroll')}>\n          <div className={styles.panelScrollTrigger} ref={panelScrollTriggerRef} />\n\n          <div className={buildClassName(styles.panelHeader, hasScrolled && styles.scrolled)}>\n            {!isLandscapeWithVideos && !isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.firstButton,\n                  styles.headerButton,\n                )}\n                onClick={handleToggleFullscreen}\n                ariaLabel={lang('AccSwitchToFullscreen')}\n              >\n                <Icon name=\"fullscreen\" />\n              </Button>\n            )}\n\n            {isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                onClick={handleToggleGroupCallPanel}\n                className={buildClassName(styles.headerButton, styles.firstButton)}\n                ariaLabel={lang('Close')}\n              >\n                <Icon name=\"close\" />\n              </Button>\n            )}\n\n            {isLandscapeWithVideos && (\n              <Button\n                round\n                size=\"smaller\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.firstButton,\n                  styles.headerButton,\n                )}\n                color=\"translucent\"\n                onClick={handleToggleSidebar}\n                ariaLabel={lang('AccDescrCollapsePanel')}\n              >\n                <Icon name=\"sidebar\" />\n              </Button>\n            )}\n\n            <div className={styles.panelHeaderText}>\n              <h3 className={buildClassName(styles.title, isLandscapeWithVideos && styles.bigger)}>\n                {isLandscapeWithVideos ? membersString : groupCallTitle}\n              </h3>\n              {!isLandscapeWithVideos && (\n                <span className={styles.subtitle}>\n                  {membersString}\n                </span>\n              )}\n            </div>\n\n            {!isLandscapeWithVideos && canInvite && (\n              <Button\n                round\n                size=\"smaller\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.lastButton,\n                  styles.headerButton,\n                )}\n                color=\"translucent\"\n                onClick={handleInviteMember}\n                ariaLabel={lang('VoipGroupInviteMember')}\n              >\n                <Icon name=\"add-user\" />\n              </Button>\n            )}\n          </div>\n\n          <div className={styles.participants}>\n            <div\n              className={styles.participantVideos}\n              ref={secondaryVideoContainerRef}\n              style={`height: ${panelOffset}px;`}\n            >\n              {videoLayout.map((layout) => {\n                const participant = participants[layout.participantId];\n                if (!layout.isRemounted || !participant) {\n                  return (\n                    <div\n                      teactOrderKey={layout.orderKey}\n                      key={`${layout.participantId}_${layout.type}`}\n                    />\n                  );\n                }\n\n                return (\n                  <GroupCallParticipantVideo\n                    teactOrderKey={layout.orderKey}\n                    key={`${layout.participantId}_${layout.type}`}\n                    layout={layout}\n                    canPin={canPinVideo}\n                    setPinned={handleSetPinnedVideo}\n                    pinnedVideo={pinnedVideo}\n                    participant={participant}\n                  />\n                );\n              })}\n            </div>\n            <GroupCallParticipantList\n              panelOffset={panelOffset}\n              isLandscape={isLandscapeWithVideos}\n            />\n          </div>\n        </div>\n\n        <FloatingActionButton\n          key=\"add-participant\"\n          isShown={isLandscapeWithVideos && canInvite}\n          onClick={handleInviteMember}\n          className={styles.addParticipantButton}\n          ariaLabel={lang('VoipGroupInviteMember')}\n        >\n          <Icon name=\"add-user-filled\" />\n        </FloatingActionButton>\n      </div>\n\n      <div className={styles.mainVideoContainer}>\n        {videoLayout.map((layout) => {\n          const participant = participants[layout.participantId];\n          if (layout.isRemounted || !participant) {\n            return (\n              <div\n                teactOrderKey={layout.orderKey}\n                key={`${layout.participantId}_${layout.type}`}\n              />\n            );\n          }\n          return (\n            <GroupCallParticipantVideo\n              teactOrderKey={layout.orderKey}\n              key={`${layout.participantId}_${layout.type}`}\n              layout={layout}\n              canPin={canPinVideo}\n              setPinned={handleSetPinnedVideo}\n              pinnedVideo={pinnedVideo}\n              participant={participant}\n              className={styles.video}\n            />\n          );\n        })}\n      </div>\n\n      <div className={styles.actions}>\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          onClick={handleClickVideo}\n          ariaLabel={lang(hasVideo ? 'VoipStopVideo' : 'VoipStartVideo')}\n          disabled={isConnecting}\n        >\n          <Icon name={!hasVideo ? 'video-stop' : 'video'} />\n        </Button>\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          onClick={handleToggleGroupCallPresentation}\n          ariaLabel={lang(hasPresentation ? 'lng_group_call_screen_share_stop' : 'lng_group_call_tooltip_screen')}\n          disabled={isConnecting || !IS_SCREENSHARE_SUPPORTED}\n        >\n          <Icon name={!hasPresentation ? 'share-screen-stop' : 'share-screen'} />\n        </Button>\n\n        <MicrophoneButton className={styles.actionButton} />\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          ariaLabel={lang('lng_group_call_settings')}\n          disabled\n        >\n          <Icon name=\"settings-filled\" />\n        </Button>\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            styles.destructive,\n          )}\n          onClick={handleLeaveGroupCall}\n          ariaLabel={lang('lng_group_call_leave')}\n        >\n          <Icon name=\"close\" />\n        </Button>\n      </div>\n\n      <Modal\n        isOpen={isConfirmLeaveModalOpen}\n        onClose={handleCloseConfirmLeaveModal}\n        className=\"error\"\n        title={lang(isEndGroupCallModal ? 'VoipGroupEndAlertTitle' : 'VoipGroupLeaveAlertTitle')}\n      >\n        <p>{lang(isEndGroupCallModal ? 'VoipGroupEndAlertText' : 'VoipGroupLeaveAlertText')}</p>\n        {!isEndGroupCallModal && (\n          <Checkbox\n            label={lang('VoipGroupEndChat')}\n            checked={shouldEndGroupCall}\n            onCheck={setShouldEndGroupCall}\n          />\n        )}\n        <div className=\"dialog-buttons\">\n          <Button isText className=\"confirm-dialog-button\" onClick={handleLeaveGroupCall}>\n            {lang(isEndGroupCallModal ? 'VoipGroupEnd' : 'VoipGroupLeave')}\n          </Button>\n          <Button isText className=\"confirm-dialog-button\" onClick={handleCloseConfirmLeaveModal}>\n            {lang('Cancel')}\n          </Button>\n        </div>\n      </Modal>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { groupCallId }): StateProps => {\n    const {\n      connectionState, title, participants, participantsCount, chatId,\n    } = selectGroupCall(global, groupCallId)! || {};\n\n    const chat = chatId ? selectChat(global, chatId) : undefined;\n\n    return {\n      connectionState,\n      title: title || chat?.title,\n      participantsCount,\n      meParticipant: selectGroupCallParticipant(global, groupCallId, global.currentUserId!),\n      isCallPanelVisible: Boolean(selectTabState(global).isCallPanelVisible),\n      isAdmin: selectIsAdminInActiveGroupCall(global),\n      participants,\n      canInvite: selectCanInviteToActiveGroupCall(global),\n    };\n  },\n)(GroupCall));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useMemo, useRef,\n} from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiPeer } from '../../../api/types';\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { GROUP_CALL_DEFAULT_VOLUME } from '../../../config';\nimport { THRESHOLD } from '../../../lib/secret-sauce';\nimport { selectChat, selectUser } from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport renderText from '../../common/helpers/renderText';\nimport formatGroupCallVolume from './helpers/formatGroupCallVolume';\n\nimport useContextMenuHandlers from '../../../hooks/useContextMenuHandlers';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Avatar from '../../common/Avatar';\nimport FullNameTitle from '../../common/FullNameTitle';\nimport Icon from '../../common/icons/Icon';\nimport ListItem from '../../ui/ListItem';\nimport GroupCallParticipantMenu from './GroupCallParticipantMenu';\nimport OutlinedMicrophoneIcon from './OutlinedMicrophoneIcon';\n\nimport styles from './GroupCallParticipant.module.scss';\n\ntype OwnProps = {\n  participant: TypeGroupCallParticipant;\n};\n\ntype StateProps = {\n  peer?: ApiPeer;\n};\n\nconst GroupCallParticipant: FC<OwnProps & StateProps> = ({\n  participant,\n  peer,\n}) => {\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const menuRef = useRef<HTMLDivElement>(null);\n  const lang = useOldLang();\n\n  const {\n    isSelf, isMutedByMe, isMuted, hasVideoStream, hasPresentationStream,\n  } = participant;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n\n  const {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    handleContextMenu,\n    handleBeforeContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  } = useContextMenuHandlers(ref, isSelf);\n\n  const getTriggerElement = useCallback(() => ref.current, []);\n\n  const getRootElement = useCallback(\n    () => ref.current!.closest('.custom-scroll, .no-scrollbar'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => menuRef.current!,\n    [],\n  );\n\n  const getLayout = useCallback(\n    () => ({ withPortal: true }),\n    [],\n  );\n\n  const hasCustomVolume = Boolean(\n    !isMuted && isSpeaking && participant.volume && participant.volume !== GROUP_CALL_DEFAULT_VOLUME,\n  );\n\n  const [aboutText, aboutColor] = useMemo(() => {\n    if (isMutedByMe) {\n      return [lang('VoipGroupMutedForMe'), styles.subtitleRed];\n    }\n\n    if (isRaiseHand) {\n      return [lang('WantsToSpeak'), styles.subtitleBlue];\n    }\n\n    if (hasCustomVolume) {\n      return [\n        lang('SpeakingWithVolume', formatGroupCallVolume(participant))\n          .replace('%%', '%'),\n        styles.subtitleGreen,\n      ];\n    }\n\n    if (!isMuted && isSpeaking) {\n      return [\n        lang('Speaking'),\n        styles.subtitleGreen,\n      ];\n    }\n\n    if (isSelf) {\n      return [lang('ThisIsYou'), styles.subtitleBlue];\n    }\n\n    return participant.about ? [participant.about, ''] : [lang('Listening'), styles.subtitleBlue];\n  }, [isMutedByMe, isRaiseHand, hasCustomVolume, isMuted, isSpeaking, isSelf, participant, lang]);\n\n  if (!peer) {\n    return undefined;\n  }\n\n  return (\n    <ListItem\n      leftElement={<Avatar peer={peer} className={styles.avatar} />}\n      rightElement={<OutlinedMicrophoneIcon participant={participant} className={styles.icon} />}\n      className={styles.root}\n      onClick={handleContextMenu}\n      onMouseDown={handleBeforeContextMenu}\n      onContextMenu={handleContextMenu}\n      multiline\n      ripple\n      ref={ref}\n    >\n      <FullNameTitle peer={peer} withEmojiStatus className={styles.title} />\n      <span className={buildClassName(styles.subtitle, 'subtitle', aboutColor)}>\n        {hasPresentationStream && <Icon name=\"share-screen\" />}\n        {hasVideoStream && <Icon name=\"video\" />}\n        {hasCustomVolume && <Icon name=\"speaker\" />}\n        <span className={styles.subtitleText}>{renderText(aboutText)}</span>\n      </span>\n      <GroupCallParticipantMenu\n        participant={participant}\n        isDropdownOpen={isContextMenuOpen}\n        anchor={contextMenuAnchor}\n        getTriggerElement={getTriggerElement}\n        getRootElement={getRootElement}\n        getMenuElement={getMenuElement}\n        getLayout={getLayout}\n        onClose={handleContextMenuClose}\n        onCloseAnimationEnd={handleContextMenuHide}\n        menuRef={menuRef}\n      />\n    </ListItem>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { participant }): StateProps => {\n    return {\n      peer: selectUser(global, participant.id) || selectChat(global, participant.id),\n    };\n  },\n)(GroupCallParticipant));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo, useMemo } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { selectActiveGroupCall } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { compareFields } from '../../../util/iteratees';\n\nimport useInfiniteScroll from '../../../hooks/useInfiniteScroll';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport GroupCallParticipant from './GroupCallParticipant';\n\nimport styles from './GroupCallParticipantList.module.scss';\n\ntype OwnProps = {\n  panelOffset: number;\n  isLandscape: boolean;\n};\n\ntype StateProps = {\n  participantsCount: number;\n  participants?: Record<string, TypeGroupCallParticipant>;\n  canInvite?: boolean;\n};\n\nconst GroupCallParticipantList: FC<OwnProps & StateProps> = ({\n  panelOffset,\n  participants,\n  participantsCount,\n  isLandscape,\n}) => {\n  const {\n    loadMoreGroupCallParticipants,\n  } = getActions();\n\n  const orderedParticipantIds = useMemo(() => {\n    return Object.values(participants || {}).sort(compareParticipants).map((participant) => participant.id);\n  }, [participants]);\n\n  const handleLoadMoreGroupCallParticipants = useLastCallback(() => {\n    loadMoreGroupCallParticipants();\n  });\n\n  const [viewportIds, getMore] = useInfiniteScroll(\n    handleLoadMoreGroupCallParticipants,\n    orderedParticipantIds,\n    orderedParticipantIds.length >= participantsCount,\n  );\n\n  return (\n    <InfiniteScroll\n      items={viewportIds}\n      onLoadMore={getMore}\n      style={`transform: translateY(${panelOffset}px);`}\n      className={buildClassName(styles.root, !isLandscape && styles.portrait)}\n    >\n      {participants && viewportIds?.map(\n        (participantId) => (\n          participants[participantId] && (\n            <GroupCallParticipant\n              key={participantId}\n              teactOrderKey={orderedParticipantIds.indexOf(participantId)}\n              participant={participants[participantId]}\n            />\n          )\n        ),\n      )}\n    </InfiniteScroll>\n  );\n};\n\nfunction compareParticipants(a: TypeGroupCallParticipant, b: TypeGroupCallParticipant) {\n  return compareFields(!a.isMuted, !b.isMuted)\n        || compareFields(a.presentation, b.presentation)\n        || compareFields(a.video, b.video)\n        || compareFields(a.raiseHandRating, b.raiseHandRating);\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global): StateProps => {\n    const { participantsCount, participants } = selectActiveGroupCall(global) || {};\n\n    return {\n      participants,\n      participantsCount: participantsCount || 0,\n    };\n  },\n)(GroupCallParticipantList));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo, useEffect, useState } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallParticipant } from '../../../lib/secret-sauce';\nimport type { MenuPositionOptions } from '../../ui/Menu';\n\nimport { GROUP_CALL_DEFAULT_VOLUME, GROUP_CALL_VOLUME_MULTIPLIER } from '../../../config';\nimport { selectIsAdminInActiveGroupCall } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\nimport useRunThrottled from '../../../hooks/useRunThrottled';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport DeleteMemberModal from '../../right/DeleteMemberModal';\nimport Menu from '../../ui/Menu';\nimport MenuItem from '../../ui/MenuItem';\n\nimport './GroupCallParticipantMenu.scss';\n\nconst SPEAKER_ICON_DISABLED_SEGMENT: [number, number] = [0, 17];\nconst SPEAKER_ICON_ENABLED_SEGMENT: [number, number] = [17, 34];\n\ntype OwnProps =\n  {\n    participant?: GroupCallParticipant;\n    onCloseAnimationEnd: VoidFunction;\n    onClose: VoidFunction;\n    isDropdownOpen: boolean;\n    menuRef?: React.RefObject<HTMLDivElement>;\n  }\n  & MenuPositionOptions;\n\ntype StateProps = {\n  isAdmin: boolean;\n};\n\nconst VOLUME_ZERO = 0;\nconst VOLUME_LOW = 50;\nconst VOLUME_MEDIUM = 100;\nconst VOLUME_NORMAL = 150;\n\nconst VOLUME_CHANGE_THROTTLE = 500;\n\nconst SPEAKER_ICON_SIZE = 24;\n\nconst GroupCallParticipantMenu: FC<OwnProps & StateProps> = ({\n  participant,\n  onCloseAnimationEnd,\n  onClose,\n  isDropdownOpen,\n  isAdmin,\n  menuRef,\n  ...menuPositionOptions\n}) => {\n  const {\n    toggleGroupCallMute,\n    setGroupCallParticipantVolume,\n    toggleGroupCallPanel,\n    openChat,\n    requestToSpeak,\n  } = getActions();\n\n  const lang = useOldLang();\n  const [isDeleteUserModalOpen, openDeleteUserModal, closeDeleteUserModal] = useFlag();\n\n  const id = participant?.id;\n  const {\n    isMutedByMe, isMuted, isSelf, canSelfUnmute,\n  } = participant || {};\n  const isRaiseHand = Boolean(participant?.raiseHandRating);\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n\n  const [localVolume, setLocalVolume] = useState(\n    isMutedByMe ? VOLUME_ZERO : ((participant?.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER),\n  );\n\n  const [shouldPlay, setShouldPlay] = useState(false);\n\n  const isLocalVolumeZero = localVolume === VOLUME_ZERO;\n  const speakerIconPlaySegment = isLocalVolumeZero ? SPEAKER_ICON_DISABLED_SEGMENT : SPEAKER_ICON_ENABLED_SEGMENT;\n\n  useEffect(() => {\n    if (isDropdownOpen) return;\n    setShouldPlay(false);\n  }, [isDropdownOpen]);\n\n  const handleSetLocalVolume = useLastCallback((volume: number) => {\n    setLocalVolume(volume);\n    const isNewLocalVolumeZero = volume === VOLUME_ZERO;\n    setShouldPlay(isNewLocalVolumeZero !== isLocalVolumeZero);\n  });\n\n  useEffect(() => {\n    setLocalVolume(isMutedByMe\n      ? VOLUME_ZERO\n      : ((participant?.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER));\n    // We only want to initialize local volume when switching participants and ignore following updates from server\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, [id]);\n\n  const runThrottled = useRunThrottled(VOLUME_CHANGE_THROTTLE);\n\n  const handleRemove = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    openDeleteUserModal();\n    onClose();\n  });\n\n  const handleCancelRequestToSpeak = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    requestToSpeak({\n      value: false,\n    });\n    onClose();\n  });\n\n  const handleMute = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    onClose();\n\n    if (!isAdmin) {\n      handleSetLocalVolume(isMutedByMe ? GROUP_CALL_DEFAULT_VOLUME / GROUP_CALL_VOLUME_MULTIPLIER : VOLUME_ZERO);\n    } else if (shouldRaiseHand) {\n      handleSetLocalVolume((participant?.volume ?? GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER);\n    }\n\n    toggleGroupCallMute({\n      participantId: id!,\n      value: isAdmin ? !shouldRaiseHand : !isMutedByMe,\n    });\n  });\n\n  const handleOpenProfile = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    toggleGroupCallPanel();\n    openChat({\n      id,\n    });\n    onClose();\n  });\n\n  const handleChangeVolume = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = Number(e.target.value);\n    handleSetLocalVolume(value);\n\n    runThrottled(() => {\n      if (value === VOLUME_ZERO) {\n        toggleGroupCallMute({\n          participantId: id!,\n          value: true,\n        });\n      } else {\n        setGroupCallParticipantVolume({\n          participantId: id!,\n          volume: Math.floor(value * GROUP_CALL_VOLUME_MULTIPLIER),\n        });\n      }\n    });\n  };\n\n  return (\n    <div>\n      <Menu\n        isOpen={isDropdownOpen}\n        ref={menuRef}\n        withPortal\n        onClose={onClose}\n        onCloseAnimationEnd={onCloseAnimationEnd}\n        className=\"participant-menu with-menu-transitions\"\n        // eslint-disable-next-line react/jsx-props-no-spreading\n        {...menuPositionOptions}\n      >\n        {!isSelf && !shouldRaiseHand && (\n          <div className=\"group\">\n            <div className={buildClassName(\n              'volume-control',\n              localVolume < VOLUME_LOW && 'low',\n              localVolume >= VOLUME_LOW && localVolume < VOLUME_MEDIUM && 'medium',\n              localVolume >= VOLUME_MEDIUM && localVolume < VOLUME_NORMAL && 'normal',\n              localVolume >= VOLUME_NORMAL && 'high',\n            )}\n            >\n              <input\n                type=\"range\"\n                min=\"0\"\n                max=\"200\"\n                value={localVolume}\n                onChange={handleChangeVolume}\n              />\n              <div className=\"info\">\n                <AnimatedIcon\n                  tgsUrl={LOCAL_TGS_URLS.Speaker}\n                  play={shouldPlay ? speakerIconPlaySegment.toString() : false}\n                  playSegment={speakerIconPlaySegment}\n                  size={SPEAKER_ICON_SIZE}\n                />\n                <span>{localVolume}%</span>\n              </div>\n            </div>\n          </div>\n        )}\n        <div className=\"group\">\n          {(isRaiseHand && isSelf) && (\n            <MenuItem\n              icon=\"stop-raising-hand\"\n              onClick={handleCancelRequestToSpeak}\n            >\n              {lang('VoipGroupCancelRaiseHand')}\n            </MenuItem>\n          )}\n          {!isSelf && <MenuItem icon=\"user\" onClick={handleOpenProfile}>{lang('VoipGroupOpenProfile')}</MenuItem>}\n          {!isSelf && (\n            // TODO cross mic\n            <MenuItem\n              icon={isMuted ? (isAdmin && shouldRaiseHand ? 'allow-speak' : 'microphone-alt') : 'microphone-alt'}\n              onClick={handleMute}\n            >\n              {isAdmin\n                ? lang(shouldRaiseHand ? 'VoipGroupAllowToSpeak' : 'VoipMute')\n                : lang(isMutedByMe ? 'VoipGroupUnmuteForMe' : 'VoipGroupMuteForMe')}\n            </MenuItem>\n          )}\n          {!isSelf && isAdmin && (\n            // TODO replace with hand\n            <MenuItem icon=\"delete-user\" destructive onClick={handleRemove}>\n              {lang('VoipGroupUserRemove')}\n            </MenuItem>\n          )}\n        </div>\n      </Menu>\n\n      {!isSelf && isAdmin && (\n        <DeleteMemberModal\n          isOpen={isDeleteUserModalOpen}\n          userId={id}\n          onClose={closeDeleteUserModal}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): StateProps => {\n    return {\n      isAdmin: selectIsAdminInActiveGroupCall(global),\n    };\n  },\n)(GroupCallParticipantMenu));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiChat, ApiUser } from '../../../api/types';\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\nimport type { VideoLayout, VideoParticipant } from './hooks/useGroupCallVideoLayout';\n\nimport { GROUP_CALL_DEFAULT_VOLUME } from '../../../config';\nimport fastBlur from '../../../lib/fastBlur';\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { getUserStreams, THRESHOLD } from '../../../lib/secret-sauce';\nimport { selectChat, selectUser } from '../../../global/selectors';\nimport { animate } from '../../../util/animation';\nimport buildClassName from '../../../util/buildClassName';\nimport { fastRaf } from '../../../util/schedulers';\nimport { IS_CANVAS_FILTER_SUPPORTED } from '../../../util/windowEnvironment';\nimport formatGroupCallVolume from './helpers/formatGroupCallVolume';\n\nimport useInterval from '../../../hooks/schedulers/useInterval';\nimport useContextMenuHandlers from '../../../hooks/useContextMenuHandlers';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport FullNameTitle from '../../common/FullNameTitle';\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\nimport Skeleton from '../../ui/placeholder/Skeleton';\nimport GroupCallParticipantMenu from './GroupCallParticipantMenu';\nimport OutlinedMicrophoneIcon from './OutlinedMicrophoneIcon';\n\nimport styles from './GroupCallParticipantVideo.module.scss';\n\nconst BLUR_RADIUS = 2;\nconst BLUR_ITERATIONS = 2;\nconst VIDEO_FALLBACK_UPDATE_INTERVAL = 1000;\n\ntype OwnProps = {\n  layout: VideoLayout;\n  setPinned: (participant?: VideoParticipant) => void;\n  pinnedVideo: VideoParticipant | undefined;\n  canPin: boolean;\n  participant: TypeGroupCallParticipant;\n  className?: string;\n};\n\ntype StateProps = {\n  user?: ApiUser;\n  chat?: ApiChat;\n};\n\nconst GroupCallParticipantVideo: FC<OwnProps & StateProps> = ({\n  layout,\n  pinnedVideo,\n  setPinned,\n  canPin,\n  className,\n  participant,\n  user,\n  chat,\n}) => {\n  const lang = useOldLang();\n\n  // eslint-disable-next-line no-null/no-null\n  const thumbnailRef = useRef<HTMLCanvasElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const videoRef = useRef<HTMLVideoElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const videoFallbackRef = useRef<HTMLCanvasElement>(null);\n\n  const {\n    x, y, width, height, noAnimate, isRemoved,\n    type,\n  } = layout;\n  const {\n    isSelf, isMutedByMe, isMuted,\n  } = participant;\n  const isPinned = pinnedVideo?.id === participant.id && pinnedVideo?.type === type;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n  const shouldFlipVideo = type === 'video' && participant.isSelf;\n\n  const status = useMemo(() => {\n    if (isSelf) {\n      return lang('ThisIsYou');\n    }\n\n    if (isMutedByMe) {\n      return lang('VoipGroupMutedForMe');\n    }\n\n    if (isRaiseHand) {\n      return lang('WantsToSpeak');\n    }\n\n    if (isMuted || !isSpeaking) {\n      return lang('Listening');\n    }\n\n    if (participant.volume && participant.volume !== GROUP_CALL_DEFAULT_VOLUME) {\n      return lang('SpeakingWithVolume', formatGroupCallVolume(participant))\n        .replace('%%', '%');\n    }\n\n    return lang('Speaking');\n  }, [isSelf, isMutedByMe, isRaiseHand, isMuted, isSpeaking, participant, lang]);\n\n  const prevLayoutRef = useRef<VideoLayout>();\n  if (!isRemoved) {\n    prevLayoutRef.current = layout;\n  }\n  const {\n    x: prevX, y: prevY, width: prevWidth, height: prevHeight,\n  } = prevLayoutRef.current || {};\n\n  const [currentX, currentY, currentWidth, currentHeight] = isRemoved\n    ? [prevX, prevY, prevWidth, prevHeight] : [x, y, width, height];\n\n  const [isHidden, setIsHidden] = useState(!noAnimate);\n\n  const streams = getUserStreams(user?.id || chat!.id);\n  const actualStream = type === 'video' ? streams?.video : streams?.presentation;\n  const streamRef = useRef(actualStream);\n  if (actualStream?.active && actualStream?.getVideoTracks()[0].enabled) {\n    streamRef.current = actualStream;\n  }\n  const stream = streamRef.current;\n\n  const handleInactive = useLastCallback(() => {\n    const video = videoRef.current;\n    if (!video) return;\n    // eslint-disable-next-line no-null/no-null\n    video.srcObject = null;\n  });\n\n  useEffect(() => {\n    stream?.addEventListener('inactive', handleInactive);\n    return () => {\n      stream?.removeEventListener('inactive', handleInactive);\n    };\n  }, [handleInactive, stream]);\n\n  useEffect(() => {\n    setIsHidden(false);\n  }, []);\n\n  const [isLoading, setIsLoading] = useState(true);\n\n  const handleCanPlay = useLastCallback(() => {\n    setIsLoading(false);\n  });\n\n  // When video stream is removed, the video element starts showing empty black screen.\n  // To avoid that, we hide the video element and show the fallback frame instead, which is constantly updated\n  // every VIDEO_FALLBACK_UPDATE_INTERVAL milliseconds.\n  useInterval(() => {\n    if (!stream?.active) return;\n    const video = videoRef.current!;\n    const canvas = videoFallbackRef.current!;\n\n    requestMutation(() => {\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      canvas.getContext('2d')!.drawImage(video, 0, 0, canvas.width, canvas.height);\n    });\n  }, VIDEO_FALLBACK_UPDATE_INTERVAL);\n\n  useEffect(() => {\n    const video = videoRef.current;\n    const thumbnail = thumbnailRef.current;\n    if (!video || !thumbnail || !stream) return undefined;\n\n    const ctx = thumbnail.getContext('2d', { alpha: false });\n    if (!ctx) return undefined;\n\n    let isDrawing = true;\n    requestMutation(() => {\n      if (!isDrawing) return;\n      thumbnail.width = 16;\n      thumbnail.height = 16;\n      ctx.filter = 'blur(2px)';\n\n      const draw = () => {\n        if (!isDrawing) return false;\n        if (!stream.active) {\n          return false;\n        }\n        ctx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight, 0, 0, thumbnail.width, thumbnail.height);\n        if (!IS_CANVAS_FILTER_SUPPORTED) {\n          fastBlur(ctx, 0, 0, thumbnail.width, thumbnail.height, BLUR_RADIUS, BLUR_ITERATIONS);\n        }\n        return true;\n      };\n\n      animate(draw, fastRaf);\n    });\n\n    return () => {\n      isDrawing = false;\n    };\n  }, [stream]);\n\n  // eslint-disable-next-line no-null/no-null\n  const ref = useRef<HTMLDivElement>(null);\n  // eslint-disable-next-line no-null/no-null\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  const {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    handleContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  } = useContextMenuHandlers(ref, isSelf);\n\n  const getTriggerElement = useCallback(() => ref.current, []);\n\n  const getRootElement = useCallback(\n    () => ref.current!.closest('.custom-scroll, .no-scrollbar'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => menuRef.current!,\n    [],\n  );\n\n  const getLayout = useCallback(\n    () => ({ withPortal: true }),\n    [],\n  );\n\n  const handleClickPin = useCallback(() => {\n    setPinned(!isPinned ? {\n      id: user?.id || chat!.id,\n      type,\n    } : undefined);\n  }, [chat, isPinned, setPinned, type, user?.id]);\n\n  return (\n    <div\n      className={buildClassName(\n        styles.wrapper,\n        (isHidden || isRemoved) && styles.hidden,\n        noAnimate && styles.noAnimate,\n        className,\n        isPinned && styles.pinned,\n      )}\n      style={`--x: ${currentX}px; --y: ${currentY}px; --width: ${currentWidth}px; --height: ${currentHeight}px;`}\n      ref={ref}\n      onContextMenu={handleContextMenu}\n      onDoubleClick={canPin ? handleClickPin : undefined}\n    >\n      <div\n        className={buildClassName(\n          styles.root,\n          isSpeaking && styles.speaking,\n        )}\n      >\n        {isLoading && (\n          <Skeleton className={buildClassName(styles.video, styles.loader)} />\n        )}\n        {stream && (\n          <video\n            className={buildClassName(styles.video, shouldFlipVideo && styles.flipped)}\n            muted\n            autoPlay\n            playsInline\n            srcObject={stream}\n            ref={videoRef}\n            onCanPlay={handleCanPlay}\n          />\n        )}\n        <canvas\n          className={buildClassName(styles.videoFallback, shouldFlipVideo && styles.flipped)}\n          ref={videoFallbackRef}\n        />\n        <div className={styles.thumbnailWrapper}>\n          <canvas\n            className={buildClassName(styles.thumbnail, shouldFlipVideo && styles.flipped)}\n            ref={thumbnailRef}\n          />\n        </div>\n        {canPin && (\n          <Button\n            round\n            size=\"smaller\"\n            ripple\n            color=\"translucent\"\n            className={styles.pinButton}\n            ariaLabel={lang(isPinned ? 'lng_group_call_context_unpin_camera' : 'lng_group_call_context_pin_camera')}\n            onClick={handleClickPin}\n          >\n            <Icon name={isPinned ? 'unpin' : 'pin'} />\n          </Button>\n        )}\n        <div className={styles.bottomPanel}>\n          <div className={styles.info}>\n            <FullNameTitle peer={user || chat!} className={styles.name} />\n            <div className={styles.status}>{status}</div>\n          </div>\n          <OutlinedMicrophoneIcon participant={participant} className={styles.icon} noColor />\n        </div>\n      </div>\n\n      <GroupCallParticipantMenu\n        participant={participant}\n        isDropdownOpen={isContextMenuOpen}\n        anchor={contextMenuAnchor}\n        getTriggerElement={getTriggerElement}\n        getRootElement={getRootElement}\n        getMenuElement={getMenuElement}\n        getLayout={getLayout}\n        onClose={handleContextMenuClose}\n        onCloseAnimationEnd={handleContextMenuHide}\n        menuRef={menuRef}\n      />\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { participant }): StateProps => {\n    return {\n      user: participant.isUser ? selectUser(global, participant.id) : undefined,\n      chat: !participant.isUser ? selectChat(global, participant.id) : undefined,\n    };\n  },\n)(GroupCallParticipantVideo));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallConnectionState } from '../../../lib/secret-sauce';\n\nimport { selectActiveGroupCall, selectGroupCallParticipant } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { vibrateShort } from '../../../util/vibrate';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport useOldLang from '../../../hooks/useOldLang';\nimport usePreviousDeprecated from '../../../hooks/usePreviousDeprecated';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport Button from '../../ui/Button';\nimport Spinner from '../../ui/Spinner';\n\nimport styles from './MicrophoneButton.module.scss';\n\nconst CONNECTION_STATE_DEFAULT = 'discarded';\n\ntype OwnProps = {\n  className?: string;\n};\n\ntype StateProps = {\n  connectionState?: GroupCallConnectionState;\n  hasRequestedToSpeak: boolean;\n  isMuted?: boolean;\n  canSelfUnmute?: boolean;\n  noAudioStream: boolean;\n};\n\nconst REQUEST_TO_SPEAK_THROTTLE = 3000;\nconst HOLD_TO_SPEAK_TIME = 200;\nconst ICON_SIZE = 36;\n\nconst MicrophoneButton: FC<OwnProps & StateProps> = ({\n  className,\n  noAudioStream,\n  canSelfUnmute,\n  isMuted,\n  connectionState,\n}) => {\n  const {\n    toggleGroupCallMute,\n    requestToSpeak,\n    playGroupCallSound,\n  } = getActions();\n\n  const lang = useOldLang();\n  const muteMouseDownState = useRef('up');\n\n  const [isRequestingToSpeak, setIsRequestingToSpeak] = useState(false);\n  const isConnecting = connectionState !== 'connected';\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n  const prevShouldRaiseHand = usePreviousDeprecated(shouldRaiseHand);\n\n  useEffect(() => {\n    if (prevShouldRaiseHand && !shouldRaiseHand) {\n      playGroupCallSound({ sound: 'allowTalk' });\n    }\n  }, [playGroupCallSound, prevShouldRaiseHand, shouldRaiseHand]);\n\n  // Voice mini\n  // unmuted -> muted [69, 99]\n  // muted -> unmuted [36, 69]\n  // raise -> muted [0, 36]\n  // muted -> raise [99, 136]\n  // unmuted -> raise [136, 172]\n  // TODO should probably move to other component\n  const playSegment: [number, number] = useMemo(() => {\n    if (isRequestingToSpeak) {\n      const r = Math.floor(Math.random() * 100);\n      return (r < 32 ? [0, 120]\n        : (r < 64 ? [120, 240]\n          : (r < 97 ? [240, 420]\n            : [420, 540]\n          )\n        )\n      );\n    }\n    if (!prevShouldRaiseHand && shouldRaiseHand) {\n      return noAudioStream ? [99, 135] : [136, 172];\n    }\n    if (prevShouldRaiseHand && !shouldRaiseHand) {\n      return [0, 36];\n    }\n    if (!shouldRaiseHand) {\n      return noAudioStream ? [69, 99] : [36, 69];\n    }\n    return [0, 0];\n  }, [prevShouldRaiseHand, isRequestingToSpeak, noAudioStream, shouldRaiseHand]);\n\n  const animatedIconName = isRequestingToSpeak ? 'HandFilled' : 'VoiceMini';\n\n  const toggleMute = useCallback(() => {\n    vibrateShort();\n    toggleGroupCallMute();\n  }, [toggleGroupCallMute]);\n\n  const handleMouseDownMute = useCallback(() => {\n    if (shouldRaiseHand) {\n      if (isRequestingToSpeak) return;\n      vibrateShort();\n      requestToSpeak();\n      setIsRequestingToSpeak(true);\n      setTimeout(() => {\n        setIsRequestingToSpeak(false);\n      }, REQUEST_TO_SPEAK_THROTTLE);\n      return;\n    }\n    muteMouseDownState.current = 'down';\n    if (noAudioStream) {\n      setTimeout(() => {\n        if (muteMouseDownState.current === 'down') {\n          muteMouseDownState.current = 'hold';\n          toggleMute();\n        }\n      }, HOLD_TO_SPEAK_TIME);\n    }\n  }, [isRequestingToSpeak, noAudioStream, requestToSpeak, shouldRaiseHand, toggleMute]);\n\n  const handleMouseUpMute = useCallback(() => {\n    if (shouldRaiseHand) {\n      return;\n    }\n    toggleMute();\n    muteMouseDownState.current = 'up';\n  }, [shouldRaiseHand, toggleMute]);\n\n  return (\n    <Button\n      round\n      size=\"default\"\n      className={buildClassName(\n        styles.root,\n        !isConnecting && noAudioStream && styles.canUnmute,\n        !isConnecting && shouldRaiseHand && styles.mutedByAdmin,\n        className,\n      )}\n      onMouseDown={handleMouseDownMute}\n      onMouseUp={handleMouseUpMute}\n      ariaLabel={lang(isMuted ? 'VoipUnmute' : 'VoipMute')}\n      disabled={isConnecting}\n    >\n      <AnimatedIcon\n        tgsUrl={LOCAL_TGS_URLS[animatedIconName]}\n        size={ICON_SIZE}\n        play={playSegment.toString()}\n        playSegment={playSegment}\n        className={styles.icon}\n        forceAlways\n      />\n      <Spinner className={buildClassName(styles.spinner, isConnecting && styles.spinnerVisible)} color=\"white\" />\n    </Button>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    const groupCall = selectActiveGroupCall(global);\n\n    const { connectionState } = groupCall || {};\n    const meParticipant = groupCall && selectGroupCallParticipant(global, groupCall.id, global.currentUserId!);\n\n    const {\n      raiseHandRating, hasAudioStream, canSelfUnmute, isMuted,\n    } = meParticipant || {};\n\n    return {\n      connectionState: connectionState || CONNECTION_STATE_DEFAULT,\n      hasRequestedToSpeak: Boolean(raiseHandRating),\n      noAudioStream: !hasAudioStream,\n      canSelfUnmute,\n      isMuted,\n    };\n  },\n)(MicrophoneButton));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo, useMemo } from '../../../lib/teact/teact';\n\nimport type { GroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { THRESHOLD } from '../../../lib/secret-sauce';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport usePreviousDeprecated from '../../../hooks/usePreviousDeprecated';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\n\ntype OwnProps = {\n  participant: GroupCallParticipant;\n  noColor?: boolean;\n  className?: string;\n};\n\nconst OutlinedMicrophoneIcon: FC<OwnProps> = ({\n  participant,\n  noColor,\n  className,\n}) => {\n  const { isMuted, isMutedByMe } = participant;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n  const prevIsRaiseHand = usePreviousDeprecated(isRaiseHand);\n  const canSelfUnmute = Boolean(participant?.canSelfUnmute);\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n  const prevIsMuted = usePreviousDeprecated(isMuted);\n\n  const playSegment: [number, number] = useMemo(() => {\n    if (isMuted && !prevIsMuted) {\n      return [43, 64];\n    }\n\n    if (!isMuted && prevIsMuted) {\n      return [22, 42];\n    }\n\n    if (isRaiseHand && !prevIsRaiseHand) {\n      return [65, 84];\n    }\n\n    if (!shouldRaiseHand && prevIsRaiseHand) {\n      return [0, 21];\n    }\n\n    // TODO cancel request to speak should play in reverse\n    // if (!isRaiseHand && prevIsRaiseHand) {\n    //   return [84, 65];\n    // }\n\n    return isMuted ? [22, 23] : [43, 44];\n    // eslint-disable-next-line\n  }, [isMuted, shouldRaiseHand, isRaiseHand]);\n\n  const microphoneColor: string = useMemo(() => {\n    if (noColor) {\n      return '#ffffff';\n    }\n\n    if (isRaiseHand) {\n      return '#4da6e0';\n    }\n\n    if (shouldRaiseHand || isMutedByMe) {\n      return '#ff706f';\n    }\n\n    if (isSpeaking) {\n      return '#57bc6c';\n    }\n\n    return '#aaaaaa';\n  }, [noColor, isRaiseHand, shouldRaiseHand, isMutedByMe, isSpeaking]);\n\n  return (\n    <AnimatedIcon\n      tgsUrl={LOCAL_TGS_URLS.VoiceOutlined}\n      play={playSegment.toString()}\n      playSegment={playSegment}\n      size={28}\n      color={microphoneColor}\n      className={className}\n      forceAlways\n      nonInteractive\n    />\n  );\n};\n\nexport default memo(OutlinedMicrophoneIcon);\n","import type { GroupCallParticipant } from '../../../../lib/secret-sauce';\n\nimport { GROUP_CALL_DEFAULT_VOLUME, GROUP_CALL_VOLUME_MULTIPLIER } from '../../../../config';\n\nexport default function formatGroupCallVolume(participant: GroupCallParticipant) {\n  return Math.floor((participant.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER).toString();\n}\n","import type { RefObject } from 'react';\nimport {\n  useEffect, useMemo, useState,\n} from '../../../../lib/teact/teact';\n\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport usePreviousDeprecated from '../../../../hooks/usePreviousDeprecated';\nimport useResizeObserver from '../../../../hooks/useResizeObserver';\n\nconst PADDING_HORIZONTAL = 10;\nconst PADDING_VERTICAL = 8;\nconst PREFERRED_PANEL_VIDEO_HEIGHT = 240;\n\nexport type VideoLayout = {\n  participantId: string;\n  type: 'video' | 'screen';\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  shouldRemount?: boolean;\n  isRemounted?: boolean;\n  noAnimate?: boolean;\n  isRemoved?: boolean;\n  orderKey: number;\n};\n\nexport type VideoParticipant = {\n  id: string;\n  type: 'video' | 'screen';\n};\n\nexport default function useGroupCallVideoLayout({\n  primaryContainerRef,\n  secondaryContainerRef,\n  videoParticipants,\n  isLandscapeLayout,\n  pinnedVideo,\n}: {\n  primaryContainerRef: RefObject<HTMLDivElement>;\n  secondaryContainerRef: RefObject<HTMLDivElement>;\n  videoParticipants: VideoParticipant[];\n  isLandscapeLayout: boolean;\n  pinnedVideo: VideoParticipant | undefined;\n}) {\n  const [videoLayout, setVideoLayout] = useState<VideoLayout[]>([]);\n  const [panelOffset, setPanelOffset] = useState(0);\n  const videosCount = videoParticipants.length;\n  const prevVideosCount = usePreviousDeprecated(videosCount);\n  const prevVideoParticipants = usePreviousDeprecated(videoParticipants);\n  const removedVideoParticipants = useMemo(() => {\n    return prevVideoParticipants?.filter(\n      ({ id, type }) => !videoParticipants.some((p) => p.id === id && p.type === type),\n    );\n  }, [prevVideoParticipants, videoParticipants]);\n\n  const recalculateLayout = useLastCallback(() => {\n    const primaryContainer = primaryContainerRef.current;\n    const secondaryContainer = secondaryContainerRef.current;\n    if (!secondaryContainer) return;\n\n    const removed = prevVideosCount !== undefined && prevVideosCount > videosCount\n      ? prevVideosCount - videosCount : 0;\n\n    const {\n      x: secondaryInitialX,\n      y: secondaryInitialY,\n      width: secondaryContainerWidth,\n    } = secondaryContainer.getBoundingClientRect();\n\n    const layout: VideoLayout[] = [];\n    if (pinnedVideo !== undefined || !primaryContainer || !isLandscapeLayout) {\n      const isRemounted = true;\n      let skip = false;\n      let pinnedSkipIndex = 0;\n      let pinnedPush: VideoLayout | undefined;\n      let participants = videoParticipants;\n      if (pinnedVideo && primaryContainer && isLandscapeLayout) {\n        pinnedSkipIndex = participants\n          .findIndex(({ id, type }) => id === pinnedVideo.id && type === pinnedVideo.type);\n        if (pinnedSkipIndex !== -1) {\n          const {\n            x: initialX,\n            y: initialY,\n            width: containerWidth,\n            height: containerHeight,\n          } = primaryContainer.getBoundingClientRect();\n\n          const { id: participantId, type } = pinnedVideo;\n\n          pinnedPush = {\n            x: initialX,\n            y: initialY,\n            width: containerWidth,\n            height: containerHeight,\n            participantId,\n            type,\n            orderKey: pinnedSkipIndex,\n          };\n          skip = true;\n          participants = participants\n            .filter(({ id, type: videoType }) => id !== participantId || videoType !== pinnedVideo.type);\n        }\n      }\n\n      const secondaryVideosCounts = skip ? videosCount - 1 : videosCount;\n\n      const isFirstBig = secondaryVideosCounts % 2 === 1;\n      const columns = 2;\n      const rows = Math.ceil(secondaryVideosCounts / columns);\n      const smallWidth = (secondaryContainerWidth - (columns - 1) * PADDING_HORIZONTAL) / columns;\n      const heightTotal = Math.max(0, isFirstBig\n        ? (PREFERRED_PANEL_VIDEO_HEIGHT + (rows - 1) * smallWidth + (rows - 1) * PADDING_VERTICAL)\n        : rows * smallWidth + (rows - 1) * PADDING_VERTICAL);\n\n      for (let i = 0; i < secondaryVideosCounts; i++) {\n        const isBig = isFirstBig && i === 0;\n        const width = isBig ? secondaryContainerWidth : smallWidth;\n        const height = isBig ? PREFERRED_PANEL_VIDEO_HEIGHT : smallWidth;\n\n        const realIndex = isFirstBig && i !== 0 ? i + 1 : i;\n\n        const x = (isRemounted ? 0 : secondaryInitialX) + (realIndex % columns) * (width + PADDING_HORIZONTAL);\n        const y = (isRemounted ? 0 : secondaryInitialY) + (isFirstBig && i !== 0 ? (\n          PREFERRED_PANEL_VIDEO_HEIGHT + PADDING_VERTICAL\n          + (Math.floor(realIndex / columns) - 1) * (height + PADDING_VERTICAL)\n        ) : (\n          Math.floor(realIndex / columns) * (height + PADDING_VERTICAL)\n        ));\n        layout.push({\n          x,\n          y,\n          width,\n          height,\n          shouldRemount: !isRemounted,\n          isRemounted,\n          noAnimate: true,\n          participantId: participants[i].id,\n          type: participants[i].type,\n          orderKey: i >= pinnedSkipIndex ? i + 1 : i,\n        });\n      }\n\n      if (pinnedPush) {\n        layout.splice(pinnedSkipIndex, 0, pinnedPush);\n      }\n\n      if (removedVideoParticipants) {\n        for (let i = 0; i < removed; i++) {\n          layout.push({\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0,\n            isRemounted,\n            isRemoved: true,\n            participantId: removedVideoParticipants[i].id,\n            type: removedVideoParticipants[i].type,\n            orderKey: i + videosCount,\n          });\n        }\n      }\n\n      setPanelOffset(heightTotal);\n      setVideoLayout(layout);\n      return;\n    }\n\n    const {\n      x: initialX,\n      y: initialY,\n      width: containerWidth,\n      height: containerHeight,\n    } = primaryContainer.getBoundingClientRect();\n\n    const columns = calculateColumnsCount(videosCount);\n    const rows = Math.ceil(videosCount / columns);\n    const totalGridSize = rows * columns;\n    const shouldFillLastRow = totalGridSize > videosCount;\n    const width = (containerWidth - (columns - 1) * PADDING_HORIZONTAL) / columns;\n    const height = (containerHeight - (rows - 1) * PADDING_VERTICAL) / rows;\n\n    const lastRowWidth = width * (videosCount % columns);\n    for (let i = 0; i < videosCount; i++) {\n      const row = Math.floor(i / columns);\n      const shouldCenter = shouldFillLastRow && row === rows - 1;\n      const x = initialX + (i % columns) * (width + PADDING_HORIZONTAL)\n        + (shouldCenter ? (containerWidth - lastRowWidth) / 2 : 0);\n      const y = initialY + Math.floor(i / columns) * (height + PADDING_VERTICAL);\n      layout.push({\n        x,\n        y,\n        width,\n        height,\n        participantId: videoParticipants[i].id,\n        type: videoParticipants[i].type,\n        orderKey: i,\n      });\n    }\n\n    if (removedVideoParticipants) {\n      for (let i = 0; i < removed; i++) {\n        layout.push({\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0,\n          isRemoved: true,\n          participantId: removedVideoParticipants[i].id,\n          type: removedVideoParticipants[i].type,\n          orderKey: i + videosCount,\n        });\n      }\n    }\n\n    setPanelOffset(0);\n    setVideoLayout(layout);\n  });\n\n  useEffect(recalculateLayout, [\n    recalculateLayout, videoParticipants, isLandscapeLayout, pinnedVideo,\n  ]);\n\n  useResizeObserver(primaryContainerRef, recalculateLayout, !primaryContainerRef.current);\n  useResizeObserver(secondaryContainerRef, recalculateLayout, !secondaryContainerRef.current);\n\n  return {\n    videoLayout, panelOffset,\n  };\n}\n\nfunction calculateColumnsCount(videosCount: number) {\n  if (videosCount >= 25) {\n    return 5;\n  } else if (videosCount >= 13) {\n    return 4;\n  } else if (videosCount >= 7) {\n    return 3;\n  } else if (videosCount >= 3) {\n    return 2;\n  } else {\n    return 1;\n  }\n}\n","import '../../../global/actions/calls';\n\nimport type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useEffect, useMemo, useRef,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiPhoneCall, ApiUser } from '../../../api/types';\n\nimport {\n  getStreams, IS_SCREENSHARE_SUPPORTED, switchCameraInputP2p, toggleStreamP2p,\n} from '../../../lib/secret-sauce';\nimport { selectTabState } from '../../../global/selectors';\nimport { selectPhoneCallUser } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatMediaDuration } from '../../../util/dates/dateFormat';\nimport {\n  IS_ANDROID,\n  IS_IOS,\n  IS_REQUEST_FULLSCREEN_SUPPORTED,\n} from '../../../util/windowEnvironment';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\nimport renderText from '../../common/helpers/renderText';\n\nimport useInterval from '../../../hooks/schedulers/useInterval';\nimport useAppLayout from '../../../hooks/useAppLayout';\nimport useFlag from '../../../hooks/useFlag';\nimport useForceUpdate from '../../../hooks/useForceUpdate';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport Avatar from '../../common/Avatar';\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\nimport Modal from '../../ui/Modal';\nimport PhoneCallButton from './PhoneCallButton';\n\nimport styles from './PhoneCall.module.scss';\n\ntype StateProps = {\n  user?: ApiUser;\n  phoneCall?: ApiPhoneCall;\n  isOutgoing: boolean;\n  isCallPanelVisible?: boolean;\n};\n\nconst PhoneCall: FC<StateProps> = ({\n  user,\n  isOutgoing,\n  phoneCall,\n  isCallPanelVisible,\n}) => {\n  const lang = useOldLang();\n  const {\n    hangUp, requestMasterAndAcceptCall, playGroupCallSound, toggleGroupCallPanel, connectToActivePhoneCall,\n  } = getActions();\n  // eslint-disable-next-line no-null/no-null\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const [isFullscreen, openFullscreen, closeFullscreen] = useFlag();\n  const { isMobile } = useAppLayout();\n\n  const toggleFullscreen = useCallback(() => {\n    if (isFullscreen) {\n      closeFullscreen();\n    } else {\n      openFullscreen();\n    }\n  }, [closeFullscreen, isFullscreen, openFullscreen]);\n\n  const handleToggleFullscreen = useCallback(() => {\n    if (!containerRef.current) return;\n\n    if (isFullscreen) {\n      document.exitFullscreen().then(closeFullscreen);\n    } else {\n      containerRef.current.requestFullscreen().then(openFullscreen);\n    }\n  }, [closeFullscreen, isFullscreen, openFullscreen]);\n\n  useEffect(() => {\n    if (!IS_REQUEST_FULLSCREEN_SUPPORTED) return undefined;\n    const container = containerRef.current;\n    if (!container) return undefined;\n\n    container.addEventListener('fullscreenchange', toggleFullscreen);\n\n    return () => {\n      container.removeEventListener('fullscreenchange', toggleFullscreen);\n    };\n  }, [toggleFullscreen]);\n\n  const handleClose = useCallback(() => {\n    toggleGroupCallPanel();\n    if (isFullscreen) {\n      closeFullscreen();\n    }\n  }, [closeFullscreen, isFullscreen, toggleGroupCallPanel]);\n\n  const isDiscarded = phoneCall?.state === 'discarded';\n  const isBusy = phoneCall?.reason === 'busy';\n\n  const isIncomingRequested = phoneCall?.state === 'requested' && !isOutgoing;\n  const isOutgoingRequested = (phoneCall?.state === 'requested' || phoneCall?.state === 'waiting') && isOutgoing;\n  const isActive = phoneCall?.state === 'active';\n  const isConnected = phoneCall?.isConnected;\n\n  const [isHangingUp, startHangingUp, stopHangingUp] = useFlag();\n  const handleHangUp = useCallback(() => {\n    startHangingUp();\n    hangUp();\n  }, [hangUp, startHangingUp]);\n\n  useEffect(() => {\n    if (isHangingUp) {\n      playGroupCallSound({ sound: 'end' });\n    } else if (isIncomingRequested) {\n      playGroupCallSound({ sound: 'incoming' });\n    } else if (isBusy) {\n      playGroupCallSound({ sound: 'busy' });\n    } else if (isDiscarded) {\n      playGroupCallSound({ sound: 'end' });\n    } else if (isOutgoingRequested) {\n      playGroupCallSound({ sound: 'ringing' });\n    } else if (isConnected) {\n      playGroupCallSound({ sound: 'connect' });\n    }\n  }, [isBusy, isDiscarded, isIncomingRequested, isOutgoingRequested, isConnected, playGroupCallSound, isHangingUp]);\n\n  useEffect(() => {\n    if (phoneCall?.id) {\n      stopHangingUp();\n    } else {\n      connectToActivePhoneCall();\n    }\n  }, [connectToActivePhoneCall, phoneCall?.id, stopHangingUp]);\n\n  const forceUpdate = useForceUpdate();\n\n  useInterval(forceUpdate, isConnected ? 1000 : undefined);\n\n  const callStatus = useMemo(() => {\n    const state = phoneCall?.state;\n    if (isHangingUp) {\n      return lang('lng_call_status_hanging');\n    }\n    if (isBusy) return 'busy';\n    if (state === 'requesting') {\n      return lang('lng_call_status_requesting');\n    } else if (state === 'requested') {\n      return isOutgoing ? lang('lng_call_status_ringing') : lang('lng_call_status_incoming');\n    } else if (state === 'waiting') {\n      return lang('lng_call_status_waiting');\n    } else if (state === 'active' && isConnected) {\n      return undefined;\n    } else {\n      return lang('lng_call_status_exchanging');\n    }\n  }, [isBusy, isConnected, isHangingUp, isOutgoing, lang, phoneCall?.state]);\n\n  const hasVideo = phoneCall?.videoState === 'active';\n  const hasPresentation = phoneCall?.screencastState === 'active';\n\n  const streams = getStreams();\n  const hasOwnAudio = streams?.ownAudio?.getTracks()[0].enabled;\n  const hasOwnPresentation = streams?.ownPresentation?.getTracks()[0].enabled;\n  const hasOwnVideo = streams?.ownVideo?.getTracks()[0].enabled;\n\n  const [isHidingPresentation, startHidingPresentation, stopHidingPresentation] = useFlag();\n  const [isHidingVideo, startHidingVideo, stopHidingVideo] = useFlag();\n\n  const handleTogglePresentation = useCallback(() => {\n    if (hasOwnPresentation) {\n      startHidingPresentation();\n    }\n    if (hasOwnVideo) {\n      startHidingVideo();\n    }\n    setTimeout(async () => {\n      await toggleStreamP2p('presentation');\n      stopHidingPresentation();\n      stopHidingVideo();\n    }, 250);\n  }, [\n    hasOwnPresentation, hasOwnVideo, startHidingPresentation, startHidingVideo, stopHidingPresentation, stopHidingVideo,\n  ]);\n\n  const handleToggleVideo = useCallback(() => {\n    if (hasOwnVideo) {\n      startHidingVideo();\n    }\n    if (hasOwnPresentation) {\n      startHidingPresentation();\n    }\n    setTimeout(async () => {\n      await toggleStreamP2p('video');\n      stopHidingPresentation();\n      stopHidingVideo();\n    }, 250);\n  }, [\n    hasOwnPresentation, hasOwnVideo, startHidingPresentation, startHidingVideo, stopHidingPresentation, stopHidingVideo,\n  ]);\n\n  const handleToggleAudio = useCallback(() => {\n    void toggleStreamP2p('audio');\n  }, []);\n\n  const [isEmojiOpen, openEmoji, closeEmoji] = useFlag();\n\n  const [isFlipping, startFlipping, stopFlipping] = useFlag();\n\n  const handleFlipCamera = useCallback(() => {\n    startFlipping();\n    switchCameraInputP2p();\n    setTimeout(stopFlipping, 250);\n  }, [startFlipping, stopFlipping]);\n\n  const timeElapsed = phoneCall?.startDate && (Number(new Date()) / 1000 - phoneCall.startDate);\n\n  useEffect(() => {\n    if (phoneCall?.state === 'discarded') {\n      setTimeout(hangUp, 250);\n    }\n  }, [hangUp, phoneCall?.reason, phoneCall?.state]);\n\n  return (\n    <Modal\n      isOpen={phoneCall && phoneCall?.state !== 'discarded' && !isCallPanelVisible}\n      onClose={handleClose}\n      className={buildClassName(\n        styles.root,\n        isMobile && styles.singleColumn,\n      )}\n      dialogRef={containerRef}\n    >\n      <Avatar\n        peer={user}\n        size=\"jumbo\"\n        className={hasVideo || hasPresentation ? styles.blurred : ''}\n      />\n      {phoneCall?.screencastState === 'active' && streams?.presentation\n        && <video className={styles.mainVideo} muted autoPlay playsInline srcObject={streams.presentation} />}\n      {phoneCall?.videoState === 'active' && streams?.video\n        && <video className={styles.mainVideo} muted autoPlay playsInline srcObject={streams.video} />}\n      <video\n        className={buildClassName(\n          styles.secondVideo,\n          !isHidingPresentation && hasOwnPresentation && styles.visible,\n          isFullscreen && styles.fullscreen,\n        )}\n        muted\n        autoPlay\n        playsInline\n        srcObject={streams?.ownPresentation}\n      />\n      <video\n        className={buildClassName(\n          styles.secondVideo,\n          !isHidingVideo && hasOwnVideo && styles.visible,\n          isFullscreen && styles.fullscreen,\n        )}\n        muted\n        autoPlay\n        playsInline\n        srcObject={streams?.ownVideo}\n      />\n      <div className={styles.header}>\n        {IS_REQUEST_FULLSCREEN_SUPPORTED && (\n          <Button\n            round\n            size=\"smaller\"\n            color=\"translucent\"\n            onClick={handleToggleFullscreen}\n            ariaLabel={lang(isFullscreen ? 'AccExitFullscreen' : 'AccSwitchToFullscreen')}\n          >\n            <Icon name={isFullscreen ? 'smallscreen' : 'fullscreen'} />\n          </Button>\n        )}\n\n        <Button\n          round\n          size=\"smaller\"\n          color=\"translucent\"\n          onClick={handleClose}\n          className={styles.closeButton}\n        >\n          <Icon name=\"close\" />\n        </Button>\n      </div>\n      <div\n        className={buildClassName(styles.emojisBackdrop, isEmojiOpen && styles.open)}\n        onClick={!isEmojiOpen ? openEmoji : closeEmoji}\n      >\n        <div className={buildClassName(styles.emojis, isEmojiOpen && styles.open)}>\n          {phoneCall?.isConnected && phoneCall?.emojis && renderText(phoneCall.emojis, ['emoji'])}\n        </div>\n        <div className={buildClassName(styles.emojiTooltip, isEmojiOpen && styles.open)}>\n          {lang('CallEmojiKeyTooltip', user?.firstName).replace('%%', '%')}\n        </div>\n      </div>\n      <div className={styles.userInfo}>\n        <h1>{user?.firstName}</h1>\n        <span className={styles.status}>{callStatus || formatMediaDuration(timeElapsed || 0)}</span>\n      </div>\n      <div className={styles.buttons}>\n        <PhoneCallButton\n          onClick={handleToggleAudio}\n          icon=\"microphone\"\n          isDisabled={!isActive}\n          isActive={hasOwnAudio}\n          label={lang(hasOwnAudio ? 'lng_call_mute_audio' : 'lng_call_unmute_audio')}\n        />\n        <PhoneCallButton\n          onClick={handleToggleVideo}\n          icon=\"video\"\n          isDisabled={!isActive}\n          isActive={hasOwnVideo}\n          label={lang(hasOwnVideo ? 'lng_call_stop_video' : 'lng_call_start_video')}\n        />\n        {hasOwnVideo && (IS_ANDROID || IS_IOS) && (\n          <PhoneCallButton\n            onClick={handleFlipCamera}\n            customIcon={(\n              <AnimatedIcon\n                tgsUrl={LOCAL_TGS_URLS.CameraFlip}\n                playSegment={!isFlipping ? [0, 1] : [0, 10]}\n                size={32}\n              />\n            )}\n            isDisabled={!isActive}\n            label={lang('VoipFlip')}\n          />\n        )}\n        {IS_SCREENSHARE_SUPPORTED && (\n          <PhoneCallButton\n            onClick={handleTogglePresentation}\n            icon=\"share-screen\"\n            isDisabled={!isActive}\n            isActive={hasOwnPresentation}\n            label={lang('lng_call_screencast')}\n          />\n        )}\n        {isIncomingRequested && (\n          <PhoneCallButton\n            onClick={requestMasterAndAcceptCall}\n            icon=\"phone-discard\"\n            isDisabled={isDiscarded}\n            label={lang('lng_call_accept')}\n            className={styles.accept}\n            iconClassName={styles.acceptIcon}\n          />\n        )}\n        <PhoneCallButton\n          onClick={handleHangUp}\n          icon=\"phone-discard\"\n          isDisabled={isDiscarded}\n          label={lang(isIncomingRequested ? 'lng_call_decline' : 'lng_call_end_call')}\n          className={styles.leave}\n        />\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): StateProps => {\n    const { phoneCall, currentUserId } = global;\n    const { isCallPanelVisible, isMasterTab } = selectTabState(global);\n    const user = selectPhoneCallUser(global);\n\n    return {\n      isCallPanelVisible: Boolean(isCallPanelVisible),\n      user,\n      isOutgoing: phoneCall?.adminId === currentUserId,\n      phoneCall: isMasterTab ? phoneCall : undefined,\n    };\n  },\n)(PhoneCall));\n","import type { FC } from '../../../lib/teact/teact';\nimport React, { memo } from '../../../lib/teact/teact';\n\nimport type { IconName } from '../../../types/icons';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\n\nimport styles from './PhoneCallButton.module.scss';\n\ntype OwnProps = {\n  onClick: VoidFunction;\n  label: string;\n  icon?: IconName;\n  iconClassName?: string;\n  customIcon?: React.ReactNode;\n  className?: string;\n  isDisabled?: boolean;\n  isActive?: boolean;\n};\n\nconst PhoneCallButton: FC<OwnProps> = ({\n  onClick,\n  label,\n  customIcon,\n  icon,\n  iconClassName,\n  className,\n  isDisabled,\n  isActive,\n}) => {\n  return (\n    <div className={styles.root}>\n      <Button\n        round\n        className={buildClassName(className, styles.button, isActive && styles.active)}\n        onClick={onClick}\n        disabled={isDisabled}\n      >\n        {customIcon || <Icon name={icon!} className={iconClassName} />}\n      </Button>\n      <div className={styles.buttonText}>{label}</div>\n    </div>\n  );\n};\n\nexport default memo(PhoneCallButton);\n","import type { FC } from '../../../lib/teact/teact';\nimport React, {\n  memo, useCallback, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\nimport InputText from '../../ui/InputText';\nimport Modal from '../../ui/Modal';\n\nimport styles from './RatePhoneCallModal.module.scss';\n\nexport type OwnProps = {\n  isOpen?: boolean;\n};\n\nconst RatePhoneCallModal: FC<OwnProps> = ({\n  isOpen,\n}) => {\n  const { closeCallRatingModal, setCallRating } = getActions();\n\n  // eslint-disable-next-line no-null/no-null\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const lang = useOldLang();\n  const [rating, setRating] = useState<number | undefined>();\n\n  const handleSend = useCallback(() => {\n    if (!rating) {\n      closeCallRatingModal();\n      return;\n    }\n    setCallRating({\n      rating: rating + 1,\n      comment: inputRef.current?.value || '',\n    });\n  }, [closeCallRatingModal, rating, setCallRating]);\n\n  function handleClickStar(index: number) {\n    return () => setRating(rating === index ? undefined : index);\n  }\n\n  const handleCancelClick = useCallback(() => {\n    closeCallRatingModal();\n  }, [closeCallRatingModal]);\n\n  return (\n    <Modal title={lang('lng_call_rate_label')} className=\"narrow\" onClose={closeCallRatingModal} isOpen={isOpen}>\n      <div className={styles.stars}>\n        {new Array(5).fill(undefined).map((_, i) => {\n          const isFilled = rating !== undefined && rating >= i;\n          return (\n            <Icon\n              name={isFilled ? 'favorite-filled' : 'favorite'}\n              className={buildClassName(\n                isFilled && styles.isFilled,\n                styles.star,\n              )}\n              onClick={handleClickStar(i)}\n            />\n          );\n        })}\n      </div>\n      <InputText\n        ref={inputRef}\n        placeholder={lang('lng_call_rate_comment')}\n        className={buildClassName(styles.comment, rating !== 4 && rating !== undefined && styles.visible)}\n      />\n\n      <div className=\"dialog-buttons mt-2\">\n        <Button className=\"confirm-dialog-button\" isText onClick={handleSend}>\n          {lang('Send')}\n        </Button>\n        <Button className=\"confirm-dialog-button\" isText onClick={handleCancelClick}>{lang('Cancel')}</Button>\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(RatePhoneCallModal);\n","import type { FC } from '../../lib/teact/teact';\nimport React, { memo, useCallback } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiChat } from '../../api/types';\n\nimport { getUserFirstOrLastName } from '../../global/helpers';\nimport { selectCurrentChat, selectUser } from '../../global/selectors';\nimport renderText from '../common/helpers/renderText';\n\nimport useOldLang from '../../hooks/useOldLang';\n\nimport ConfirmDialog from '../ui/ConfirmDialog';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  userId?: string;\n  onClose: () => void;\n};\n\ntype StateProps = {\n  chat?: ApiChat;\n  contactName?: string;\n};\n\nconst DeleteMemberModal: FC<OwnProps & StateProps> = ({\n  isOpen,\n  chat,\n  userId,\n  contactName,\n  onClose,\n}) => {\n  const { deleteChatMember } = getActions();\n\n  const lang = useOldLang();\n\n  const handleDeleteChatMember = useCallback(() => {\n    deleteChatMember({ chatId: chat!.id, userId: userId! });\n    onClose();\n  }, [chat, deleteChatMember, onClose, userId]);\n\n  if (!chat || !userId) {\n    return undefined;\n  }\n\n  return (\n    <ConfirmDialog\n      isOpen={isOpen}\n      onClose={onClose}\n      title={lang('GroupRemoved.Remove')}\n      textParts={renderText(lang('PeerInfo.Confirm.RemovePeer', contactName))}\n      confirmLabel={lang('lng_box_remove')}\n      confirmHandler={handleDeleteChatMember}\n      confirmIsDestructive\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { userId }): StateProps => {\n    const chat = selectCurrentChat(global);\n    const user = userId && selectUser(global, userId);\n    const contactName = user ? getUserFirstOrLastName(user) : undefined;\n\n    return {\n      chat,\n      contactName,\n    };\n  },\n)(DeleteMemberModal));\n","import type { ApiPhoneCall } from '../../../api/types';\nimport type { ApiCallProtocol } from '../../../lib/secret-sauce';\nimport type { ActionReturnType } from '../../types';\n\nimport {\n  handleUpdateGroupCallConnection,\n  handleUpdateGroupCallParticipants,\n  joinPhoneCall, processSignalingMessage,\n} from '../../../lib/secret-sauce';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { omit } from '../../../util/iteratees';\nimport * as langProvider from '../../../util/oldLangProvider';\nimport { EMOJI_DATA, EMOJI_OFFSETS } from '../../../util/phoneCallEmojiConstants';\nimport { ARE_CALLS_SUPPORTED } from '../../../util/windowEnvironment';\nimport { callApi } from '../../../api/gramjs';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport { updateGroupCall, updateGroupCallParticipant } from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectActiveGroupCall, selectGroupCallParticipant, selectPhoneCallUser } from '../../selectors/calls';\n\naddActionHandler('apiUpdate', (global, actions, update): ActionReturnType => {\n  const { activeGroupCallId } = global.groupCalls;\n\n  switch (update['@type']) {\n    case 'updateGroupCallLeavePresentation': {\n      actions.toggleGroupCallPresentation({ value: false });\n      break;\n    }\n    case 'updateGroupCallStreams': {\n      if (!update.userId || !activeGroupCallId) break;\n      if (!selectGroupCallParticipant(global, activeGroupCallId, update.userId)) break;\n\n      return updateGroupCallParticipant(global, activeGroupCallId, update.userId, omit(update, ['@type', 'userId']));\n    }\n    case 'updateGroupCallConnectionState': {\n      if (!activeGroupCallId) break;\n\n      if (update.connectionState === 'disconnected') {\n        if ('leaveGroupCall' in actions) actions.leaveGroupCall({ isFromLibrary: true, tabId: getCurrentTabId() });\n        break;\n      }\n\n      return updateGroupCall(global, activeGroupCallId, {\n        connectionState: update.connectionState,\n        isSpeakerDisabled: update.isSpeakerDisabled,\n      });\n    }\n    case 'updateGroupCallParticipants': {\n      const { groupCallId, participants } = update;\n      if (activeGroupCallId === groupCallId) {\n        void handleUpdateGroupCallParticipants(participants);\n      }\n      break;\n    }\n    case 'updateGroupCallConnection': {\n      if (update.data.stream) {\n        actions.showNotification({ message: 'Big live streams are not yet supported', tabId: getCurrentTabId() });\n        if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId: getCurrentTabId() });\n        break;\n      }\n      void handleUpdateGroupCallConnection(update.data, update.presentation);\n\n      const groupCall = selectActiveGroupCall(global);\n      if (groupCall?.participants && Object.keys(groupCall.participants).length > 0) {\n        void handleUpdateGroupCallParticipants(Object.values(groupCall.participants));\n      }\n      break;\n    }\n    case 'updatePhoneCallMediaState':\n      return {\n        ...global,\n        phoneCall: {\n          ...global.phoneCall,\n          ...omit(update, ['@type']),\n        } as ApiPhoneCall,\n      };\n    case 'updatePhoneCall': {\n      if (!ARE_CALLS_SUPPORTED) return undefined;\n      const { phoneCall, currentUserId } = global;\n\n      const call: ApiPhoneCall = {\n        ...phoneCall,\n        ...update.call,\n      };\n\n      const isOutgoing = phoneCall?.adminId === currentUserId;\n\n      global = {\n        ...global,\n        phoneCall: call,\n      };\n      setGlobal(global);\n      global = getGlobal();\n\n      if (phoneCall && phoneCall.id && call.id !== phoneCall.id) {\n        if (call.state !== 'discarded') {\n          callApi('discardCall', {\n            call,\n            isBusy: true,\n          });\n        }\n        return undefined;\n      }\n\n      const {\n        accessHash, state, connections, gB,\n      } = call;\n\n      if (state === 'active' || state === 'accepted') {\n        if (!verifyPhoneCallProtocol(call.protocol)) {\n          const user = selectPhoneCallUser(global);\n          if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n          actions.showNotification({\n            message: langProvider.oldTranslate('VoipPeerIncompatible', user?.firstName),\n            tabId: getCurrentTabId(),\n          });\n          return undefined;\n        }\n      }\n\n      if (state === 'discarded') {\n        // Discarded from other device\n        if (!phoneCall) return undefined;\n\n        return updateTabState(global, {\n          ...(call.needRating && { ratingPhoneCall: call }),\n          isCallPanelVisible: undefined,\n        }, getCurrentTabId());\n      } else if (state === 'accepted' && accessHash && gB) {\n        (async () => {\n          const { gA, keyFingerprint, emojis } = await callApi('confirmPhoneCall', [gB, EMOJI_DATA, EMOJI_OFFSETS])!;\n\n          global = getGlobal();\n          const newCall = {\n            ...global.phoneCall,\n            emojis,\n          } as ApiPhoneCall;\n\n          global = {\n            ...global,\n            phoneCall: newCall,\n          };\n          setGlobal(global);\n\n          callApi('confirmCall', {\n            call, gA, keyFingerprint,\n          });\n        })();\n      } else if (state === 'active' && connections && phoneCall?.state !== 'active') {\n        if (!isOutgoing) {\n          callApi('receivedCall', { call });\n          (async () => {\n            const { emojis } = await callApi('confirmPhoneCall', [call!.gAOrB!, EMOJI_DATA, EMOJI_OFFSETS])!;\n\n            global = getGlobal();\n            const newCall = {\n              ...global.phoneCall,\n              emojis,\n            } as ApiPhoneCall;\n\n            global = {\n              ...global,\n              phoneCall: newCall,\n            };\n            setGlobal(global);\n          })();\n        }\n        void joinPhoneCall(\n          connections,\n          actions.sendSignalingData,\n          isOutgoing,\n          Boolean(call?.isVideo),\n          Boolean(call.isP2pAllowed),\n          actions.apiUpdate,\n        );\n      }\n\n      return global;\n    }\n    case 'updatePhoneCallConnectionState': {\n      const { connectionState } = update;\n\n      if (!global.phoneCall) return global;\n\n      if (connectionState === 'closed' || connectionState === 'disconnected' || connectionState === 'failed') {\n        if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n        return undefined;\n      }\n\n      return {\n        ...global,\n        phoneCall: {\n          ...global.phoneCall,\n          isConnected: connectionState === 'connected',\n        },\n      };\n    }\n    case 'updatePhoneCallSignalingData': {\n      const { phoneCall } = global;\n\n      if (!phoneCall) {\n        break;\n      }\n\n      callApi('decodePhoneCallData', [update.data])?.then(processSignalingMessage);\n      break;\n    }\n  }\n\n  return undefined;\n});\n\nfunction verifyPhoneCallProtocol(protocol?: ApiCallProtocol) {\n  return protocol?.libraryVersions.some((version) => {\n    return version === '4.0.0' || version === '4.0.1';\n  });\n}\n","import type { ActionReturnType } from '../../types';\n\nimport { GROUP_CALL_VOLUME_MULTIPLIER } from '../../../config';\nimport {\n  isStreamEnabled,\n  joinGroupCall,\n  leaveGroupCall,\n  setVolume, startSharingScreen,\n  stopPhoneCall,\n  toggleStream,\n} from '../../../lib/secret-sauce';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { callApi } from '../../../api/gramjs';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport {\n  removeGroupCall,\n  updateActiveGroupCall,\n} from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectChat, selectTabState, selectUser } from '../../selectors';\nimport {\n  selectActiveGroupCall, selectPhoneCallUser,\n} from '../../selectors/calls';\nimport { getGroupCallAudioContext, getGroupCallAudioElement, removeGroupCallAudioElement } from '../ui/calls';\nimport { loadFullChat } from './chats';\n\nconst HANG_UP_UI_DELAY = 500;\n\naddActionHandler('leaveGroupCall', async (global, actions, payload): Promise<void> => {\n  const {\n    isFromLibrary, shouldDiscard, shouldRemove, rejoin,\n    isPageUnload, tabId = getCurrentTabId(),\n  } = payload || {};\n\n  const groupCall = selectActiveGroupCall(global);\n  if (!groupCall) {\n    return;\n  }\n\n  global = updateActiveGroupCall(global, { connectionState: 'disconnected' }, groupCall.participantsCount - 1);\n  global = {\n    ...global,\n    groupCalls: {\n      ...global.groupCalls,\n      activeGroupCallId: undefined,\n    },\n  };\n  setGlobal(global);\n\n  await callApi('leaveGroupCall', {\n    call: groupCall, isPageUnload,\n  });\n  await callApi('abortRequestGroup', 'call');\n\n  if (shouldDiscard) {\n    await callApi('discardGroupCall', {\n      call: groupCall,\n    });\n  }\n\n  global = getGlobal();\n  if (shouldRemove) {\n    global = removeGroupCall(global, groupCall.id);\n  }\n\n  removeGroupCallAudioElement();\n\n  setGlobal(global);\n\n  actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n  if (!isFromLibrary) {\n    leaveGroupCall();\n  }\n\n  actions.afterHangUp();\n\n  if (rejoin) {\n    actions.requestMasterAndJoinGroupCall({\n      ...rejoin,\n      tabId,\n    });\n  }\n});\n\naddActionHandler('toggleGroupCallVideo', async (global): Promise<void> => {\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  await toggleStream('video');\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    videoStopped: !isStreamEnabled('video'),\n    participant: user,\n  });\n});\n\naddActionHandler('requestToSpeak', (global, actions, payload): ActionReturnType => {\n  const { value } = payload || { value: true };\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  void callApi('editGroupCallParticipant', {\n    call: groupCall,\n    raiseHand: value,\n    participant: user,\n  });\n});\n\naddActionHandler('setGroupCallParticipantVolume', (global, actions, payload): ActionReturnType => {\n  const { participantId, volume } = payload!;\n\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, participantId);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  setVolume(participantId, Math.floor(volume / GROUP_CALL_VOLUME_MULTIPLIER) / 100);\n\n  void callApi('editGroupCallParticipant', {\n    call: groupCall,\n    volume: Number(volume),\n    participant: user,\n  });\n});\n\naddActionHandler('toggleGroupCallMute', async (global, actions, payload): Promise<void> => {\n  const { participantId, value } = payload || {};\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, participantId || global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  const muted = value === undefined ? isStreamEnabled('audio', user.id) : value;\n\n  if (!participantId) {\n    await toggleStream('audio');\n  } else {\n    setVolume(participantId, muted ? 0 : 1);\n  }\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    muted,\n    participant: user,\n  });\n});\n\naddActionHandler('toggleGroupCallPresentation', async (global, actions, payload): Promise<void> => {\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  const value = payload?.value !== undefined ? payload?.value : !isStreamEnabled('presentation');\n  if (value) {\n    const params = await startSharingScreen();\n    if (!params) {\n      return;\n    }\n\n    await callApi('joinGroupCallPresentation', {\n      call: groupCall,\n      params,\n    });\n  } else {\n    await toggleStream('presentation', false);\n    await callApi('leaveGroupCallPresentation', {\n      call: groupCall,\n    });\n  }\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    presentationPaused: !isStreamEnabled('presentation'),\n    participant: user,\n  });\n});\n\naddActionHandler('connectToActiveGroupCall', async (global, actions, payload): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  const groupCall = selectActiveGroupCall(global);\n  if (!groupCall) return;\n\n  if (groupCall.connectionState === 'discarded') {\n    actions.showNotification({ message: 'This voice chat is not active', tabId });\n    return;\n  }\n\n  const audioElement = getGroupCallAudioElement();\n  const audioContext = getGroupCallAudioContext();\n\n  if (!audioElement || !audioContext) {\n    return;\n  }\n\n  const {\n    currentUserId,\n  } = global;\n\n  if (!currentUserId) return;\n\n  const params = await joinGroupCall(currentUserId, audioContext, audioElement, actions.apiUpdate);\n\n  const result = await callApi('joinGroupCall', {\n    call: groupCall,\n    params,\n    inviteHash: groupCall.inviteHash,\n  });\n\n  global = getGlobal();\n\n  if (!result) {\n    actions.showNotification({\n      // TODO[lang] Localize error message\n      message: 'Failed to join voice chat',\n      tabId,\n    });\n    actions.leaveGroupCall({ tabId });\n    return;\n  }\n\n  actions.loadMoreGroupCallParticipants();\n\n  if (groupCall.chatId) {\n    global = getGlobal();\n    const chat = selectChat(global, groupCall.chatId);\n    if (!chat) return;\n    await loadFullChat(global, actions, chat);\n  }\n});\n\naddActionHandler('connectToActivePhoneCall', async (global, actions): Promise<void> => {\n  const { phoneCall } = global;\n\n  if (!phoneCall) return;\n\n  const user = selectPhoneCallUser(global);\n\n  if (!user) return;\n\n  const dhConfig = await callApi('getDhConfig');\n\n  if (!dhConfig) return;\n\n  await callApi('createPhoneCallState', [true]);\n\n  const gAHash = await callApi('requestPhoneCall', [dhConfig])!;\n\n  const result = await callApi('requestCall', { user, gAHash, isVideo: phoneCall.isVideo });\n\n  if (!result) {\n    if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n  }\n});\n\naddActionHandler('acceptCall', async (global): Promise<void> => {\n  const { phoneCall } = global;\n\n  if (!phoneCall) return;\n\n  const dhConfig = await callApi('getDhConfig');\n  if (!dhConfig) return;\n\n  await callApi('createPhoneCallState', [false]);\n\n  const gB = await callApi('acceptPhoneCall', [dhConfig])!;\n  await callApi('acceptCall', { call: phoneCall, gB });\n});\n\naddActionHandler('sendSignalingData', (global, actions, payload): ActionReturnType => {\n  const { phoneCall } = global;\n  if (!phoneCall) {\n    return;\n  }\n\n  const data = JSON.stringify(payload);\n\n  (async () => {\n    const encodedData = await callApi('encodePhoneCallData', [data]);\n\n    if (!encodedData) return;\n\n    callApi('sendSignalingData', { data: encodedData, call: phoneCall });\n  })();\n});\n\naddActionHandler('closeCallRatingModal', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  return updateTabState(global, {\n    ratingPhoneCall: undefined,\n  }, tabId);\n});\n\naddActionHandler('setCallRating', (global, actions, payload): ActionReturnType => {\n  const { rating, comment, tabId = getCurrentTabId() } = payload;\n\n  const { ratingPhoneCall } = selectTabState(global, tabId);\n  if (!ratingPhoneCall) {\n    return undefined;\n  }\n\n  callApi('setCallRating', { call: ratingPhoneCall, rating, comment });\n\n  return updateTabState(global, {\n    ratingPhoneCall: undefined,\n  }, tabId);\n});\n\naddActionHandler('hangUp', (global, actions, payload): ActionReturnType => {\n  const { isPageUnload, tabId = getCurrentTabId() } = payload || {};\n  const { phoneCall } = global;\n\n  if (!phoneCall) return undefined;\n\n  if (phoneCall.state === 'discarded') {\n    callApi('destroyPhoneCallState');\n    stopPhoneCall();\n\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n    actions.afterHangUp();\n\n    return undefined;\n  }\n\n  callApi('destroyPhoneCallState');\n  stopPhoneCall();\n  callApi('discardCall', { call: phoneCall, isPageUnload });\n\n  if (phoneCall.state === 'requesting') {\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n    actions.afterHangUp();\n\n    return undefined;\n  }\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n    actions.afterHangUp();\n  }, HANG_UP_UI_DELAY);\n\n  return undefined;\n});\n","import './api/calls.async';\nimport './apiUpdaters/calls.async';\n","import type { GlobalState } from '../types';\n\nimport { getMainUsername, isChatBasicGroup } from '../helpers';\nimport { selectChat, selectChatFullInfo } from './chats';\nimport { selectUser } from './users';\n\nexport function selectChatGroupCall<T extends GlobalState>(global: T, chatId: string) {\n  const fullInfo = selectChatFullInfo(global, chatId);\n  if (!fullInfo || !fullInfo.groupCallId) return undefined;\n\n  return selectGroupCall(global, fullInfo.groupCallId);\n}\n\nexport function selectGroupCall<T extends GlobalState>(global: T, groupCallId: string) {\n  return global.groupCalls.byId[groupCallId];\n}\n\nexport function selectGroupCallParticipant<T extends GlobalState>(\n  global: T, groupCallId: string, participantId: string,\n) {\n  return selectGroupCall(global, groupCallId)?.participants[participantId];\n}\n\nexport function selectIsAdminInActiveGroupCall<T extends GlobalState>(global: T): boolean {\n  const chatId = selectActiveGroupCall(global)?.chatId;\n\n  if (!chatId) return false;\n\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  return (isChatBasicGroup(chat) && chat.isCreator) || Boolean(chat.adminRights?.manageCall);\n}\n\nexport function selectActiveGroupCall<T extends GlobalState>(global: T) {\n  const { groupCalls: { activeGroupCallId } } = global;\n  if (!activeGroupCallId) {\n    return undefined;\n  }\n\n  return selectGroupCall(global, activeGroupCallId);\n}\n\nexport function selectPhoneCallUser<T extends GlobalState>(global: T) {\n  const { phoneCall, currentUserId } = global;\n  if (!phoneCall || !phoneCall.participantId || !phoneCall.adminId) {\n    return undefined;\n  }\n\n  const id = phoneCall.adminId === currentUserId ? phoneCall.participantId : phoneCall.adminId;\n  return selectUser(global, id);\n}\n\nexport function selectCanInviteToActiveGroupCall<T extends GlobalState>(global: T) {\n  const groupCall = selectActiveGroupCall(global);\n\n  if (!groupCall || !groupCall.chatId) {\n    return false;\n  }\n\n  const chat = selectChat(global, groupCall.chatId);\n  if (!chat) {\n    return false;\n  }\n\n  const hasPublicUsername = Boolean(getMainUsername(chat));\n  if (hasPublicUsername) {\n    return true;\n  }\n\n  const inviteLink = selectChatFullInfo(global, chat.id)?.inviteLink;\n  return Boolean(inviteLink);\n}\n","import useThrottledCallback from './useThrottledCallback';\n\nexport default function useRunThrottled(ms: number, noFirst?: boolean, deps: any = []) {\n  return useThrottledCallback((cb: NoneToVoidFunction) => {\n    cb();\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, deps, ms, noFirst);\n}\n","import { useEffect, useLayoutEffect, useState } from '../../lib/teact/teact';\n\nimport { ElectronEvent } from '../../types/electron';\n\nimport { IS_IOS } from '../../util/windowEnvironment';\n\ntype ElementType = HTMLElement;\ntype RefType = {\n  current: ElementType | null;\n};\n\ntype ReturnType = [boolean, () => void, () => void] | [false];\ntype CallbackType = (isPlayed: boolean) => void;\n\nconst prop = getBrowserFullscreenElementProp();\n\nexport default function useFullscreen(elRef: RefType, exitCallback?: CallbackType,\n  enterCallback?: CallbackType): ReturnType {\n  const [isFullscreen, setIsFullscreen] = useState(Boolean(prop && document[prop]));\n\n  const setFullscreen = () => {\n    if (!elRef.current || !(prop || IS_IOS) || isFullscreen) {\n      return;\n    }\n    safeRequestFullscreen(elRef.current);\n    setIsFullscreen(true);\n  };\n\n  const exitFullscreen = () => {\n    if (!elRef.current) {\n      return;\n    }\n    safeExitFullscreen();\n    setIsFullscreen(false);\n  };\n\n  useLayoutEffect(() => {\n    const element = elRef.current;\n    const listener = () => {\n      const isEnabled = Boolean(prop && document[prop]);\n      setIsFullscreen(isEnabled);\n      if (isEnabled) {\n        enterCallback?.(false);\n      } else {\n        exitCallback?.(false);\n      }\n      // In Firefox fullscreen video controls are not visible by default, so we force them manually\n      if (element instanceof HTMLVideoElement) element.controls = isEnabled;\n    };\n\n    const listenerEnter = () => {\n      setIsFullscreen(true);\n      if (enterCallback) enterCallback(true);\n    };\n\n    const listenerExit = () => {\n      setIsFullscreen(false);\n      if (exitCallback) exitCallback(false);\n    };\n\n    document.addEventListener('fullscreenchange', listener, false);\n    document.addEventListener('webkitfullscreenchange', listener, false);\n    document.addEventListener('mozfullscreenchange', listener, false);\n\n    if (element) {\n      element.addEventListener('webkitbeginfullscreen', listenerEnter, false);\n      element.addEventListener('webkitendfullscreen', listenerExit, false);\n    }\n\n    return () => {\n      document.removeEventListener('fullscreenchange', listener, false);\n      document.removeEventListener('webkitfullscreenchange', listener, false);\n      document.removeEventListener('mozfullscreenchange', listener, false);\n      if (element) {\n        element.removeEventListener('webkitbeginfullscreen', listenerEnter, false);\n        element.removeEventListener('webkitendfullscreen', listenerExit, false);\n      }\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  if (!prop && !IS_IOS) {\n    return [false];\n  }\n\n  return [isFullscreen, setFullscreen, exitFullscreen];\n}\n\nexport const useFullscreenStatus = () => {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  useEffect(() => {\n    const listener = () => {\n      setIsFullscreen(checkIfFullscreen());\n    };\n\n    const removeElectronListener = window.electron?.on(ElectronEvent.FULLSCREEN_CHANGE, setIsFullscreen);\n    window.electron?.isFullscreen().then(setIsFullscreen);\n\n    document.addEventListener('fullscreenchange', listener, false);\n    document.addEventListener('webkitfullscreenchange', listener, false);\n    document.addEventListener('mozfullscreenchange', listener, false);\n\n    return () => {\n      removeElectronListener?.();\n\n      document.removeEventListener('fullscreenchange', listener, false);\n      document.removeEventListener('webkitfullscreenchange', listener, false);\n      document.removeEventListener('mozfullscreenchange', listener, false);\n    };\n  }, []);\n\n  return isFullscreen;\n};\n\nfunction getBrowserFullscreenElementProp() {\n  if (typeof document.fullscreenElement !== 'undefined') {\n    return 'fullscreenElement';\n  } else if (typeof document.mozFullScreenElement !== 'undefined') {\n    return 'mozFullScreenElement';\n  } else if (typeof document.webkitFullscreenElement !== 'undefined') {\n    return 'webkitFullscreenElement';\n  }\n  return '';\n}\n\nexport function checkIfFullscreen() {\n  const fullscreenProp = getBrowserFullscreenElementProp();\n  return Boolean(fullscreenProp && document[fullscreenProp]);\n}\n\nexport function safeRequestFullscreen(element: ElementType) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.webkitEnterFullscreen) {\n    element.webkitEnterFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  }\n}\n\nexport function safeExitFullscreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.webkitCancelFullScreen) {\n    document.webkitCancelFullScreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n","// https://blog.mozilla.org/webrtc/warm-up-with-replacetrack/\n\nexport const silence = (ctx: AudioContext) => {\n  const oscillator = ctx.createOscillator();\n  const dst = oscillator.connect(ctx.createMediaStreamDestination());\n  oscillator.start();\n  return new MediaStream([Object.assign((dst as any).stream.getAudioTracks()[0], { enabled: false })]);\n};\n\nexport const black = ({ width = 640, height = 480 } = {}) => {\n  const canvas = Object.assign(document.createElement('canvas'), { width, height });\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw Error('Cannot create canvas ctx');\n\n  ctx.fillRect(0, 0, width, height);\n  const stream = canvas.captureStream();\n  return new MediaStream([Object.assign(stream.getVideoTracks()[0], { enabled: false })]);\n};\n","import type {\n  Candidate, GroupCallTransport, PayloadType, RTPExtension, SsrcGroup,\n} from './types';\nimport { fromTelegramSource } from './utils';\n\nexport type Conference = {\n  sessionId: number;\n  audioExtensions: RTPExtension[];\n  videoExtensions: RTPExtension[];\n  audioPayloadTypes: PayloadType[];\n  videoPayloadTypes: PayloadType[];\n  ssrcs: Ssrc[];\n  transport: GroupCallTransport;\n};\n\nexport type Ssrc = {\n  userId: string;\n  endpoint: string;\n  mid: string;\n  isMain: boolean;\n  isRemoved?: boolean;\n  isVideo: boolean;\n  isPresentation?: boolean;\n  sourceGroups: SsrcGroup[];\n};\n\nexport default (conference: Conference, isAnswer = false, isPresentation = false, isP2p = false) => {\n  const lines: string[] = [];\n\n  const add = (value: string) => {\n    lines.push(value);\n  };\n\n  const {\n    sessionId,\n    ssrcs,\n    audioExtensions,\n    videoExtensions,\n    audioPayloadTypes,\n    videoPayloadTypes,\n    transport: {\n      ufrag,\n      pwd,\n      fingerprints,\n      candidates,\n    },\n  } = conference;\n\n  // Header\n  add('v=0'); // version\n  add(`o=- ${sessionId} 2 IN IP4 0.0.0.0`); // sessionId, 2=sessionVersion\n  add('s=-'); // name of the session\n  add('t=0 0'); // time when session is valid\n  add('a=ice-options:trickle');\n  add('a=msid-semantic:WMS *');\n  add(`a=group:BUNDLE ${ssrcs.map((ssrc) => ssrc.mid).join(' ')}${isPresentation ? '' : ` ${isP2p ? '3' : '2'}`}`);\n  // ice-lite: is a minimal version of the ICE specification, intended only for servers running on a public IP address\n  if (!isP2p) add('a=ice-lite');\n\n  const addCandidate = (c: Candidate) => {\n    if (c.sdpString) {\n      add(`a=${c.sdpString}`);\n    } else {\n      let str = '';\n      str += 'a=candidate:';\n      str += `${c.foundation} ${c.component} ${c.protocol} ${c.priority} ${c.ip} ${c.port} typ ${c.type}`;\n      if ('rel-addr' in c) {\n        str += ` raddr ${c['rel-addr']} rport ${c['rel-port']}`;\n      }\n      str += ` generation ${c.generation}`;\n      add(str);\n    }\n  };\n\n  const addTransport = () => {\n    add(`a=ice-ufrag:${ufrag}`);\n    add(`a=ice-pwd:${pwd}`);\n    fingerprints.forEach((fingerprint) => {\n      add(`a=fingerprint:${fingerprint.hash} ${fingerprint.fingerprint}`);\n      add(`a=setup:${isP2p ? (fingerprint.setup) : 'passive'}`);\n    });\n\n    candidates.forEach(addCandidate);\n  };\n\n  const addPayloadType = (payloadType: PayloadType) => {\n    const {\n      channels, id, name, clockrate, parameters,\n    } = payloadType;\n\n    const channelsString = channels ? `/${channels}` : '';\n    add(`a=rtpmap:${id} ${name}/${clockrate}${channelsString}`);\n\n    if (parameters) {\n      const parametersString = Object.keys(parameters).map((key) => {\n        return `${key}=${parameters![key]};`;\n      }).join(' ');\n\n      add(`a=fmtp:${id} ${parametersString}`);\n    }\n\n    payloadType['rtcp-fbs']?.forEach((fbParam) => {\n      add(`a=rtcp-fb:${id} ${fbParam.type}${fbParam.subtype ? ` ${fbParam.subtype}` : ''}`);\n    });\n  };\n\n  const addSsrcEntry = (entry: Ssrc) => {\n    const payloadTypes = entry.isVideo ? videoPayloadTypes : audioPayloadTypes;\n\n    const type = entry.isVideo ? 'video' : 'audio';\n    add(`m=${type} ${entry.isMain ? 1 : 0} RTP/SAVPF ${payloadTypes.map((l) => l.id).join(' ')}`);\n    add('c=IN IP4 0.0.0.0');\n    add('b=AS:1300'); // 1300000 / 1000\n    add(`a=mid:${entry.mid}`);\n    add('a=rtcp-mux');\n    payloadTypes.forEach(addPayloadType);\n\n    add('a=rtcp:1 IN IP4 0.0.0.0');\n    if (entry.isVideo) {\n      add('a=rtcp-rsize');\n    }\n\n    (entry.isVideo ? videoExtensions : audioExtensions).forEach(({ id, uri }) => {\n      add(`a=extmap:${id} ${uri}`);\n    });\n\n    if (entry.isRemoved) {\n      add('a=inactive');\n      return;\n    }\n\n    addTransport();\n\n    if (isP2p) {\n      add('a=sendrecv');\n      add('a=bundle-only');\n    } else {\n      if (isAnswer) {\n        add('a=recvonly');\n        return;\n      }\n      if (entry.isMain) {\n        add('a=sendrecv');\n      } else {\n        add('a=sendonly');\n        add('a=bundle-only');\n      }\n    }\n\n    entry.sourceGroups.forEach((sourceGroup) => {\n      if (sourceGroup.semantics) {\n        add(`a=ssrc-group:${sourceGroup.semantics} ${sourceGroup.sources.map(fromTelegramSource).join(' ')}`);\n      }\n      sourceGroup.sources.forEach((ssrcTelegram) => {\n        const ssrc = fromTelegramSource(ssrcTelegram);\n        add(`a=ssrc:${ssrc} cname:${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} msid:${entry.endpoint} ${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} mslabel:${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} label:${entry.endpoint}`);\n      });\n    });\n  };\n\n  if (!isP2p) {\n    ssrcs.filter((ssrc) => ssrc.mid === '0' || ssrc.mid === '1').map(addSsrcEntry);\n  } else {\n    ssrcs.filter(addSsrcEntry);\n  }\n\n  if (!isPresentation) {\n    add('m=application 1 UDP/DTLS/SCTP webrtc-datachannel');\n    add('c=IN IP4 0.0.0.0');\n    addTransport();\n    add('a=ice-options:trickle');\n    add(`a=mid:${isP2p ? '3' : (isPresentation ? '1' : '2')}`);\n    add('a=sctp-port:5000');\n    add('a=max-message-size:262144');\n  }\n\n  if (!isP2p) {\n    ssrcs.filter((ssrc) => ssrc.mid !== '0' && ssrc.mid !== '1').map(addSsrcEntry);\n  }\n\n  return `${lines.join('\\n')}\\n`;\n};\n","export {\n  handleUpdateGroupCallConnection, startSharingScreen, joinGroupCall,\n  getDevices, getUserStreams, setVolume, isStreamEnabled, toggleStream,\n  leaveGroupCall, handleUpdateGroupCallParticipants, switchCameraInput,\n  toggleSpeaker, toggleNoiseSuppression,\n} from './secretsauce';\nexport {\n  joinPhoneCall, processSignalingMessage, getStreams, toggleStreamP2p, stopPhoneCall, switchCameraInputP2p,\n} from './p2p';\nexport * from './p2pMessage';\nexport {\n  IS_SCREENSHARE_SUPPORTED, THRESHOLD,\n} from './utils';\nexport * from './types';\n","import { black, silence } from './blacksilence';\nimport type { ApiPhoneCallConnection, P2pParsedSdp } from './types';\nimport parseSdp from './parseSdp';\nimport type { MediaContent, MediaStateMessage, P2pMessage } from './p2pMessage';\nimport {\n  fromTelegramSource,\n  IS_ECHO_CANCELLATION_SUPPORTED,\n  IS_NOISE_SUPPRESSION_SUPPORTED, \n  p2pPayloadTypeToConference,\n} from './utils';\nimport buildSdp, { Conference } from './buildSdp';\nimport { StreamType } from './secretsauce';\n\ntype P2pState = {\n  connection: RTCPeerConnection;\n  dataChannel: RTCDataChannel;\n  emitSignalingData: (data: P2pMessage) => void;\n  onUpdate: (...args: any[]) => void;\n  conference?: Partial<Conference>;\n  isOutgoing: boolean;\n  pendingCandidates: string[];\n  streams: {\n    video?: MediaStream;\n    audio?: MediaStream;\n    presentation?: MediaStream;\n    ownAudio?: MediaStream;\n    ownVideo?: MediaStream;\n    ownPresentation?: MediaStream;\n  };\n  silence: MediaStream;\n  blackVideo: MediaStream;\n  blackPresentation: MediaStream;\n  mediaState: Omit<MediaStateMessage, '@type'>;\n  audio: HTMLAudioElement;\n  gotInitialSetup?: boolean;\n  facingMode?: VideoFacingModeEnum;\n};\n\nlet state: P2pState | undefined;\n\nconst ICE_CANDIDATE_POOL_SIZE = 10;\n\nexport function getStreams() {\n  return state?.streams;\n}\n\nfunction updateStreams() {\n  state?.onUpdate({\n    ...state.mediaState,\n    '@type': 'updatePhoneCallMediaState',\n  });\n}\n\nfunction getUserStream(streamType: StreamType, facing: VideoFacingModeEnum = 'user') {\n  if (streamType === 'presentation') {\n    return (navigator.mediaDevices as any).getDisplayMedia({\n      audio: false,\n      video: true,\n    });\n  }\n\n  return navigator.mediaDevices.getUserMedia({\n    audio: streamType === 'audio' ? {\n      ...(IS_ECHO_CANCELLATION_SUPPORTED && { echoCancellation: true }),\n      ...(IS_NOISE_SUPPRESSION_SUPPORTED && { noiseSuppression: true }),\n    } : false,\n    video: streamType === 'video' ? {\n      facingMode: facing,\n    } : false,\n  });\n}\n\nexport async function switchCameraInputP2p() {\n  if (!state || !state.facingMode) {\n    return;\n  }\n\n  const stream = state.streams.ownVideo;\n\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  state.facingMode = state.facingMode === 'environment' ? 'user' : 'environment';\n  try {\n    const newStream = await getUserStream('video', state.facingMode);\n\n    await sender.replaceTrack(newStream.getTracks()[0]);\n    state.streams.ownVideo = newStream;\n    updateStreams();\n  } catch (e) {\n\n  }\n}\n\nexport async function toggleStreamP2p(streamType: StreamType, value: boolean | undefined = undefined) {\n  if (!state) return;\n  const stream = streamType === 'audio' ? state.streams.ownAudio\n    : (streamType === 'video' ? state.streams.ownVideo : state.streams.ownPresentation);\n\n  if (!stream) return;\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  value = value === undefined ? !track.enabled : value;\n\n  try {\n    if (value && !track.enabled) {\n      const newStream = await getUserStream(streamType);\n      newStream.getTracks()[0].onended = () => {\n        toggleStreamP2p(streamType, false);\n      };\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      if (streamType === 'audio') {\n        state.streams.ownAudio = newStream;\n      } else if (streamType === 'video') {\n        state.streams.ownVideo = newStream;\n        state.facingMode = 'user';\n      } else {\n        state.streams.ownPresentation = newStream;\n      }\n      if (streamType === 'video' || streamType === 'presentation') {\n        toggleStreamP2p(streamType === 'video' ? 'presentation' : 'video', false);\n      }\n      // if (streamType === 'video') {\n      //   state.facingMode = 'user';\n      // }\n    } else if (!value && track.enabled) {\n      track.stop();\n      const newStream = streamType === 'audio' ? state.silence\n        : (streamType === 'video' ? state.blackVideo : state.blackPresentation);\n      if (!newStream) return;\n\n      await sender.replaceTrack(newStream.getTracks()[0]);\n\n      if (streamType === 'audio') {\n        state.streams.ownAudio = newStream;\n      } else if (streamType === 'video') {\n        state.streams.ownVideo = newStream;\n      } else {\n        state.streams.ownPresentation = newStream;\n      }\n      // if (streamType === 'video') {\n      //   state.facingMode = undefined;\n      // }\n    }\n    updateStreams();\n    sendMediaState();\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nexport async function joinPhoneCall(\n  connections: ApiPhoneCallConnection[],\n  emitSignalingData: (data: P2pMessage) => void,\n  isOutgoing: boolean,\n  shouldStartVideo: boolean,\n  isP2p: boolean,\n  onUpdate: (...args: any[]) => void,\n) {\n  const conn = new RTCPeerConnection({\n    iceServers: connections.map((connection) => (\n      {\n        urls: [\n          connection.isTurn && `turn:${connection.ip}:${connection.port}`,\n          connection.isStun && `stun:${connection.ip}:${connection.port}`,\n        ].filter(Boolean),\n        username: connection.username,\n        credentialType: 'password',\n        credential: connection.password,\n      }\n    )),\n    iceTransportPolicy: isP2p ? 'all' : 'relay',\n    bundlePolicy: 'max-bundle',\n    iceCandidatePoolSize: ICE_CANDIDATE_POOL_SIZE,\n  });\n\n  conn.onicecandidate = (e) => {\n    if (!e.candidate) {\n      return;\n    };\n    emitSignalingData({\n      '@type': 'Candidates',\n      candidates: [{\n        sdpString: e.candidate.candidate,\n      }],\n    });\n  };\n\n  conn.onconnectionstatechange = () => {\n    onUpdate({\n      '@type': 'updatePhoneCallConnectionState',\n      connectionState: conn.connectionState,\n    });\n  };\n\n  conn.ontrack = (e) => {\n    if (!state) return;\n\n    const stream = e.streams[0];\n    if (e.track.kind === 'audio') {\n      state.audio.srcObject = stream;\n      state.audio.play().catch();\n      state.streams.audio = stream;\n    } else if (e.transceiver.mid === '1') {\n      state.streams.video = stream;\n    } else {\n      state.streams.presentation = stream;\n    }\n\n    updateStreams();\n  };\n\n  conn.oniceconnectionstatechange = async (e) => {\n    switch(conn.iceConnectionState) {\n      case 'disconnected':\n      case 'failed':\n        if (isOutgoing) {\n          await createOffer(conn, {\n            offerToReceiveAudio: true,\n            offerToReceiveVideo: true,\n            iceRestart: true,\n          });\n        }\n      default:\n        break;\n    }\n  }\n\n  const slnc = silence(new AudioContext());\n  const video = black({ width: 640, height: 480 });\n  const screenshare = black({ width: 640, height: 480 });\n  conn.addTrack(slnc.getTracks()[0], slnc);\n  conn.addTrack(video.getTracks()[0], video);\n  conn.addTrack(screenshare.getTracks()[0], screenshare);\n\n  const dc = conn.createDataChannel('data', {\n    id: 0,\n    negotiated: true,\n  });\n\n  dc.onmessage = (e) => {\n    processSignalingMessage(JSON.parse(e.data));\n  };\n\n  const audio = new Audio();\n\n  state = {\n    audio,\n    connection: conn,\n    emitSignalingData,\n    isOutgoing,\n    pendingCandidates: [],\n    onUpdate,\n    streams: {\n      ownVideo: video,\n      ownAudio: slnc,\n      ownPresentation: screenshare,\n    },\n    mediaState: {\n      isBatteryLow: false,\n      screencastState: 'inactive',\n      videoState: 'inactive',\n      videoRotation: 0,\n      isMuted: true,\n    },\n    blackVideo: video,\n    blackPresentation: screenshare,\n    silence: slnc,\n    dataChannel: dc,\n  };\n\n  try {\n    toggleStreamP2p('audio', true);\n  } catch (err) {\n    console.error(err)\n  }\n\n  if (isOutgoing) {\n    await createOffer(conn, {\n      offerToReceiveAudio: true,\n      offerToReceiveVideo: true,\n    })\n  }\n}\n\nexport function stopPhoneCall() {\n  if (!state) return;\n\n  state.streams.ownVideo?.getTracks().forEach((track) => track.stop());\n  state.streams.ownPresentation?.getTracks().forEach((track) => track.stop());\n  state.streams.ownAudio?.getTracks().forEach((track) => track.stop());\n  state.dataChannel.close();\n  state.connection.close();\n  state = undefined;\n}\n\nfunction sendMediaState() {\n  if (!state) return;\n  const { emitSignalingData, streams } = state;\n\n  emitSignalingData({\n    '@type': 'MediaState',\n    videoRotation: 0,\n    isMuted: !streams.ownAudio?.getTracks()[0].enabled,\n    isBatteryLow: true,\n    videoState: streams.ownVideo?.getTracks()[0].enabled ? 'active' : 'inactive',\n    screencastState: streams.ownPresentation?.getTracks()[0].enabled ? 'active' : 'inactive',\n  });\n}\n\nfunction filterVP8(mediaContent: MediaContent) {\n  if (!state || state.isOutgoing) return mediaContent;\n\n  const { payloadTypes } = mediaContent!;\n  const idx = payloadTypes.findIndex((payloadType) => payloadType.name === 'VP8');\n  const vp8PayloadType = payloadTypes[idx];\n  const rtxIdx = payloadTypes.findIndex((payloadType) => Number(payloadType.parameters?.apt) === vp8PayloadType.id);\n  mediaContent.payloadTypes = [payloadTypes[idx], payloadTypes[rtxIdx]];\n\n  return mediaContent;\n}\n\nfunction sendInitialSetup(sdp: P2pParsedSdp) {\n  if (!state) return;\n  const { emitSignalingData } = state;\n\n  if (!sdp.ssrc || !sdp['ssrc-groups'] || !sdp['ssrc-groups'][0] || !sdp['ssrc-groups'][1]) return;\n\n  emitSignalingData({\n    '@type': 'InitialSetup',\n    fingerprints: sdp.fingerprints,\n    ufrag: sdp.ufrag,\n    pwd: sdp.pwd,\n    audio: {\n      ssrc: fromTelegramSource(sdp.ssrc).toString(),\n      ssrcGroups: [],\n      payloadTypes: sdp.audioPayloadTypes,\n      rtpExtensions: sdp.audioExtmap,\n    },\n    video: filterVP8({\n      ssrc: fromTelegramSource(sdp['ssrc-groups'][0].sources[0]).toString(),\n      ssrcGroups: [{\n        semantics: sdp['ssrc-groups'][0].semantics,\n        ssrcs: sdp['ssrc-groups'][0].sources.map(fromTelegramSource),\n      }],\n      payloadTypes: sdp.videoPayloadTypes,\n      rtpExtensions: sdp.videoExtmap,\n    }),\n    screencast: filterVP8({\n      ssrc: fromTelegramSource(sdp['ssrc-groups'][1].sources[0]).toString(),\n      ssrcGroups: [{\n        semantics: sdp['ssrc-groups'][1].semantics,\n        ssrcs: sdp['ssrc-groups'][1].sources.map(fromTelegramSource),\n      }],\n      payloadTypes: sdp.screencastPayloadTypes,\n      rtpExtensions: sdp.screencastExtmap,\n    }),\n  });\n}\n\nexport async function processSignalingMessage(message: P2pMessage) {\n  if (!state || !state.connection) return;\n\n  switch (message['@type']) {\n    case 'MediaState': {\n      state.mediaState = message;\n      updateStreams();\n      sendMediaState();\n      break;\n    }\n    case 'Candidates': {\n      const { pendingCandidates, gotInitialSetup } = state;\n      message.candidates.forEach((candidate) => {\n        pendingCandidates.push(candidate.sdpString);\n      });\n      if (gotInitialSetup) {\n        await commitPendingIceCandidates();\n      }\n      break;\n    }\n    case 'InitialSetup': {\n      const {\n        connection, isOutgoing,\n      } = state;\n      if (!connection) return;\n\n      const newConference = {\n        transport: {\n          candidates: [],\n          ufrag: message.ufrag,\n          pwd: message.pwd,\n          fingerprints: message.fingerprints,\n          'rtcp-mux': false,\n          xmlns: '',\n        },\n        sessionId: Date.now(),\n        ssrcs: [\n          message.audio && {\n            isVideo: false,\n            isMain: false,\n            userId: '123',\n            endpoint: '0',\n            mid: '0',\n            sourceGroups: [{\n              sources: [message.audio.ssrc],\n            }],\n          },\n          message.video && {\n            isVideo: true,\n            isPresentation: false,\n            isMain: false,\n            userId: '123',\n            endpoint: '1',\n            mid: '1',\n            sourceGroups: message.video.ssrcGroups.map((l) => ({\n              semantics: l.semantics,\n              sources: l.ssrcs,\n            })),\n          },\n          message.screencast && {\n            isVideo: true,\n            isPresentation: true,\n            isMain: false,\n            userId: '123',\n            endpoint: '2',\n            mid: '2',\n            sourceGroups: message.screencast.ssrcGroups.map((l) => ({\n              semantics: l.semantics,\n              sources: l.ssrcs,\n            })),\n          },\n        ],\n        audioPayloadTypes: message.audio!.payloadTypes?.map(p2pPayloadTypeToConference) || [],\n        audioExtensions: message.audio!.rtpExtensions,\n        videoPayloadTypes: filterVP8(message.video!).payloadTypes?.map(p2pPayloadTypeToConference) || [],\n        videoExtensions: message.video!.rtpExtensions,\n      } as Conference;\n\n      await connection.setRemoteDescription({\n        sdp: buildSdp(newConference, isOutgoing, undefined, true),\n        type: isOutgoing ? 'answer' : 'offer',\n      });\n\n      state.conference = newConference;\n\n      if (!isOutgoing) {\n        const answer = await connection.createAnswer();\n        await connection.setLocalDescription(answer);\n        sendInitialSetup(parseSdp(connection.localDescription!, true) as P2pParsedSdp);\n      }\n      state.gotInitialSetup = true;\n      await commitPendingIceCandidates();\n      break;\n    }\n  }\n}\n\nasync function commitPendingIceCandidates() {\n  if (!state) {\n    return;\n  }\n  const { pendingCandidates, connection } = state;\n  if (!pendingCandidates.length) {\n    return;\n  }\n  await Promise.all(pendingCandidates.map((c) => tryAddCandidate(connection, c)));\n  state.pendingCandidates = [];\n}\n\nasync function tryAddCandidate(connection: RTCPeerConnection, candidate: string) {\n  try {\n    await connection.addIceCandidate({\n      candidate,\n      sdpMLineIndex: 0,\n    })\n  } catch (err) {\n    console.error(err);\n  }\n}\n\nasync function createOffer(conn: RTCPeerConnection, params: RTCOfferOptions) {\n  const offer = await conn.createOffer(params);\n  await conn.setLocalDescription(offer);\n  sendInitialSetup(parseSdp(conn.localDescription!, true) as P2pParsedSdp);\n}\n","import type {\n  Fingerprint, RTCPFeedbackParam, RTPExtension,\n} from './types';\n\nexport type VideoState = 'inactive' | 'active' | 'suspended';\n\nexport type VideoRotation = 0 | 90 | 180 | 270;\n\nexport type MediaStateMessage = {\n  '@type': 'MediaState';\n  isMuted: boolean;\n  videoState: VideoState;\n  videoRotation: VideoRotation;\n  screencastState: VideoState;\n  isBatteryLow: boolean;\n};\n\ntype CandidatesMessage = {\n  '@type': 'Candidates';\n  candidates: P2pCandidate[];\n};\n\nexport type InitialSetupMessage = {\n  '@type': 'InitialSetup';\n  ufrag: string;\n  pwd: string;\n  fingerprints: Fingerprint[];\n  audio?: MediaContent;\n  video?: MediaContent;\n  screencast?: MediaContent;\n};\n\nexport type MediaContent = {\n  ssrc: string;\n  ssrcGroups: P2pSsrcGroup[];\n  payloadTypes: P2PPayloadType[];\n  rtpExtensions: RTPExtension[];\n};\n\nexport interface P2PPayloadType {\n  id: number;\n  name: string;\n  clockrate: number;\n  channels: number;\n  parameters?: Record<string, string>;\n  feedbackTypes?: RTCPFeedbackParam[];\n}\n\ntype P2pSsrcGroup = {\n  semantics?: string;\n  ssrcs: number[];\n};\n\ntype P2pCandidate = {\n  sdpString: string;\n};\n\nexport type P2pMessage = CandidatesMessage | InitialSetupMessage | MediaStateMessage;\n","import { toTelegramSource } from './utils';\nimport type { JoinGroupCallPayload, SsrcGroup } from './types';\n\nexport default (sessionDescription: RTCSessionDescriptionInit, isP2p = false): JoinGroupCallPayload => {\n  if (!sessionDescription || !sessionDescription.sdp) {\n    throw Error('Failed parsing SDP: session description is null');\n  }\n\n  const sections = sessionDescription\n    .sdp\n    .split('\\r\\nm=')\n    .map((s, i) => (i === 0 ? s : `m=${s}`))\n    .reduce((acc: Record<string, string[]>, el) => {\n      const name = el.match(/^m=(.+?)\\s/)?.[1] || 'header';\n      acc[acc.hasOwnProperty(name) && name === 'video' ? 'screencast' : name] = el.split('\\r\\n').filter(Boolean);\n      return acc;\n    }, {});\n\n  const lookup = (prefix: string, sectionName?: string) => {\n    if (!sectionName) {\n      return Object.values(sections).map((section) => {\n        return section.find((line) => line.startsWith(prefix))?.substr(prefix.length);\n      }).filter(Boolean)[0];\n    } else {\n      return sections[sectionName]?.find((line) => line.startsWith(prefix))?.substr(prefix.length);\n    }\n  };\n\n  const parseExtmaps = (sectionName: string) => {\n    return sections[sectionName].filter((l) => l.startsWith('a=extmap')).map((l) => {\n      const [, id, uri] = l.match(/extmap:(\\d+)(?:\\/.+)?\\s(.+)/)!;\n      return { id: Number(id), uri };\n    });\n  };\n\n  const parsePayloadTypes = (sectionName: string) => {\n    const payloads = sections[sectionName].filter((l) => l.startsWith('a=rtpmap')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const [name, clockrate, channels] = data.split('/');\n      return {\n        id: Number(id), name, clockrate: Number(clockrate), ...(channels && { channels: Number(channels) }),\n      };\n    });\n\n    const fbParams = sections[sectionName].filter((l) => l.startsWith('a=rtcp-fb')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const [type, subtype] = data.split(' ');\n      return { id: Number(id), type, subtype: subtype || '' };\n    });\n\n    const parameters = sections[sectionName].filter((l) => l.startsWith('a=fmtp')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const d = data?.split(';').reduce((acc: Record<string, string>, q) => {\n        const [name, value] = q.split('=');\n        acc[name] = value;\n        return acc;\n      }, {});\n      if (!d || Object.values(d).some((z) => !z)) return undefined;\n      return { id: Number(id), data: d };\n    }).filter(Boolean);\n\n    return payloads.map((payload) => {\n      const p = parameters.filter((l) => l!.id === payload.id).map((q) => q!.data).reduce((acc, el) => {\n        return Object.assign(acc, el);\n      }, {});\n      const f = fbParams.filter((l) => l.id === payload.id).map((l) => {\n        return {\n          type: l.type,\n          subtype: l.subtype,\n        };\n      });\n\n      return {\n        ...payload,\n        ...(Object.keys(p).length > 0 && { parameters: p }),\n        ...(f.length > 0 && { feedbackTypes: f }),\n      };\n    });\n  };\n\n  const rawSource = lookup('a=ssrc:', 'audio');\n  const sourceAudio = rawSource && Number(rawSource.split(' ')[0]);\n\n  // TODO multiple source groups\n  const rawSourceVideo = lookup('a=ssrc-group:', 'video')?.split(' ') || undefined;\n  const rawSourceScreencast = lookup('a=ssrc-group:', 'screencast')?.split(' ') || undefined;\n\n  if (!rawSourceVideo) {\n    throw Error('Failed parsing SDP: no video ssrc');\n  }\n\n  const [hash, fingerprint] = lookup('a=fingerprint:')?.split(' ') || [];\n\n  const setup = lookup('a=setup:');\n  if (!hash || !fingerprint) {\n    throw Error('Failed parsing SDP: no fingerprint');\n  }\n\n  console.log(sections);\n\n  const ufrag = lookup('a=ice-ufrag:');\n  const pwd = lookup('a=ice-pwd:');\n\n  if (!ufrag || !pwd) {\n    throw Error('Failed parsing SDP: no ICE ufrag or pwd');\n  }\n\n  return {\n    fingerprints: [\n      {\n        fingerprint,\n        hash,\n        setup: isP2p ? setup! : 'active',\n      },\n    ],\n    pwd,\n    ufrag,\n    ...(sourceAudio && { ssrc: toTelegramSource(sourceAudio) }),\n    ...(rawSourceVideo && {\n      'ssrc-groups': [\n        {\n          semantics: rawSourceVideo[0],\n          sources: rawSourceVideo.slice(1, rawSourceVideo.length).map(Number).map(toTelegramSource),\n        },\n        (isP2p && rawSourceScreencast && {\n          semantics: rawSourceScreencast[0],\n          sources: rawSourceScreencast.slice(1, rawSourceScreencast.length).map(Number).map(toTelegramSource),\n        }),\n      ].filter(Boolean) as SsrcGroup[],\n    }),\n    ...(isP2p && {\n      audioExtmap: parseExtmaps('audio'),\n      videoExtmap: parseExtmaps('video'),\n      screencastExtmap: parseExtmaps('screencast'),\n      audioPayloadTypes: parsePayloadTypes('audio'),\n      videoPayloadTypes: parsePayloadTypes('video'),\n      screencastPayloadTypes: parsePayloadTypes('screencast'),\n    }),\n  };\n};\n","import parseSdp from './parseSdp';\nimport { ColibriClass } from './colibriClass';\nimport type {\n  GroupCallConnectionData, GroupCallConnectionState, GroupCallParticipant, JoinGroupCallPayload,\n} from './types';\nimport buildSdp, { Conference, Ssrc } from './buildSdp';\nimport { black, silence } from './blacksilence';\nimport {\n  getAmplitude,\n  IS_ECHO_CANCELLATION_SUPPORTED,\n  IS_NOISE_SUPPRESSION_SUPPORTED,\n  THRESHOLD,\n} from './utils';\nimport Deferred from \"../../util/Deferred\";\nimport safePlay from \"../../util/safePlay\";\n\nexport type StreamType = 'audio' | 'video' | 'presentation';\nconst DEFAULT_MID = 3;\ntype GroupCallState = {\n  connection?: RTCPeerConnection;\n  screenshareConnection?: RTCPeerConnection;\n  dataChannel?: RTCDataChannel;\n  screenshareDataChannel?: RTCDataChannel;\n  participants?: GroupCallParticipant[];\n  conference?: Partial<Conference>;\n  screenshareConference?: Partial<Conference>;\n  streams?: Record<string, {\n    audio?: MediaStream;\n    video?: MediaStream;\n    presentation?: MediaStream;\n  }>;\n  participantFunctions?: Record<string, {\n    setVolume?: (volume: number) => void;\n    toggleMute?: (muted: boolean) => void;\n    getCurrentAmplitude?: () => number;\n  }>;\n  onUpdate?: (...args: any[]) => void;\n  myId?: string;\n  black?: MediaStream;\n  silence?: MediaStream;\n  updatingParticipantsQueue?: any[];\n  facingMode?: VideoFacingModeEnum;\n  isSpeakerDisabled?: boolean;\n  analyserInterval?: number;\n  speaking?: Record<string, number>;\n  audioElement?: HTMLAudioElement;\n  destination?: MediaStreamAudioDestinationNode;\n  audioContext?: AudioContext;\n  mediaStream?: MediaStream;\n  lastMid: number;\n  audioStream?: MediaStream;\n  audioSource?: MediaStreamAudioSourceNode;\n  audioAnalyser?: AnalyserNode;\n};\n\nlet state: GroupCallState | undefined;\n\nexport async function getDevices(streamType: StreamType, isInput = true) {\n  return (await navigator.mediaDevices.enumerateDevices())\n    .filter((l) => l.kind === `${streamType}${isInput ? 'input' : 'output'}`);\n}\n\nexport function toggleSpeaker() {\n  if (!state) {\n    return;\n  }\n\n  state.isSpeakerDisabled = !state.isSpeakerDisabled;\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallConnectionState',\n    connectionState: 'connected',\n    isSpeakerDisabled: state.isSpeakerDisabled,\n  });\n  if (state.participantFunctions) {\n    Object.values(state.participantFunctions).forEach((l) => {\n      l.toggleMute?.(!!state?.isSpeakerDisabled);\n    });\n  }\n}\n\nfunction leavePresentation(isFromToggle?: boolean) {\n  if (!state) {\n    return;\n  }\n  state.screenshareDataChannel?.close();\n  state.screenshareConnection?.close();\n\n  if (!isFromToggle) {\n    state.onUpdate?.({\n      '@type': 'updateGroupCallLeavePresentation',\n    });\n  }\n}\n\nexport function toggleNoiseSuppression() {\n  if (!state || !state.myId || !state.streams) {\n    return;\n  }\n\n  const audioStream = state.streams[state.myId].audio;\n  if (!audioStream) {\n    return;\n  }\n\n  const track = audioStream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  // @ts-ignore\n  const { echoCancellation, noiseSuppression } = track.getConstraints();\n\n  track.applyConstraints({\n    echoCancellation: !echoCancellation,\n    // @ts-ignore\n    noiseSuppression: !noiseSuppression,\n  });\n}\n\nexport function getUserStreams(userId: string) {\n  return state?.streams?.[userId];\n}\n\nexport function setVolume(userId: string, volume: number) {\n  const participantFunctions = state?.participantFunctions?.[userId];\n  if (!participantFunctions) return;\n  participantFunctions.setVolume?.(volume);\n}\n\nexport function isStreamEnabled(streamType: StreamType, userId?: string) {\n  const id = userId || state?.myId;\n  const stream = id && getUserStreams(id)?.[streamType];\n  if (!stream) return false;\n\n  return stream.getTracks()[0]?.enabled;\n}\n\nfunction updateGroupCallStreams(userId: string) {\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallStreams',\n    userId,\n    hasAudioStream: isStreamEnabled('audio', userId),\n    hasVideoStream: isStreamEnabled('video', userId),\n    hasPresentationStream: isStreamEnabled('presentation', userId),\n    amplitude: state.speaking?.[userId],\n  });\n}\n\nasync function getUserStream(streamType: StreamType, facing: VideoFacingModeEnum = 'user') {\n  if (streamType === 'audio' && state?.audioStream) {\n    return state.audioStream;\n  }\n\n  if (streamType === 'presentation') {\n    return (navigator.mediaDevices as any).getDisplayMedia({\n      audio: false,\n      video: true,\n    });\n  }\n\n  const media = await navigator.mediaDevices.getUserMedia({\n    audio: streamType === 'audio' ? {\n      // @ts-ignore\n      ...(IS_ECHO_CANCELLATION_SUPPORTED && {echoCancellation: true}),\n      ...(IS_NOISE_SUPPRESSION_SUPPORTED && {noiseSuppression: true}),\n    } : false,\n    video: streamType === 'video' ? {\n      facingMode: facing,\n    } : false,\n  });\n\n  if (state && streamType === 'audio') {\n    state.audioStream = media;\n  }\n\n  if (streamType === 'video') {\n    const vid = document.createElement('video');\n    vid.srcObject = media;\n\n    const deferred = new Deferred();\n    vid.oncanplay = () => deferred.resolve();\n    await deferred.promise;\n  }\n\n  return media;\n}\n\nexport async function switchCameraInput() {\n  if (!state?.myId || !state.connection || !state.streams || !state.facingMode) {\n    return;\n  }\n\n  const stream = getUserStreams(state.myId)?.video;\n\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  state.facingMode = state.facingMode === 'environment' ? 'user' : 'environment';\n  try {\n    const newStream = await getUserStream('video', state.facingMode);\n\n    await sender.replaceTrack(newStream.getTracks()[0]);\n    state.streams[state.myId].video = newStream;\n  } catch (e) {\n\n  }\n}\n\nexport async function toggleStream(streamType: StreamType, value: boolean | undefined = undefined) {\n  if (!state || !state.myId || !state.connection || !state.streams) {\n    return;\n  }\n\n  const stream = getUserStreams(state.myId)?.[streamType];\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = [\n    ...state.connection.getSenders(),\n    ...(state.screenshareConnection?.getSenders() || []),\n  ].find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  value = value === undefined ? !track.enabled : value;\n\n  try {\n    if (value && !track.enabled) {\n      const newStream = await getUserStream(streamType);\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      state.streams[state.myId][streamType] = newStream;\n      if (streamType === 'video') {\n        state.facingMode = 'user';\n      } else if (streamType === 'audio') {\n        const { audioContext } = state;\n        if (!audioContext) return;\n        const source = state.audioSource || audioContext.createMediaStreamSource(newStream);\n\n        const analyser = state.audioAnalyser || audioContext.createAnalyser();\n        analyser.minDecibels = -100;\n        analyser.maxDecibels = -30;\n        analyser.smoothingTimeConstant = 0.05;\n        analyser.fftSize = 1024;\n\n        source.connect(analyser);\n\n        state = {\n          ...state,\n          audioSource: source,\n          audioAnalyser: analyser,\n          participantFunctions: {\n            ...state.participantFunctions,\n            [state.myId]: {\n              ...state.participantFunctions?.[state.myId],\n              getCurrentAmplitude: () => {\n                const array = new Uint8Array(analyser.frequencyBinCount);\n                analyser.getByteFrequencyData(array);\n                return getAmplitude(array, 1.5);\n              },\n            },\n          },\n        };\n      }\n    } else if (!value && track.enabled) {\n      const newStream = streamType === 'audio' ? state.silence : state.black;\n      if (!newStream) return;\n\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      state.streams[state.myId][streamType] = newStream;\n      if (streamType === 'video') {\n        state.facingMode = undefined;\n      }\n\n      if(streamType !== 'audio') {\n        // We only want to stop video streams\n        track.stop();\n      } else {\n        state.audioSource?.disconnect();\n        state.audioAnalyser?.disconnect();\n      }\n    }\n    updateGroupCallStreams(state.myId!);\n    if (streamType === 'presentation' && !value) leavePresentation(true);\n  } catch (e) {\n\n  }\n}\n\nfunction updateConnectionState(connectionState: GroupCallConnectionState) {\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallConnectionState',\n    connectionState,\n  });\n}\n\nexport function leaveGroupCall() {\n  if (!state) {\n    return;\n  }\n\n  if (state.myId && state.streams?.[state.myId]) {\n    Object.values(state.streams[state.myId] || {}).forEach((stream) => {\n      stream?.getTracks().forEach((track) => {\n        track.stop();\n      });\n    });\n  }\n\n  state.audioStream?.getTracks().forEach((track) => {\n    track.stop();\n  });\n  leavePresentation(true);\n  state.dataChannel?.close();\n  state.connection?.close();\n  updateConnectionState('disconnected');\n\n  if (state.analyserInterval) {\n    clearInterval(state.analyserInterval);\n  }\n\n  state = undefined;\n}\n\nfunction analyzeAmplitudes() {\n  if (!state || !state.participantFunctions) return;\n\n  Object.keys(state.participantFunctions).forEach((id) => {\n    const { getCurrentAmplitude } = state!.participantFunctions![Number(id)];\n\n    if (getCurrentAmplitude) {\n      const amplitude = getCurrentAmplitude();\n      const prevAmplitude = state!.speaking![id] || 0;\n      state!.speaking![id] = amplitude;\n      if ((amplitude > THRESHOLD && prevAmplitude <= THRESHOLD)\n        || (amplitude <= THRESHOLD && prevAmplitude > THRESHOLD)) {\n        updateGroupCallStreams(id);\n      }\n    }\n  });\n}\n\nfunction createDataChannel(connection: RTCPeerConnection) {\n  const dataChannel = connection.createDataChannel('data', {\n    id: 0,\n  });\n\n  dataChannel.onopen = () => {\n    // console.log('Data channel open!');\n  };\n\n  dataChannel.onmessage = (e) => {\n    // console.log('onmessage');\n    const data = JSON.parse(e.data) as ColibriClass;\n    // console.log(data);\n    switch (data.colibriClass) {\n      case 'DominantSpeakerEndpointChangeEvent':\n        break;\n      case 'SenderVideoConstraints':\n\n        break;\n      case 'EndpointConnectivityStatusChangeEvent':\n\n        break;\n    }\n  };\n\n  dataChannel.onerror = (e) => {\n    console.log('%conerror', 'background: green; font-size: 5em');\n    console.error(e);\n  };\n\n  return dataChannel;\n}\n\nexport async function handleUpdateGroupCallParticipants(updatedParticipants: GroupCallParticipant[]) {\n  if (!state) {\n    return;\n  }\n\n  const {\n    participants, conference, connection, myId,\n  } = state;\n\n  if (!participants || !conference || !connection || !conference.ssrcs || !conference.transport || !myId) {\n    return;\n  }\n\n  // Joined from another client\n  if (updatedParticipants.find((participant) => {\n    return participant.isSelf\n      && participant.source\n      !== state?.conference?.ssrcs?.find((l) => l.isMain && !l.isVideo)?.sourceGroups[0].sources[0];\n  })) {\n    leaveGroupCall();\n    return;\n  }\n\n  const newEndpoints: string[] = [];\n  updatedParticipants.forEach((participant) => {\n    if (participant.isSelf) {\n      if (participant.isMuted && !participant.canSelfUnmute) {\n        // Muted by admin\n        toggleStream('audio', false);\n        toggleStream('video', false);\n        toggleStream('presentation', false);\n      }\n      return;\n    }\n\n    const { isLeft } = participant;\n    const isAudioLeft = participant.isMuted || participant.isMutedByMe;\n    const isVideoLeft = !participant.isVideoJoined || !participant.video || isLeft;\n    const isPresentationLeft = !participant.presentation || isLeft;\n\n    let hasVideo = false;\n    let hasAudio = false;\n    let hasPresentation = false;\n\n    conference.ssrcs!.filter((l) => l.userId === participant.id).forEach((ssrc) => {\n      if (!ssrc.isVideo) {\n        if (ssrc.sourceGroups[0].sources[0] === participant.source) {\n          hasAudio = true;\n        }\n        // console.log('has audio, removed=', isAudioLeft);\n        ssrc.isRemoved = isAudioLeft;\n      }\n\n      if (ssrc.isVideo) {\n        if (!ssrc.isPresentation) {\n          if (!!participant.video && ssrc.endpoint === participant.video.endpoint) {\n            hasVideo = true;\n          }\n          // console.log('has video = ', hasVideo, ' removed=', isVideoLeft);\n          ssrc.isRemoved = isVideoLeft;\n        }\n\n        if (ssrc.isPresentation) {\n          if (!!participant.presentation && ssrc.endpoint === participant.presentation.endpoint) {\n            hasPresentation = true;\n          }\n          // console.log('has presentation, removed=', isPresentationLeft);\n          ssrc.isRemoved = isPresentationLeft;\n        }\n      }\n    });\n\n    if (!isAudioLeft && !hasAudio) {\n      // console.log('add audio');\n      state!.lastMid = state!.lastMid + 1;\n      conference.ssrcs!.push({\n        userId: participant.id,\n        isMain: false,\n        endpoint: `audio${participant.source}`,\n        isVideo: false,\n        sourceGroups: [{\n          sources: [participant.source],\n        }],\n        mid: state!.lastMid.toString()\n      });\n    }\n\n    if (!isVideoLeft && !hasVideo && participant.video) {\n      // console.log('add video', participant.video);\n      state!.lastMid = state!.lastMid + 1;\n\n      newEndpoints.push(participant.video.endpoint);\n      conference.ssrcs!.push({\n        userId: participant.id,\n        isMain: false,\n        endpoint: participant.video.endpoint,\n        isVideo: true,\n        sourceGroups: participant.video.sourceGroups,\n        mid: state!.lastMid.toString()\n      });\n    }\n\n    if (!isPresentationLeft && !hasPresentation && participant.presentation) {\n      // console.log('add presentation');\n      state!.lastMid = state!.lastMid + 1;\n      conference.ssrcs!.push({\n        isPresentation: true,\n        userId: participant.id,\n        isMain: false,\n        endpoint: participant.presentation.endpoint,\n        isVideo: true,\n        sourceGroups: participant.presentation.sourceGroups,\n        mid: state!.lastMid.toString()\n      });\n    }\n  });\n\n  if (state.updatingParticipantsQueue) {\n    state.updatingParticipantsQueue.push(conference);\n    return;\n  } else {\n    state.updatingParticipantsQueue = [];\n  }\n\n  const sdp = buildSdp(conference as Conference);\n  await connection.setRemoteDescription({\n    type: 'offer',\n    sdp,\n  });\n\n  try {\n    const answer = await connection.createAnswer();\n    await connection.setLocalDescription(answer);\n\n    updateGroupCallStreams(myId);\n    if (state.updatingParticipantsQueue.length > 0) {\n      // eslint-disable-next-line no-restricted-syntax\n      for (const newConference of state.updatingParticipantsQueue) {\n        await connection.setRemoteDescription({\n          type: 'offer',\n          sdp: buildSdp(newConference as Conference),\n        });\n        const answerNew = await connection.createAnswer();\n        await connection.setLocalDescription(answerNew);\n        updateGroupCallStreams(myId);\n\n        // if (newEndpoints.length > 0) {\n        //   sendDataChannelMessage({\n        //     colibriClass: 'ReceiverVideoConstraints',\n        //     defaultConstraints: {\n        //       maxHeight: 0,\n        //     },\n        //     constraints: {\n        //       ...(newEndpoints.reduce((acc: Record<string, any>, el) => {\n        //         acc[el] = {\n        //           minHeight: 0,\n        //           maxHeight: 1080,\n        //         };\n        //         return acc;\n        //       }, {})),\n        //     },\n        //     onStageEndpoints: [],\n        //   });\n        // }\n      }\n    }\n    state.updatingParticipantsQueue = undefined;\n  } catch (e) {\n    console.error(e);\n  }\n}\n//\n// function sendDataChannelMessage(message: ColibriClass) {\n//   if (!state || !state.dataChannel || state.dataChannel.readyState !== 'open') {\n//     return;\n//   }\n//\n//   // console.log('SEND!', message);\n//   state.dataChannel.send(JSON.stringify(message));\n// }\n\nexport async function handleUpdateGroupCallConnection(data: GroupCallConnectionData, isPresentation: boolean) {\n  if (!state) {\n    return;\n  }\n\n  const conference = isPresentation ? state.screenshareConference : state.conference;\n  const connection = isPresentation ? state.screenshareConnection : state.connection;\n\n  if (!conference || !connection || !conference.ssrcs) {\n    return;\n  }\n\n  const sessionId = Date.now();\n  const newConference = {\n    ...conference,\n    transport: data.transport,\n    sessionId,\n    audioExtensions: data.audio?.['rtp-hdrexts'],\n    audioPayloadTypes: data.audio?.['payload-types'],\n    videoExtensions: data.video?.['rtp-hdrexts'],\n    videoPayloadTypes: data.video?.['payload-types'],\n  } as Conference;\n\n  state = {\n    ...state,\n    ...(!isPresentation ? { conference: newConference } : { screenshareConference: newConference }),\n  };\n\n  try {\n    await connection.setRemoteDescription({\n      type: 'answer',\n      sdp: buildSdp(newConference, true, isPresentation),\n    });\n\n    // state.resolveTest();\n    // state.test = true;\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nfunction handleTrack(e: RTCTrackEvent) {\n  if (!state || !state.audioElement || !state.audioContext || !state.mediaStream) {\n    return;\n  }\n  const ssrc = state.conference?.ssrcs?.find((l) => l.endpoint === e.track.id);\n  if (!ssrc || !ssrc.userId) {\n    return;\n  }\n\n  const { userId, isPresentation } = ssrc;\n  const participant = state.participants?.find((p) => p.id === userId);\n\n  const streamType = (e.track.kind === 'video' ? (isPresentation ? 'presentation' : 'video') : 'audio') as StreamType;\n\n  e.track.onended = () => {\n    delete state?.streams?.[userId][streamType];\n    updateGroupCallStreams(userId);\n  };\n\n  const stream = e.streams[0];\n\n  if (e.track.kind === 'audio') {\n    const { mediaStream } = state;\n    const audioContext = new (window.AudioContext)();\n    const source = audioContext.createMediaStreamSource(stream);\n\n    const gainNode = audioContext.createGain();\n    gainNode.gain.value = (participant?.volume || 10000) / 10000;\n\n    const muteNode = audioContext.createGain();\n    gainNode.gain.value = 1;\n\n    const analyser = audioContext.createAnalyser();\n    analyser.minDecibels = -100;\n    analyser.maxDecibels = -30;\n    analyser.smoothingTimeConstant = 0.05;\n    analyser.fftSize = 1024;\n\n    source.connect(analyser).connect(muteNode).connect(gainNode).connect(audioContext.destination);\n\n    mediaStream!.addTrack(source.mediaStream.getAudioTracks()[0]);\n\n    // https://stackoverflow.com/questions/41784137/webrtc-doesnt-work-with-audiocontext#comment117600018_41784241\n    const test = new Audio();\n    test.srcObject = stream;\n    // test.srcObject = source.mediaStream;\n    test.muted = true;\n    test.remove();\n\n    state = {\n      ...state,\n      participantFunctions: {\n        ...state.participantFunctions,\n        [userId]: {\n          ...state.participantFunctions?.[userId],\n          setVolume: (volume: number) => {\n            gainNode.gain.value = volume > 1 ? volume * 2 : volume;\n          },\n          toggleMute: (muted?: boolean) => {\n            muteNode.gain.value = muted ? 0 : 1;\n          },\n          getCurrentAmplitude: () => {\n            const array = new Uint8Array(analyser.frequencyBinCount);\n            analyser.getByteFrequencyData(array);\n            return getAmplitude(array, 1.5);\n          },\n        },\n      },\n    };\n  }\n\n  state = {\n    ...state,\n    streams: {\n      ...state.streams,\n      [userId]: {\n        ...state.streams?.[userId],\n        [streamType]: stream,\n      },\n    },\n  };\n\n  updateGroupCallStreams(userId);\n}\n\nfunction initializeConnection(\n  streams: MediaStream[],\n  resolve: (payload: JoinGroupCallPayload) => void,\n  isPresentation = false,\n) {\n  const connection = new RTCPeerConnection();\n\n  const dataChannel = isPresentation ? undefined : createDataChannel(connection);\n\n  streams.forEach((stream) => stream.getTracks().forEach((track) => {\n    connection.addTrack(track, stream);\n  }));\n\n  if (!isPresentation) {\n    connection.oniceconnectionstatechange = () => {\n      const connectionState = connection.iceConnectionState;\n      console.log('iceconnectionstatechange', connectionState);\n      if (connectionState === 'connected' || connectionState === 'completed') {\n        updateConnectionState('connected');\n      } else if (connectionState === 'checking' || connectionState === 'new') {\n        updateConnectionState('connecting');\n      } else if (connection.iceConnectionState === 'disconnected') {\n        updateConnectionState('reconnecting');\n      }\n    };\n  }\n  connection.onconnectionstatechange = () => {\n    console.log('connectionstatechange', connection.connectionState);\n  }\n  connection.ontrack = handleTrack;\n  connection.onnegotiationneeded = async () => {\n    if (!state) return;\n\n    console.log('onnegotiationneeded');\n\n    const { myId } = state;\n\n    if (!myId) {\n      return;\n    }\n    const offer = await connection.createOffer({\n      offerToReceiveVideo: true,\n      offerToReceiveAudio: !isPresentation,\n    });\n    console.log('offer created');\n\n    await connection.setLocalDescription(offer);\n    console.log('local desc set');\n\n    if (!offer.sdp) {\n      return;\n    }\n\n    const sdp = parseSdp(offer);\n    const audioSsrc: Ssrc | undefined = !isPresentation ? {\n      userId: '',\n      sourceGroups: [\n        {\n          sources: [sdp.ssrc || 0],\n        },\n      ],\n      isRemoved: isPresentation,\n      isMain: true,\n      isVideo: false,\n      isPresentation,\n      endpoint: isPresentation ? '1' : '0',\n      mid: isPresentation ? '1' : '0'\n    } : undefined;\n\n    const videoSsrc: Ssrc | undefined = sdp['ssrc-groups'] && {\n      isPresentation,\n      userId: '',\n      sourceGroups: sdp['ssrc-groups'],\n      isMain: true,\n      isVideo: true,\n      endpoint: isPresentation ? '0' : '1',\n      mid: isPresentation ? '0' : '1'\n    };\n\n    const conference = isPresentation ? state.screenshareConference : state.conference;\n\n    const ssrcs: Ssrc[] = [];\n    if (isPresentation) {\n      if (videoSsrc) ssrcs.push(videoSsrc);\n      if (audioSsrc) ssrcs.push(audioSsrc);\n    } else {\n      if (audioSsrc) ssrcs.push(audioSsrc);\n      if (videoSsrc) ssrcs.push(videoSsrc);\n    }\n\n    const audioStream = streams.find((l) => l.getTracks()[0].kind === 'audio');\n    const videoStream = streams.find((l) => l.getTracks()[0].kind === 'video');\n\n    state = {\n      ...state,\n      ...(!isPresentation ? {\n        conference: {\n          ...conference,\n          ssrcs,\n        },\n      } : {\n        screenshareConference: {\n          ...conference,\n          ssrcs,\n        },\n      }),\n      streams: {\n        ...state.streams,\n        [myId]: {\n          ...state.streams?.[myId],\n          ...(audioStream && { audio: audioStream }),\n          ...(!isPresentation && videoStream ? { video: videoStream } : { presentation: videoStream }),\n        },\n      },\n    };\n\n    updateGroupCallStreams(myId);\n\n    resolve(sdp);\n  };\n\n  return { connection, dataChannel };\n}\n\nexport async function startSharingScreen(): Promise<JoinGroupCallPayload | undefined> {\n  if (!state) {\n    return undefined;\n  }\n\n  try {\n    const stream: MediaStream | undefined = await getUserStream('presentation');\n\n    if (!stream) {\n      return undefined;\n    }\n\n    stream.getTracks()[0].onended = () => {\n      if (state && state.myId) {\n        delete state.streams?.[state.myId].presentation;\n        updateGroupCallStreams(state.myId);\n        leavePresentation();\n      }\n    };\n\n    return await new Promise((resolve) => {\n      const { connection, dataChannel } = initializeConnection([stream], resolve, true);\n      state = {\n        ...state!,\n        screenshareConnection: connection,\n        screenshareDataChannel: dataChannel,\n      };\n    });\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function joinGroupCall(\n  myId: string,\n  audioContext: AudioContext,\n  audioElement: HTMLAudioElement,\n  onUpdate: (...args: any[]) => void,\n): Promise<JoinGroupCallPayload> {\n  if (state) {\n    throw Error('Already in call');\n  }\n\n  updateConnectionState('connecting');\n\n  const mediaStream = new MediaStream();\n  audioElement.srcObject = mediaStream;\n  safePlay(audioElement);\n\n  state = {\n    onUpdate,\n    participants: [],\n    myId,\n    speaking: {},\n    silence: silence(audioContext),\n    black: black({ width: 640, height: 480 }),\n    // @ts-ignore\n    analyserInterval: setInterval(analyzeAmplitudes, 1000),\n    audioElement,\n    // destination,\n    audioContext,\n    mediaStream,\n    lastMid: DEFAULT_MID,\n  };\n\n  // Prepare microphone\n  getUserStream('audio');\n\n  return new Promise((resolve) => {\n    state = {\n      ...state!,\n      ...initializeConnection([state!.silence!, state!.black!], resolve),\n    };\n  });\n}\n","import { P2PPayloadType } from './p2pMessage';\n\nexport interface GroupCallParticipant {\n  isSelf?: boolean;\n  isMuted?: boolean;\n  isLeft?: boolean;\n  isUser?: boolean;\n  canSelfUnmute?: boolean;\n  hasJustJoined?: boolean;\n  isVideoJoined?: boolean;\n  isMutedByMe?: boolean;\n  isVolumeByAdmin?: boolean;\n  isMin?: boolean;\n  isVersioned?: boolean;\n  source: number;\n  date: Date;\n  id: string;\n  volume?: number;\n  about?: string;\n  video?: GroupCallParticipantVideo;\n  presentation?: GroupCallParticipantVideo;\n  raiseHandRating?: string;\n\n  hasAudioStream?: boolean;\n  hasVideoStream?: boolean;\n  hasPresentationStream?: boolean;\n  amplitude?: number;\n}\n\nexport type GroupCallConnectionState = 'connecting' | 'connected' | 'disconnected' | 'reconnecting' | 'discarded';\n\nexport interface GroupCallParticipantVideo {\n  endpoint: string;\n  isPaused?: boolean;\n  sourceGroups: SsrcGroup[];\n  audioSource?: number;\n}\n\nexport type Fingerprint = {\n  hash: string;\n  setup: string;\n  fingerprint: string;\n};\n\nexport type SsrcGroup = {\n  semantics?: string;\n  sources: number[];\n};\n\nexport type Candidate = {\n  generation: string;\n  component: string;\n  protocol: string;\n  port: string;\n  ip: string;\n  foundation: string;\n  id: string;\n  priority: string;\n  type: string;\n  network: string;\n  'rel-addr': string;\n  'rel-port': string;\n\n  sdpString?: string; // Used for P2P\n};\n\nexport type JoinGroupCallPayload = {\n  ufrag: string;\n  pwd: string;\n  fingerprints: Fingerprint[];\n  ssrc?: number;\n  'ssrc-groups'?: SsrcGroup[];\n};\n\nexport type P2pParsedSdp = JoinGroupCallPayload & {\n  audioExtmap: RTPExtension[];\n  videoExtmap: RTPExtension[];\n  screencastExtmap: RTPExtension[];\n  audioPayloadTypes: P2PPayloadType[];\n  videoPayloadTypes: P2PPayloadType[];\n  screencastPayloadTypes: P2PPayloadType[];\n};\n\nexport interface RTPExtension {\n  id: number;\n  uri: string;\n}\n\nexport interface RTCPFeedbackParam {\n  type: string;\n  subtype?: string;\n}\n\nexport interface PayloadType {\n  id: number;\n  name: string;\n  clockrate: number;\n  channels: number;\n  parameters?: Record<string, string | number>;\n  'rtcp-fbs'?: RTCPFeedbackParam[];\n}\n\nexport interface GroupCallTransport {\n  candidates: Candidate[];\n  pwd: string;\n  ufrag: string;\n  fingerprints: Fingerprint[];\n  'rtcp-mux': boolean;\n  xmlns: string;\n}\n\nexport interface GroupCallConnectionData {\n  transport: GroupCallTransport;\n  audio: {\n    'payload-types': PayloadType[];\n    'rtp-hdrexts': RTPExtension[];\n  };\n  video: {\n    endpoint: string;\n    'payload-types': PayloadType[];\n    'rtp-hdrexts': RTPExtension[];\n    server_sources: number[];\n  };\n  stream?: boolean;\n}\n\nexport interface ApiPhoneCallConnection {\n  username: string;\n  password: string;\n  isTurn?: boolean;\n  isStun?: boolean;\n  ip: string;\n  ipv6: string;\n  port: number;\n}\n\nexport interface ApiCallProtocol {\n  libraryVersions: string[];\n  minLayer: number;\n  maxLayer: number;\n  isUdpP2p?: boolean;\n  isUdpReflector?: boolean;\n}\n","import type { P2PPayloadType } from './p2pMessage';\nimport type { PayloadType } from './types';\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// unsign => sign\nexport function toTelegramSource(source: number) {\n  // eslint-disable-next-line no-bitwise\n  return source << 0;\n}\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// sign => unsign\nexport function fromTelegramSource(source: number) {\n  // eslint-disable-next-line no-bitwise\n  return source >>> 0;\n}\n\nexport function getAmplitude(array: Uint8Array, scale = 3) {\n  if (!array) return 0;\n\n  const { length } = array;\n  let total = 0;\n  for (let i = 0; i < length; i++) {\n    total += array[i] * array[i];\n  }\n  const rms = Math.sqrt(total / length) / 255;\n\n  return Math.min(1, rms * scale);\n}\n\nexport function p2pPayloadTypeToConference(p: P2PPayloadType): PayloadType {\n  return {\n    id: p.id,\n    name: p.name,\n    'rtcp-fbs': p.feedbackTypes,\n    clockrate: p.clockrate,\n    parameters: p.parameters,\n    channels: p.channels,\n  };\n}\n\nexport function isRelayAddress(candidate: string) {\n  const parts = candidate.split(' ');\n  return parts.some((part) => part === 'relay');\n}\n\nexport function removeRelatedAddress(candidate: string) {\n  const parts = candidate.split(' ');\n\n  const raddrIndex = parts.indexOf('raddr');\n  if (raddrIndex !== -1) {\n    parts.splice(raddrIndex, 2);\n  }\n\n  const rportIndex = parts.indexOf('rport');\n  if (rportIndex !== -1) {\n    parts.splice(rportIndex, 2);\n  }\n\n  return parts.join(' ');\n}\n\nexport const THRESHOLD = 0.1;\n\nexport const IS_SCREENSHARE_SUPPORTED = 'getDisplayMedia' in (navigator?.mediaDevices || {});\nexport const IS_ECHO_CANCELLATION_SUPPORTED = navigator?.mediaDevices?.getSupportedConstraints().echoCancellation;\n// @ts-ignore\nexport const IS_NOISE_SUPPRESSION_SUPPORTED = navigator?.mediaDevices?.getSupportedConstraints().noiseSuppression;\n","export enum ElectronEvent {\n  FULLSCREEN_CHANGE = 'fullscreen-change',\n  UPDATE_ERROR = 'update-error',\n  UPDATE_AVAILABLE = 'update-available',\n  DEEPLINK = 'deeplink',\n}\n\nexport enum ElectronAction {\n  GET_IS_FULLSCREEN = 'get-is-fullscreen',\n  INSTALL_UPDATE = 'install-update',\n  HANDLE_DOUBLE_CLICK = 'handle-double-click',\n  OPEN_NEW_WINDOW = 'open-new-window',\n  SET_WINDOW_TITLE = 'set-window-title',\n  SET_TRAFFIC_LIGHT_POSITION = 'set-traffic-light-position',\n  SET_IS_AUTO_UPDATE_ENABLED = 'set-is-auto-update-enabled',\n  GET_IS_AUTO_UPDATE_ENABLED = 'get-is-auto-update-enabled',\n  SET_IS_TRAY_ICON_ENABLED = 'set-is-tray-icon-enabled',\n  GET_IS_TRAY_ICON_ENABLED = 'get-is-tray-icon-enabled',\n  RESTORE_LOCAL_STORAGE = 'restore-local-storage',\n}\n\nexport type TrafficLightPosition = 'standard' | 'lowered';\n\nexport interface ElectronApi {\n  isFullscreen: () => Promise<boolean>;\n  installUpdate: () => Promise<void>;\n  handleDoubleClick: () => Promise<void>;\n  openNewWindow: (url: string, title?: string) => Promise<void>;\n  setWindowTitle: (title?: string) => Promise<void>;\n  setTrafficLightPosition: (position: TrafficLightPosition) => Promise<void>;\n  setIsAutoUpdateEnabled: (value: boolean) => Promise<void>;\n  getIsAutoUpdateEnabled: () => Promise<boolean>;\n  setIsTrayIconEnabled: (value: boolean) => Promise<void>;\n  getIsTrayIconEnabled: () => Promise<boolean>;\n  restoreLocalStorage: () => Promise<void>;\n  on: (eventName: ElectronEvent, callback: any) => VoidFunction;\n}\n\ndeclare global {\n  interface Window {\n    electron?: ElectronApi;\n  }\n}\n","export const EMOJI_DATA = new Uint16Array([\n  0xd83d, 0xde09, 0xd83d, 0xde0d, 0xd83d, 0xde1b, 0xd83d, 0xde2d, 0xd83d, 0xde31, 0xd83d, 0xde21,\n  0xd83d, 0xde0e, 0xd83d, 0xde34, 0xd83d, 0xde35, 0xd83d, 0xde08, 0xd83d, 0xde2c, 0xd83d, 0xde07,\n  0xd83d, 0xde0f, 0xd83d, 0xdc6e, 0xd83d, 0xdc77, 0xd83d, 0xdc82, 0xd83d, 0xdc76, 0xd83d, 0xdc68,\n  0xd83d, 0xdc69, 0xd83d, 0xdc74, 0xd83d, 0xdc75, 0xd83d, 0xde3b, 0xd83d, 0xde3d, 0xd83d, 0xde40,\n  0xd83d, 0xdc7a, 0xd83d, 0xde48, 0xd83d, 0xde49, 0xd83d, 0xde4a, 0xd83d, 0xdc80, 0xd83d, 0xdc7d,\n  0xd83d, 0xdca9, 0xd83d, 0xdd25, 0xd83d, 0xdca5, 0xd83d, 0xdca4, 0xd83d, 0xdc42, 0xd83d, 0xdc40,\n  0xd83d, 0xdc43, 0xd83d, 0xdc45, 0xd83d, 0xdc44, 0xd83d, 0xdc4d, 0xd83d, 0xdc4e, 0xd83d, 0xdc4c,\n  0xd83d, 0xdc4a, 0x270c, 0x270b, 0xd83d, 0xdc50, 0xd83d, 0xdc46, 0xd83d, 0xdc47, 0xd83d, 0xdc49,\n  0xd83d, 0xdc48, 0xd83d, 0xde4f, 0xd83d, 0xdc4f, 0xd83d, 0xdcaa, 0xd83d, 0xdeb6, 0xd83c, 0xdfc3,\n  0xd83d, 0xdc83, 0xd83d, 0xdc6b, 0xd83d, 0xdc6a, 0xd83d, 0xdc6c, 0xd83d, 0xdc6d, 0xd83d, 0xdc85,\n  0xd83c, 0xdfa9, 0xd83d, 0xdc51, 0xd83d, 0xdc52, 0xd83d, 0xdc5f, 0xd83d, 0xdc5e, 0xd83d, 0xdc60,\n  0xd83d, 0xdc55, 0xd83d, 0xdc57, 0xd83d, 0xdc56, 0xd83d, 0xdc59, 0xd83d, 0xdc5c, 0xd83d, 0xdc53,\n  0xd83c, 0xdf80, 0xd83d, 0xdc84, 0xd83d, 0xdc9b, 0xd83d, 0xdc99, 0xd83d, 0xdc9c, 0xd83d, 0xdc9a,\n  0xd83d, 0xdc8d, 0xd83d, 0xdc8e, 0xd83d, 0xdc36, 0xd83d, 0xdc3a, 0xd83d, 0xdc31, 0xd83d, 0xdc2d,\n  0xd83d, 0xdc39, 0xd83d, 0xdc30, 0xd83d, 0xdc38, 0xd83d, 0xdc2f, 0xd83d, 0xdc28, 0xd83d, 0xdc3b,\n  0xd83d, 0xdc37, 0xd83d, 0xdc2e, 0xd83d, 0xdc17, 0xd83d, 0xdc34, 0xd83d, 0xdc11, 0xd83d, 0xdc18,\n  0xd83d, 0xdc3c, 0xd83d, 0xdc27, 0xd83d, 0xdc25, 0xd83d, 0xdc14, 0xd83d, 0xdc0d, 0xd83d, 0xdc22,\n  0xd83d, 0xdc1b, 0xd83d, 0xdc1d, 0xd83d, 0xdc1c, 0xd83d, 0xdc1e, 0xd83d, 0xdc0c, 0xd83d, 0xdc19,\n  0xd83d, 0xdc1a, 0xd83d, 0xdc1f, 0xd83d, 0xdc2c, 0xd83d, 0xdc0b, 0xd83d, 0xdc10, 0xd83d, 0xdc0a,\n  0xd83d, 0xdc2b, 0xd83c, 0xdf40, 0xd83c, 0xdf39, 0xd83c, 0xdf3b, 0xd83c, 0xdf41, 0xd83c, 0xdf3e,\n  0xd83c, 0xdf44, 0xd83c, 0xdf35, 0xd83c, 0xdf34, 0xd83c, 0xdf33, 0xd83c, 0xdf1e, 0xd83c, 0xdf1a,\n  0xd83c, 0xdf19, 0xd83c, 0xdf0e, 0xd83c, 0xdf0b, 0x26a1, 0x2614, 0x2744, 0x26c4, 0xd83c, 0xdf00,\n  0xd83c, 0xdf08, 0xd83c, 0xdf0a, 0xd83c, 0xdf93, 0xd83c, 0xdf86, 0xd83c, 0xdf83, 0xd83d, 0xdc7b,\n  0xd83c, 0xdf85, 0xd83c, 0xdf84, 0xd83c, 0xdf81, 0xd83c, 0xdf88, 0xd83d, 0xdd2e, 0xd83c, 0xdfa5,\n  0xd83d, 0xdcf7, 0xd83d, 0xdcbf, 0xd83d, 0xdcbb, 0x260e, 0xd83d, 0xdce1, 0xd83d, 0xdcfa, 0xd83d,\n  0xdcfb, 0xd83d, 0xdd09, 0xd83d, 0xdd14, 0x23f3, 0x23f0, 0x231a, 0xd83d, 0xdd12, 0xd83d, 0xdd11,\n  0xd83d, 0xdd0e, 0xd83d, 0xdca1, 0xd83d, 0xdd26, 0xd83d, 0xdd0c, 0xd83d, 0xdd0b, 0xd83d, 0xdebf,\n  0xd83d, 0xdebd, 0xd83d, 0xdd27, 0xd83d, 0xdd28, 0xd83d, 0xdeaa, 0xd83d, 0xdeac, 0xd83d, 0xdca3,\n  0xd83d, 0xdd2b, 0xd83d, 0xdd2a, 0xd83d, 0xdc8a, 0xd83d, 0xdc89, 0xd83d, 0xdcb0, 0xd83d, 0xdcb5,\n  0xd83d, 0xdcb3, 0x2709, 0xd83d, 0xdceb, 0xd83d, 0xdce6, 0xd83d, 0xdcc5, 0xd83d, 0xdcc1, 0x2702,\n  0xd83d, 0xdccc, 0xd83d, 0xdcce, 0x2712, 0x270f, 0xd83d, 0xdcd0, 0xd83d, 0xdcda, 0xd83d, 0xdd2c,\n  0xd83d, 0xdd2d, 0xd83c, 0xdfa8, 0xd83c, 0xdfac, 0xd83c, 0xdfa4, 0xd83c, 0xdfa7, 0xd83c, 0xdfb5,\n  0xd83c, 0xdfb9, 0xd83c, 0xdfbb, 0xd83c, 0xdfba, 0xd83c, 0xdfb8, 0xd83d, 0xdc7e, 0xd83c, 0xdfae,\n  0xd83c, 0xdccf, 0xd83c, 0xdfb2, 0xd83c, 0xdfaf, 0xd83c, 0xdfc8, 0xd83c, 0xdfc0, 0x26bd, 0x26be,\n  0xd83c, 0xdfbe, 0xd83c, 0xdfb1, 0xd83c, 0xdfc9, 0xd83c, 0xdfb3, 0xd83c, 0xdfc1, 0xd83c, 0xdfc7,\n  0xd83c, 0xdfc6, 0xd83c, 0xdfca, 0xd83c, 0xdfc4, 0x2615, 0xd83c, 0xdf7c, 0xd83c, 0xdf7a, 0xd83c,\n  0xdf77, 0xd83c, 0xdf74, 0xd83c, 0xdf55, 0xd83c, 0xdf54, 0xd83c, 0xdf5f, 0xd83c, 0xdf57, 0xd83c,\n  0xdf71, 0xd83c, 0xdf5a, 0xd83c, 0xdf5c, 0xd83c, 0xdf61, 0xd83c, 0xdf73, 0xd83c, 0xdf5e, 0xd83c,\n  0xdf69, 0xd83c, 0xdf66, 0xd83c, 0xdf82, 0xd83c, 0xdf70, 0xd83c, 0xdf6a, 0xd83c, 0xdf6b, 0xd83c,\n  0xdf6d, 0xd83c, 0xdf6f, 0xd83c, 0xdf4e, 0xd83c, 0xdf4f, 0xd83c, 0xdf4a, 0xd83c, 0xdf4b, 0xd83c,\n  0xdf52, 0xd83c, 0xdf47, 0xd83c, 0xdf49, 0xd83c, 0xdf53, 0xd83c, 0xdf51, 0xd83c, 0xdf4c, 0xd83c,\n  0xdf50, 0xd83c, 0xdf4d, 0xd83c, 0xdf46, 0xd83c, 0xdf45, 0xd83c, 0xdf3d, 0xd83c, 0xdfe1, 0xd83c,\n  0xdfe5, 0xd83c, 0xdfe6, 0x26ea, 0xd83c, 0xdff0, 0x26fa, 0xd83c, 0xdfed, 0xd83d, 0xddfb, 0xd83d,\n  0xddfd, 0xd83c, 0xdfa0, 0xd83c, 0xdfa1, 0x26f2, 0xd83c, 0xdfa2, 0xd83d, 0xdea2, 0xd83d, 0xdea4,\n  0x2693, 0xd83d, 0xde80, 0x2708, 0xd83d, 0xde81, 0xd83d, 0xde82, 0xd83d, 0xde8b, 0xd83d, 0xde8e,\n  0xd83d, 0xde8c, 0xd83d, 0xde99, 0xd83d, 0xde97, 0xd83d, 0xde95, 0xd83d, 0xde9b, 0xd83d, 0xdea8,\n  0xd83d, 0xde94, 0xd83d, 0xde92, 0xd83d, 0xde91, 0xd83d, 0xdeb2, 0xd83d, 0xdea0, 0xd83d, 0xde9c,\n  0xd83d, 0xdea6, 0x26a0, 0xd83d, 0xdea7, 0x26fd, 0xd83c, 0xdfb0, 0xd83d, 0xddff, 0xd83c, 0xdfaa,\n  0xd83c, 0xdfad, 0xd83c, 0xddef, 0xd83c, 0xddf5, 0xd83c, 0xddf0, 0xd83c, 0xddf7, 0xd83c, 0xdde9,\n  0xd83c, 0xddea, 0xd83c, 0xdde8, 0xd83c, 0xddf3, 0xd83c, 0xddfa, 0xd83c, 0xddf8, 0xd83c, 0xddeb,\n  0xd83c, 0xddf7, 0xd83c, 0xddea, 0xd83c, 0xddf8, 0xd83c, 0xddee, 0xd83c, 0xddf9, 0xd83c, 0xddf7,\n  0xd83c, 0xddfa, 0xd83c, 0xddec, 0xd83c, 0xdde7, 0x0031, 0x20e3, 0x0032, 0x20e3, 0x0033, 0x20e3,\n  0x0034, 0x20e3, 0x0035, 0x20e3, 0x0036, 0x20e3, 0x0037, 0x20e3, 0x0038, 0x20e3, 0x0039, 0x20e3,\n  0x0030, 0x20e3, 0xd83d, 0xdd1f, 0x2757, 0x2753, 0x2665, 0x2666, 0xd83d, 0xdcaf, 0xd83d, 0xdd17,\n  0xd83d, 0xdd31, 0xd83d, 0xdd34, 0xd83d, 0xdd35, 0xd83d, 0xdd36, 0xd83d, 0xdd37,\n]);\n\nexport const EMOJI_OFFSETS = [\n  0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22,\n  24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46,\n  48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70,\n  72, 74, 76, 78, 80, 82, 84, 86, 87, 88, 90, 92,\n  94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116,\n  118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140,\n  142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164,\n  166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188,\n  190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212,\n  214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236,\n  238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 259,\n  260, 261, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280,\n  282, 284, 286, 288, 290, 292, 294, 295, 297, 299, 301, 303,\n  305, 306, 307, 308, 310, 312, 314, 316, 318, 320, 322, 324,\n  326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348,\n  350, 351, 353, 355, 357, 359, 360, 362, 364, 365, 366, 368,\n  370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392,\n  394, 396, 398, 400, 402, 404, 406, 407, 408, 410, 412, 414,\n  416, 418, 420, 422, 424, 426, 427, 429, 431, 433, 435, 437,\n  439, 441, 443, 445, 447, 449, 451, 453, 455, 457, 459, 461,\n  463, 465, 467, 469, 471, 473, 475, 477, 479, 481, 483, 485,\n  487, 489, 491, 493, 495, 497, 499, 501, 503, 505, 507, 508,\n  510, 511, 513, 515, 517, 519, 521, 522, 524, 526, 528, 529,\n  531, 532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552,\n  554, 556, 558, 560, 562, 564, 566, 567, 569, 570, 572, 574,\n  576, 578, 582, 586, 590, 594, 598, 602, 606, 610, 614, 618,\n  620, 622, 624, 626, 628, 630, 632, 634, 636, 638, 640, 641,\n  642, 643, 644, 646, 648, 650, 652, 654, 656, 658,\n];\n","export const vibrateShort = () => {\n  navigator.vibrate?.(50);\n};\n","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"OsO5GKfn\",\"panelWrapper\":\"cUVoePr_\",\"panel\":\"Thuz79M3\",\"panelScrollTrigger\":\"zoK6Y6IS\",\"panelHeader\":\"DMBtCL9Z\",\"scrolled\":\"GdEH1Agb\",\"fullscreen\":\"JJx0QI2w\",\"landscape\":\"wamCuzMB\",\"headerButton\":\"gmyieSid\",\"firstButton\":\"hVnn6KBp\",\"lastButton\":\"iy78A5rG\",\"panelHeaderText\":\"TwEEA77i\",\"title\":\"pNZ9skLf\",\"bigger\":\"NumT3v5i\",\"subtitle\":\"gmfUKabx\",\"participants\":\"iTeC_RxH\",\"participantVideos\":\"PZmKIdTl\",\"addParticipantButton\":\"clmu2oBt\",\"videos\":\"ATwoMlAV\",\"mainVideoContainer\":\"hqFon3dV\",\"videosHeader\":\"KPHc659W\",\"appFullscreen\":\"cl2sfoBF\",\"videosHeaderLastButton\":\"_t50HVNJ\",\"videosContent\":\"oEEQZilE\",\"actions\":\"uGzi9s97\",\"actionButton\":\"foXbVcnN\",\"destructive\":\"YIR9Z9CZ\",\"canRequestToSpeak\":\"ZoiZQu_O\",\"muted\":\"wpvv1V6m\",\"portrait\":\"R6HQcMwx\",\"noVideoParticipants\":\"aepCFyJQ\",\"noSidebar\":\"XjgP21E6\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Wk7JwPx3\",\"subtitle\":\"ShcCNemD\",\"subtitleText\":\"UZLgp2cx\",\"icon\":\"vRc6jhKf\",\"subtitleBlue\":\"yA7bxEWw\",\"subtitleRed\":\"DnuZwImI\",\"subtitleGreen\":\"BkgYQGFq\",\"avatar\":\"ouHUJ9ff\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"npTa6CmI\",\"portrait\":\"v7oB2HTv\"};","// extracted by mini-css-extract-plugin\nexport {};","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"DKuzmnN7\",\"hidden\":\"T_wodAHA\",\"noAnimate\":\"yPCkJzpi\",\"root\":\"eBq1NoLo\",\"speaking\":\"h4NcT6OS\",\"loader\":\"XedVWQii\",\"video\":\"eUXuK9Oz\",\"videoFallback\":\"eTpvBU_b eUXuK9Oz\",\"thumbnailWrapper\":\"R5ULTrF9\",\"thumbnail\":\"cjUWuViy\",\"flipped\":\"O2bTiH2E\",\"pinButton\":\"lPdblo0y\",\"bottomPanel\":\"T1deCDSn\",\"info\":\"LzFFayK3\",\"pinned\":\"B4WZhF9P\",\"name\":\"RBwMAuKp\",\"status\":\"z1ZZTsjC\",\"icon\":\"j1aDzn1H\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"lKdhQ5pw\",\"spinner\":\"tyQNJC6B\",\"spinnerVisible\":\"LowChABq\",\"mutedByAdmin\":\"Ynow5UuE\",\"canUnmute\":\"bjKqp3SI\",\"icon\":\"Ea1XnQaX\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"GNYRVAUg\",\"blurred\":\"RBmbMiou\",\"single-column\":\"O7cZE08z\",\"singleColumn\":\"O7cZE08z\",\"header\":\"GI6dY5aJ\",\"close-button\":\"ULiJZuaP\",\"closeButton\":\"ULiJZuaP\",\"emojis-backdrop\":\"RFBKZpjx\",\"emojisBackdrop\":\"RFBKZpjx\",\"open\":\"zi1NlOXX\",\"emojis\":\"DFco1VIN\",\"emoji-tooltip\":\"MRIShZ3V\",\"emojiTooltip\":\"MRIShZ3V\",\"user-info\":\"eaUe2A0c\",\"userInfo\":\"eaUe2A0c\",\"buttons\":\"qIeflO02\",\"leave\":\"hclywYYk\",\"accept\":\"ln_ZBUHy\",\"accept-icon\":\"cVRd3twS\",\"acceptIcon\":\"cVRd3twS\",\"main-video\":\"bGlBFSJq\",\"mainVideo\":\"bGlBFSJq\",\"second-video\":\"TOFu1n5x\",\"secondVideo\":\"TOFu1n5x\",\"visible\":\"LOnSFN9w\",\"fullscreen\":\"Omg5T1o6\"};","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"lBO3RZUM\",\"button\":\"ch2sqAKW\",\"active\":\"OQxlsRp7\",\"button-text\":\"aHguvLcL\",\"buttonText\":\"aHguvLcL\"};","// extracted by mini-css-extract-plugin\nexport default {\"stars\":\"P7EfDKJN\",\"star\":\"t8LJLFSN\",\"isFilled\":\"_XX6q8YW\",\"comment\":\"EvL0WaKD\",\"visible\":\"v5hn1XvT\"};"],"names":["initializeSoundsForSafari","IS_IOS","IS_SAFARI","default","GroupCall","ActiveCallHeader","PhoneCall","RatePhoneCallModal","document","addEventListener","once","React","memo","useEffect","getActions","withGlobal","selectTabState","selectActiveGroupCall","selectPhoneCallUser","buildClassName","useOldLang","groupCall","phoneCallUser","isCallPanelVisible","toggleGroupCallPanel","lang","body","classList","toggle","Boolean","window","electron","setTrafficLightPosition","handleToggleGroupCallPanel","undefined","createElement","className","onClick","firstName","title","global","tabState","isMasterTab","useMemo","useRef","useState","IS_SCREENSHARE_SUPPORTED","selectChat","selectCanInviteToActiveGroupCall","selectGroupCall","selectGroupCallParticipant","selectIsAdminInActiveGroupCall","compact","useAppLayout","useFlag","useIntersectionObserver","useIsIntersecting","useLastCallback","useFullscreenStatus","useGroupCallVideoLayout","Icon","Button","Checkbox","FloatingActionButton","Modal","GroupCallParticipantList","GroupCallParticipantVideo","MicrophoneButton","styles","INTERSECTION_THROTTLE","groupCallId","connectionState","participantsCount","meParticipant","isAdmin","participants","canInvite","toggleGroupCallVideo","toggleGroupCallPresentation","leaveGroupCall","connectToActiveGroupCall","playGroupCallSound","createGroupCallInviteLink","containerRef","primaryVideoContainerRef","secondaryVideoContainerRef","panelScrollTriggerRef","panelRef","isLeaving","setIsLeaving","isOpen","observe","rootRef","throttleMs","isDisabled","hasScrolled","isMobile","isLandscape","isFullscreen","openFullscreen","closeFullscreen","isSidebarOpen","openSidebar","closeSidebar","isLandscapeLayout","isAppFullscreen","firstPresentation","Object","values","find","presentation","videoParticipants","filter","video","flatMap","id","type","hasVideoParticipants","length","groupCallTitle","membersString","isConfirmLeaveModalOpen","openConfirmLeaveModal","closeConfirmLeaveModal","isEndGroupCallModal","setIsEndGroupCallModal","shouldEndGroupCall","setShouldEndGroupCall","hasVideo","hasVideoStream","hasPresentation","hasPresentationStream","hasAudioStream","isConnecting","canSelfUnmute","canRequestToSpeak","sound","handleCloseConfirmLeaveModal","handleToggleFullscreen","current","handleToggleSidebar","handleInviteMember","handleClickVideo","handleLeaveGroupCall","handleCloseAnimationEnd","shouldDiscard","handleToggleGroupCallPresentation","canPinVideo","isLandscapeWithVideos","pinnedVideo","setPinnedVideo","videoLayout","panelOffset","primaryContainerRef","secondaryContainerRef","handleSetPinnedVideo","handleOpenFirstPresentation","some","l","onClose","root","fullscreen","appFullscreen","landscape","noVideoParticipants","portrait","noSidebar","dialogRef","onCloseAnimationEnd","videos","videosHeader","round","size","color","headerButton","firstButton","ariaLabel","name","bigger","videosHeaderLastButton","videosContent","ref","panelWrapper","panel","panelScrollTrigger","panelHeader","scrolled","ripple","panelHeaderText","subtitle","lastButton","participantVideos","style","map","layout","participant","participantId","isRemounted","teactOrderKey","orderKey","key","canPin","setPinned","isShown","addParticipantButton","mainVideoContainer","actions","actionButton","muted","disabled","destructive","label","checked","onCheck","isText","chatId","chat","currentUserId","useCallback","GROUP_CALL_DEFAULT_VOLUME","THRESHOLD","selectUser","renderText","formatGroupCallVolume","useContextMenuHandlers","Avatar","FullNameTitle","ListItem","GroupCallParticipantMenu","OutlinedMicrophoneIcon","GroupCallParticipant","peer","menuRef","isSelf","isMutedByMe","isMuted","isSpeaking","amplitude","isRaiseHand","raiseHandRating","isContextMenuOpen","contextMenuAnchor","handleContextMenu","handleBeforeContextMenu","handleContextMenuClose","handleContextMenuHide","getTriggerElement","getRootElement","closest","getMenuElement","getLayout","withPortal","hasCustomVolume","volume","aboutText","aboutColor","subtitleRed","subtitleBlue","replace","subtitleGreen","about","leftElement","avatar","rightElement","icon","onMouseDown","onContextMenu","multiline","withEmojiStatus","subtitleText","isDropdownOpen","anchor","compareFields","useInfiniteScroll","InfiniteScroll","loadMoreGroupCallParticipants","orderedParticipantIds","sort","compareParticipants","handleLoadMoreGroupCallParticipants","viewportIds","getMore","items","onLoadMore","indexOf","a","b","GROUP_CALL_VOLUME_MULTIPLIER","LOCAL_TGS_URLS","useRunThrottled","AnimatedIcon","DeleteMemberModal","Menu","MenuItem","SPEAKER_ICON_DISABLED_SEGMENT","SPEAKER_ICON_ENABLED_SEGMENT","VOLUME_ZERO","VOLUME_LOW","VOLUME_MEDIUM","VOLUME_NORMAL","VOLUME_CHANGE_THROTTLE","SPEAKER_ICON_SIZE","menuPositionOptions","toggleGroupCallMute","setGroupCallParticipantVolume","openChat","requestToSpeak","isDeleteUserModalOpen","openDeleteUserModal","closeDeleteUserModal","shouldRaiseHand","localVolume","setLocalVolume","shouldPlay","setShouldPlay","isLocalVolumeZero","speakerIconPlaySegment","handleSetLocalVolume","isNewLocalVolumeZero","runThrottled","handleRemove","e","stopPropagation","handleCancelRequestToSpeak","value","handleMute","handleOpenProfile","handleChangeVolume","Number","target","Math","floor","_extends","min","max","onChange","tgsUrl","Speaker","play","toString","playSegment","userId","fastBlur","requestMutation","getUserStreams","animate","fastRaf","IS_CANVAS_FILTER_SUPPORTED","useInterval","Skeleton","BLUR_RADIUS","BLUR_ITERATIONS","VIDEO_FALLBACK_UPDATE_INTERVAL","user","thumbnailRef","videoRef","videoFallbackRef","x","y","width","height","noAnimate","isRemoved","isPinned","shouldFlipVideo","status","prevLayoutRef","prevX","prevY","prevWidth","prevHeight","currentX","currentY","currentWidth","currentHeight","isHidden","setIsHidden","streams","actualStream","streamRef","active","getVideoTracks","enabled","stream","handleInactive","srcObject","removeEventListener","isLoading","setIsLoading","handleCanPlay","canvas","videoWidth","videoHeight","getContext","drawImage","thumbnail","ctx","alpha","isDrawing","draw","handleClickPin","wrapper","hidden","pinned","onDoubleClick","speaking","loader","flipped","autoPlay","playsInline","onCanPlay","videoFallback","thumbnailWrapper","pinButton","bottomPanel","info","noColor","isUser","vibrateShort","usePreviousDeprecated","Spinner","CONNECTION_STATE_DEFAULT","REQUEST_TO_SPEAK_THROTTLE","HOLD_TO_SPEAK_TIME","ICON_SIZE","noAudioStream","muteMouseDownState","isRequestingToSpeak","setIsRequestingToSpeak","prevShouldRaiseHand","r","random","animatedIconName","toggleMute","handleMouseDownMute","setTimeout","handleMouseUpMute","canUnmute","mutedByAdmin","onMouseUp","forceAlways","spinner","spinnerVisible","hasRequestedToSpeak","prevIsRaiseHand","prevIsMuted","microphoneColor","VoiceOutlined","nonInteractive","useResizeObserver","PADDING_HORIZONTAL","PADDING_VERTICAL","PREFERRED_PANEL_VIDEO_HEIGHT","setVideoLayout","setPanelOffset","videosCount","prevVideosCount","prevVideoParticipants","removedVideoParticipants","p","recalculateLayout","primaryContainer","secondaryContainer","removed","secondaryInitialX","secondaryInitialY","secondaryContainerWidth","getBoundingClientRect","skip","pinnedSkipIndex","pinnedPush","findIndex","initialX","initialY","containerWidth","containerHeight","videoType","secondaryVideosCounts","isFirstBig","columns","rows","ceil","smallWidth","heightTotal","i","isBig","realIndex","push","shouldRemount","splice","calculateColumnsCount","totalGridSize","shouldFillLastRow","lastRowWidth","row","shouldCenter","getStreams","switchCameraInputP2p","toggleStreamP2p","formatMediaDuration","IS_ANDROID","IS_REQUEST_FULLSCREEN_SUPPORTED","useForceUpdate","PhoneCallButton","isOutgoing","phoneCall","hangUp","requestMasterAndAcceptCall","connectToActivePhoneCall","toggleFullscreen","exitFullscreen","then","requestFullscreen","container","handleClose","isDiscarded","state","isBusy","reason","isIncomingRequested","isOutgoingRequested","isActive","isConnected","isHangingUp","startHangingUp","stopHangingUp","handleHangUp","forceUpdate","callStatus","videoState","screencastState","hasOwnAudio","ownAudio","getTracks","hasOwnPresentation","ownPresentation","hasOwnVideo","ownVideo","isHidingPresentation","startHidingPresentation","stopHidingPresentation","isHidingVideo","startHidingVideo","stopHidingVideo","handleTogglePresentation","handleToggleVideo","handleToggleAudio","isEmojiOpen","openEmoji","closeEmoji","isFlipping","startFlipping","stopFlipping","handleFlipCamera","timeElapsed","startDate","Date","singleColumn","blurred","mainVideo","secondVideo","visible","header","closeButton","emojisBackdrop","open","emojis","emojiTooltip","userInfo","buttons","customIcon","CameraFlip","accept","iconClassName","acceptIcon","leave","adminId","button","buttonText","InputText","closeCallRatingModal","setCallRating","inputRef","rating","setRating","handleSend","comment","handleClickStar","index","handleCancelClick","stars","Array","fill","_","isFilled","star","placeholder","getUserFirstOrLastName","selectCurrentChat","ConfirmDialog","contactName","deleteChatMember","handleDeleteChatMember","textParts","confirmLabel","confirmHandler","confirmIsDestructive","handleUpdateGroupCallConnection","handleUpdateGroupCallParticipants","joinPhoneCall","processSignalingMessage","getCurrentTabId","omit","langProvider","EMOJI_DATA","EMOJI_OFFSETS","ARE_CALLS_SUPPORTED","callApi","addActionHandler","getGlobal","setGlobal","updateGroupCall","updateGroupCallParticipant","updateTabState","update","activeGroupCallId","groupCalls","isFromLibrary","tabId","isSpeakerDisabled","data","showNotification","message","keys","call","accessHash","connections","gB","verifyPhoneCallProtocol","protocol","oldTranslate","needRating","ratingPhoneCall","gA","keyFingerprint","newCall","gAOrB","sendSignalingData","isVideo","isP2pAllowed","apiUpdate","libraryVersions","version","isStreamEnabled","joinGroupCall","setVolume","startSharingScreen","stopPhoneCall","toggleStream","removeGroupCall","updateActiveGroupCall","getGroupCallAudioContext","getGroupCallAudioElement","removeGroupCallAudioElement","loadFullChat","HANG_UP_UI_DELAY","payload","shouldRemove","rejoin","isPageUnload","force","afterHangUp","requestMasterAndJoinGroupCall","videoStopped","raiseHand","params","presentationPaused","audioElement","audioContext","result","inviteHash","dhConfig","gAHash","JSON","stringify","encodedData","getMainUsername","isChatBasicGroup","selectChatFullInfo","selectChatGroupCall","fullInfo","byId","isCreator","adminRights","manageCall","hasPublicUsername","inviteLink","useThrottledCallback","ms","noFirst","deps","cb","useLayoutEffect","ElectronEvent","prop","getBrowserFullscreenElementProp","useFullscreen","elRef","exitCallback","enterCallback","setIsFullscreen","setFullscreen","safeRequestFullscreen","safeExitFullscreen","element","listener","isEnabled","HTMLVideoElement","controls","listenerEnter","listenerExit","checkIfFullscreen","removeElectronListener","on","FULLSCREEN_CHANGE","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","fullscreenProp","webkitRequestFullscreen","webkitEnterFullscreen","mozRequestFullScreen","mozCancelFullScreen","webkitCancelFullScreen","webkitExitFullscreen","silence","oscillator","createOscillator","dst","connect","createMediaStreamDestination","start","MediaStream","assign","getAudioTracks","black","Error","fillRect","captureStream","fromTelegramSource","conference","isAnswer","isPresentation","isP2p","lines","add","sessionId","ssrcs","audioExtensions","videoExtensions","audioPayloadTypes","videoPayloadTypes","transport","ufrag","pwd","fingerprints","candidates","ssrc","mid","join","addCandidate","c","sdpString","str","foundation","component","priority","ip","port","generation","addTransport","forEach","fingerprint","hash","setup","addPayloadType","payloadType","channels","clockrate","parameters","channelsString","parametersString","fbParam","subtype","addSsrcEntry","entry","payloadTypes","isMain","uri","sourceGroups","sourceGroup","semantics","sources","ssrcTelegram","endpoint","getDevices","switchCameraInput","toggleSpeaker","toggleNoiseSuppression","parseSdp","IS_ECHO_CANCELLATION_SUPPORTED","IS_NOISE_SUPPRESSION_SUPPORTED","p2pPayloadTypeToConference","buildSdp","ICE_CANDIDATE_POOL_SIZE","updateStreams","onUpdate","mediaState","getUserStream","streamType","facing","navigator","mediaDevices","getDisplayMedia","audio","getUserMedia","echoCancellation","noiseSuppression","facingMode","track","sender","connection","getSenders","newStream","replaceTrack","onended","stop","blackVideo","blackPresentation","sendMediaState","err","console","error","emitSignalingData","shouldStartVideo","conn","RTCPeerConnection","iceServers","urls","isTurn","isStun","username","credentialType","credential","password","iceTransportPolicy","bundlePolicy","iceCandidatePoolSize","onicecandidate","candidate","onconnectionstatechange","ontrack","kind","catch","transceiver","oniceconnectionstatechange","iceConnectionState","createOffer","offerToReceiveAudio","offerToReceiveVideo","iceRestart","slnc","AudioContext","screenshare","addTrack","dc","createDataChannel","negotiated","onmessage","parse","Audio","pendingCandidates","isBatteryLow","videoRotation","dataChannel","close","filterVP8","mediaContent","idx","vp8PayloadType","rtxIdx","apt","sendInitialSetup","sdp","ssrcGroups","rtpExtensions","audioExtmap","videoExtmap","screencast","screencastPayloadTypes","screencastExtmap","gotInitialSetup","commitPendingIceCandidates","newConference","xmlns","now","setRemoteDescription","answer","createAnswer","setLocalDescription","localDescription","Promise","all","tryAddCandidate","addIceCandidate","sdpMLineIndex","offer","toTelegramSource","sessionDescription","sections","split","s","reduce","acc","el","match","hasOwnProperty","lookup","prefix","sectionName","section","line","startsWith","substr","parseExtmaps","parsePayloadTypes","payloads","fbParams","d","q","z","f","feedbackTypes","rawSource","sourceAudio","rawSourceVideo","rawSourceScreencast","log","slice","getAmplitude","Deferred","safePlay","DEFAULT_MID","isInput","enumerateDevices","participantFunctions","leavePresentation","isFromToggle","screenshareDataChannel","screenshareConnection","myId","audioStream","getConstraints","applyConstraints","updateGroupCallStreams","media","vid","deferred","oncanplay","resolve","promise","source","audioSource","createMediaStreamSource","analyser","audioAnalyser","createAnalyser","minDecibels","maxDecibels","smoothingTimeConstant","fftSize","getCurrentAmplitude","array","Uint8Array","frequencyBinCount","getByteFrequencyData","disconnect","updateConnectionState","analyserInterval","clearInterval","analyzeAmplitudes","prevAmplitude","onopen","colibriClass","onerror","updatedParticipants","newEndpoints","isLeft","isAudioLeft","isVideoLeft","isVideoJoined","isPresentationLeft","hasAudio","lastMid","updatingParticipantsQueue","answerNew","screenshareConference","handleTrack","mediaStream","gainNode","createGain","gain","muteNode","destination","test","remove","initializeConnection","onnegotiationneeded","audioSsrc","videoSsrc","videoStream","setInterval","scale","total","rms","sqrt","isRelayAddress","parts","part","removeRelatedAddress","raddrIndex","rportIndex","getSupportedConstraints","ElectronAction","Uint16Array","vibrate"],"sourceRoot":""}